import{W as Te,r as Wt,N as br,Q as wr,O as we,s as xt,C as J,L as j,F as Yt,D as me,E as zt,x as Z,G as De,H as bt,z as D,a as V,J as Cr,p as Er,i as Xt,X as Ir,y as ze,M as Pr,_ as Ue,v as Mr,K as Tr,Z as wi,o as Ci,I as Ei,Y as Be,$ as Ii}from"./index-BX_vxe7X.js";import{C as Pi}from"./index-Ceg22B6G.js";import{C as je}from"./index-Dr0bNfLr.js";/* empty css              *//* empty css              */import{q as Mi}from"./index-B-Tj5Ufa.js";import{g as Ti,a as Se,s as Di}from"./utils-CWiwGcUE.js";import{u as Dr,a as Ar,T as kr}from"./scoket-XtlgR-au.js";import{T as Fr}from"./index-Cx0Yx7Zr.js";import"./moment-C5S46NFB.js";import{L as Ai}from"./index-COVh8vVE.js";import{I as Rr}from"./index-Bkl6_quS.js";import{S as Br}from"./index-DBfFwlo4.js";import{S as ki}from"./index-z8l4azJb.js";import{P as Fi}from"./index-CXBNeDMd.js";import{F as Lr}from"./index-CNM3eilj.js";import{S as Ri}from"./index-BhVhiFAi.js";import{_ as Ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Vr}from"./index-CtwnQW2r.js";import"./use-route-B6WoNe5m.js";import"./use-id-YMZ35A_K.js";import"./use-tab-status-C4MZWNyN.js";import"./index-zXWHl72W.js";import"./_commonjsHelpers-C932wzq6.js";/**
     * @license
     * KLineChart v9.8.12
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */var Xe=function(i,t){return Xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])},Xe(i,t)};function N(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Xe(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var R=function(){return R=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},R.apply(this,arguments)};function ne(i,t,e,r){function n(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function o(c){try{u(r.next(c))}catch(h){s(h)}}function l(c){try{u(r.throw(c))}catch(h){s(h)}}function u(c){c.done?a(c.value):n(c.value).then(o,l)}u((r=r.apply(i,[])).next())})}function ae(i,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,n,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(e=0)),e;)try{if(r=1,n&&(a=u[0]&2?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,n=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){e.label=u[1];break}if(u[0]===6&&e.label<a[1]){e.label=a[1],a=u;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(u);break}a[2]&&e.ops.pop(),e.trys.pop();continue}u=t.call(i,e)}catch(c){u=[6,c],n=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Jt(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ee(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),n,a=[],s;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(o){s={error:o}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(s)throw s.error}}return a}function Or(i,t,e){if(arguments.length===2)for(var r=0,n=t.length,a;r<n;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return i.concat(a||Array.prototype.slice.call(t))}var H;(function(i){i.Dashed="dashed",i.Solid="solid"})(H||(H={}));var X;(function(i){i.Stroke="stroke",i.Fill="fill",i.StrokeFill="stroke_fill"})(X||(X={}));var le;(function(i){i.Always="always",i.FollowCross="follow_cross",i.None="none"})(le||(le={}));var Pt;(function(i){i.Standard="standard",i.Rect="rect"})(Pt||(Pt={}));var pe;(function(i){i.Left="left",i.Middle="middle",i.Right="right"})(pe||(pe={}));var Ce;(function(i){i.Fixed="fixed",i.Pointer="pointer"})(Ce||(Ce={}));var ft;(function(i){i.CandleSolid="candle_solid",i.CandleStroke="candle_stroke",i.CandleUpStroke="candle_up_stroke",i.CandleDownStroke="candle_down_stroke",i.Ohlc="ohlc",i.Area="area"})(ft||(ft={}));var Gt;(function(i){i.Left="left",i.Right="right"})(Gt||(Gt={}));var at;(function(i){i.Normal="normal",i.Percentage="percentage",i.Log="log"})(at||(at={}));var xe="#F92855",Le="rgba(249, 40, 85, .7)",be="#2DC08E",Ve="rgba(45, 192, 142, .7)",qt="#888888",Ae="#FFFFFF",ct="#1677FF",Kt="#76808F",Ye="#DDDDDD";function oe(i){return"rgba(22, 119, 255, ".concat(i,")")}function Bi(){function i(){return{show:!0,size:1,color:"#EDEDED",style:H.Dashed,dashedValue:[2,2]}}return{show:!0,horizontal:i(),vertical:i()}}function Li(){var i={show:!0,color:Kt,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:ft.CandleSolid,bar:{upColor:be,downColor:xe,noChangeColor:qt,upBorderColor:be,downBorderColor:xe,noChangeBorderColor:qt,upWickColor:be,downWickColor:xe,noChangeWickColor:qt},area:{lineSize:2,lineColor:ct,smooth:!1,value:"close",backgroundColor:[{offset:0,color:oe(.01)},{offset:1,color:oe(.2)}],point:{show:!0,color:ct,radius:4,rippleColor:oe(.3),rippleRadius:8,animation:!0,animationDuration:1e3}},priceMark:{show:!0,high:R({},i),low:R({},i),last:{show:!0,upColor:be,downColor:xe,noChangeColor:qt,line:{show:!0,style:H.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:X.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:H.Solid,borderSize:0,borderDashedValue:[2,2],color:Ae,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:le.Always,showType:Pt.Standard,custom:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}],defaultValue:"n/a",rect:{position:Ce.Fixed,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,offsetLeft:4,offsetTop:4,offsetRight:4,offsetBottom:4,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:Kt,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function Vi(){var i=["#FF9600","#935EBD",ct,"#E11D74","#01C5C4"].map(function(t){return{style:H.Solid,smooth:!1,size:1,dashedValue:[2,2],color:t}});return{ohlc:{upColor:Ve,downColor:Le,noChangeColor:qt},bars:[{style:X.Fill,borderStyle:H.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Ve,downColor:Le,noChangeColor:qt}],lines:i,circles:[{style:X.Fill,borderStyle:H.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Ve,downColor:Le,noChangeColor:qt}],lastValueMark:{show:!1,text:{show:!1,style:X.Fill,color:Ae,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:H.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{offsetLeft:4,offsetTop:6,offsetRight:4,offsetBottom:6,showRule:le.Always,showType:Pt.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:Kt,marginLeft:8,marginTop:4,marginRight:8,marginBottom:4},icons:[]}}}function Nr(){return{show:!0,size:"auto",axisLine:{show:!0,color:Ye,size:1},tickText:{show:!0,color:Kt,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:Ye}}}function Oi(){var i=Nr();return i.type=at.Normal,i.position=Gt.Right,i.inside=!1,i.reverse=!1,i}function Ni(){function i(){return{show:!0,line:{show:!0,style:H.Dashed,dashedValue:[4,2],size:1,color:Kt},text:{show:!0,style:X.Fill,color:Ae,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:H.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:Kt,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:Kt}}}return{show:!0,horizontal:i(),vertical:i()}}function Wi(){var i=oe(.35),t=oe(.25);function e(){return{style:X.Fill,color:Ae,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:H.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:ct,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:ct}}return{point:{color:ct,borderColor:i,borderSize:1,radius:5,activeColor:ct,activeBorderColor:i,activeBorderSize:3,activeRadius:5},line:{style:H.Solid,smooth:!1,color:ct,size:1,dashedValue:[2,2]},rect:{style:X.Fill,color:t,borderColor:ct,borderSize:1,borderRadius:0,borderStyle:H.Solid,borderDashedValue:[2,2]},polygon:{style:X.Fill,color:ct,borderColor:ct,borderSize:1,borderStyle:H.Solid,borderDashedValue:[2,2]},circle:{style:X.Fill,color:t,borderColor:ct,borderSize:1,borderStyle:H.Solid,borderDashedValue:[2,2]},arc:{style:H.Solid,color:ct,size:1,dashedValue:[2,2]},text:e(),rectText:e()}}function zi(){return{size:1,color:Ye,fill:!0,activeBackgroundColor:oe(.08)}}function Xi(){return{grid:Bi(),candle:Li(),indicator:Vi(),xAxis:Nr(),yAxis:Oi(),separator:zi(),crosshair:Ni(),overlay:Wi()}}function mt(i,t){if(!(!Mt(i)&&!Mt(t))){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=i[e],n=t[e];Mt(n)&&Mt(r)?mt(r,n):T(t[e])&&(i[e]=_e(t[e]))}}}function _e(i){if(!Mt(i))return i;var t;wt(i)?t=[]:t={};for(var e in i)if(Object.prototype.hasOwnProperty.call(i,e)){var r=i[e];Mt(r)?t[e]=_e(r):t[e]=r}return t}function wt(i){return Object.prototype.toString.call(i)==="[object Array]"}function kt(i){return typeof i=="function"}function Mt(i){return typeof i=="object"&&T(i)}function F(i){return typeof i=="number"&&!isNaN(i)}function T(i){return i!=null}function Qt(i){return typeof i=="boolean"}function O(i){return typeof i=="string"}var Yi=/\\(\\)?/g,Hi=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function ot(i,t,e){if(T(i)){var r=[];t.replace(Hi,function(o){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];var c=o;return T(l[1])?c=l[2].replace(Yi,"$1"):T(l[0])&&(c=l[0].trim()),r.push(c),""});for(var n=i,a=0,s=r.length;T(n)&&a<s;)n=n==null?void 0:n[r[a++]];return T(n)?n:e??"--"}return e??"--"}function Gi(i,t,e){var r={};return i.formatToParts(new Date(t)).forEach(function(n){var a=n.type,s=n.value;switch(a){case"year":{r.YYYY=s;break}case"month":{r.MM=s;break}case"day":{r.DD=s;break}case"hour":{r.HH=s==="24"?"00":s;break}case"minute":{r.mm=s;break}case"second":{r.ss=s;break}}}),e.replace(/YYYY|MM|DD|HH|mm|ss/g,function(n){return r[n]})}function K(i,t){var e=+i;return F(e)?e.toFixed(t??2):"".concat(i)}function $i(i){var t=+i;if(F(t)){if(t>1e9)return"".concat(+(t/1e9).toFixed(3),"B");if(t>1e6)return"".concat(+(t/1e6).toFixed(3),"M");if(t>1e3)return"".concat(+(t/1e3).toFixed(3),"K")}return"".concat(i)}function rt(i,t){var e="".concat(i);if(t.length===0)return e;if(e.includes(".")){var r=e.split(".");return"".concat(r[0].replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(t)}),".").concat(r[1])}return e.replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(t)})}function nt(i,t){var e="".concat(i),r=new RegExp("\\.0{"+t+",}[1-9][0-9]*$");if(r.test(e)){var n=e.split("."),a=n[n.length-1],s=a.match(/0*/);if(T(s)){var o=s[0].length;return n[n.length-1]=a.replace(/0*/,"0{".concat(o,"}")),n.join(".")}}return e}var ve;function Ht(i){var t,e,r;return(r=(e=(t=i.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&r!==void 0?r:1}function te(i,t,e){return"".concat(t??"normal"," ").concat(i??12,"px ").concat(e??"Helvetica Neue")}function Ee(i,t,e,r){if(!T(ve)){var n=document.createElement("canvas"),a=Ht(n);ve=n.getContext("2d"),ve.scale(a,a)}return ve.font=te(t,e,r),Math.round(ve.measureText(i).width)}var gt;(function(i){i.OnDataReady="onDataReady",i.OnZoom="onZoom",i.OnScroll="onScroll",i.OnVisibleRangeChange="onVisibleRangeChange",i.OnTooltipIconClick="onTooltipIconClick",i.OnCrosshairChange="onCrosshairChange",i.OnCandleBarClick="onCandleBarClick",i.OnPaneDrag="onPaneDrag"})(gt||(gt={}));var Ui=function(){function i(){this._callbacks=[]}return i.prototype.subscribe=function(t){var e,r=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;r<0&&this._callbacks.push(t)},i.prototype.unsubscribe=function(t){var e;if(kt(t)){var r=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;r>-1&&this._callbacks.splice(r,1)}else this._callbacks=[]},i.prototype.execute=function(t){this._callbacks.forEach(function(e){e(t)})},i.prototype.isEmpty=function(){return this._callbacks.length===0},i}(),pt;(function(i){i.Init="init",i.Forward="forward",i.Backward="backward"})(pt||(pt={}));var ht;(function(i){i.Normal="normal",i.Price="price",i.Volume="volume"})(ht||(ht={}));function qe(i,t,e,r,n){var a=t.result,s=t.figures,o=t.styles,l=ot(o,"circles",r.circles),u=l.length,c=ot(o,"bars",r.bars),h=c.length,f=ot(o,"lines",r.lines),d=f.length,v=0,p=0,g=0,m,_=0;s.forEach(function(S){var y;switch(S.type){case"circle":{_=v;var x=l[v%u];m=R(R({},x),{color:x.noChangeColor}),v++;break}case"bar":{_=p;var w=c[p%h];m=R(R({},w),{color:w.noChangeColor}),p++;break}case"line":{_=g,m=f[g%d],g++;break}}if(T(m)){var b={prev:{kLineData:i[e-1],indicatorData:a[e-1]},current:{kLineData:i[e],indicatorData:a[e]},next:{kLineData:i[e+1],indicatorData:a[e+1]}},E=(y=S.styles)===null||y===void 0?void 0:y.call(S,b,t,r);n(S,R(R({},m),E),_)}})}var ji=function(){function i(t){this.result=[],this._precisionFlag=!1;var e=t.name,r=t.shortName,n=t.series,a=t.calcParams,s=t.figures,o=t.precision,l=t.shouldOhlc,u=t.shouldFormatBigNumber,c=t.visible,h=t.zLevel,f=t.minValue,d=t.maxValue,v=t.styles,p=t.extendData,g=t.regenerateFigures,m=t.createTooltipDataSource,_=t.draw;this.name=e,this.shortName=r??e,this.series=n??ht.Normal,this.precision=o??4,this.calcParams=a??[],this.figures=s??[],this.shouldOhlc=l??!1,this.shouldFormatBigNumber=u??!1,this.visible=c??!0,this.zLevel=h??0,this.minValue=f??null,this.maxValue=d??null,this.styles=_e(v??{}),this.extendData=p,this.regenerateFigures=g??null,this.createTooltipDataSource=m??null,this.draw=_??null}return i.prototype.setShortName=function(t){return this.shortName!==t?(this.shortName=t,!0):!1},i.prototype.setSeries=function(t){return this.series!==t?(this.series=t,!0):!1},i.prototype.setPrecision=function(t,e){var r=e??!1,n=Math.floor(t);return n!==this.precision&&t>=0&&(!r||r&&!this._precisionFlag)?(this.precision=n,r||(this._precisionFlag=!0),!0):!1},i.prototype.setCalcParams=function(t){var e,r;return this.calcParams=t,this.figures=(r=(e=this.regenerateFigures)===null||e===void 0?void 0:e.call(this,t))!==null&&r!==void 0?r:this.figures,!0},i.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t?(this.shouldOhlc=t,!0):!1},i.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t?(this.shouldFormatBigNumber=t,!0):!1},i.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},i.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},i.prototype.setStyles=function(t){return mt(this.styles,t),!0},i.prototype.setExtendData=function(t){return this.extendData!==t?(this.extendData=t,!0):!1},i.prototype.setFigures=function(t){return this.figures!==t?(this.figures=t,!0):!1},i.prototype.setMinValue=function(t){return this.minValue!==t?(this.minValue=t,!0):!1},i.prototype.setMaxValue=function(t){return this.maxValue!==t?(this.maxValue=t,!0):!1},i.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t?(this.regenerateFigures=t,!0):!1},i.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t?(this.createTooltipDataSource=t,!0):!1},i.prototype.setDraw=function(t){return this.draw!==t?(this.draw=t,!0):!1},i.prototype.calcIndicator=function(t){return ne(this,void 0,void 0,function(){var e;return ae(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=r.sent(),this.result=e,[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}})})},i.extend=function(t){var e=function(r){N(n,r);function n(){return r.call(this,t)||this}return n.prototype.calc=function(a,s){return t.calc(a,s)},n}(i);return e},i}(),se;(function(i){i.Normal="normal",i.WeakMagnet="weak_magnet",i.StrongMagnet="strong_magnet"})(se||(se={}));function Zi(){return["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]}var cr=1,de=-1,qi="overlay_",ie="overlay_figure_",Ki=function(){function i(t){this.currentStep=cr,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,r=t.modeSensitivity,n=t.extendData,a=t.styles,s=t.name,o=t.totalStep,l=t.lock,u=t.visible,c=t.zLevel,h=t.needDefaultPointFigure,f=t.needDefaultXAxisFigure,d=t.needDefaultYAxisFigure,v=t.createPointFigures,p=t.createXAxisFigures,g=t.createYAxisFigures,m=t.performEventPressedMove,_=t.performEventMoveForDrawing,S=t.onDrawStart,y=t.onDrawing,x=t.onDrawEnd,w=t.onClick,b=t.onDoubleClick,E=t.onRightClick,C=t.onPressedMoveStart,M=t.onPressedMoving,I=t.onPressedMoveEnd,P=t.onMouseEnter,A=t.onMouseLeave,k=t.onRemoved,B=t.onSelected,L=t.onDeselected;this.name=s,this.totalStep=!F(o)||o<2?1:o,this.lock=l??!1,this.visible=u??!0,this.zLevel=c??0,this.needDefaultPointFigure=h??!1,this.needDefaultXAxisFigure=f??!1,this.needDefaultYAxisFigure=d??!1,this.mode=e??se.Normal,this.modeSensitivity=r??8,this.extendData=n,this.styles=_e(a??{}),this.createPointFigures=v??null,this.createXAxisFigures=p??null,this.createYAxisFigures=g??null,this.performEventPressedMove=m??null,this.performEventMoveForDrawing=_??null,this.onDrawStart=S??null,this.onDrawing=y??null,this.onDrawEnd=x??null,this.onClick=w??null,this.onDoubleClick=b??null,this.onRightClick=E??null,this.onPressedMoveStart=C??null,this.onPressedMoving=M??null,this.onPressedMoveEnd=I??null,this.onMouseEnter=P??null,this.onMouseLeave=A??null,this.onRemoved=k??null,this.onSelected=B??null,this.onDeselected=L??null}return i.prototype.setId=function(t){return O(this.id)?!1:(this.id=t,!0)},i.prototype.setGroupId=function(t){return O(this.groupId)?!1:(this.groupId=t,!0)},i.prototype.setPaneId=function(t){this.paneId=t},i.prototype.setExtendData=function(t){return t!==this.extendData?(this.extendData=t,!0):!1},i.prototype.setStyles=function(t){return mt(this.styles,t),!0},i.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=Or([],ee(t),!1),t.length>=this.totalStep-1?(this.currentStep=de,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),this.performEventMoveForDrawing!==null)for(var r=0;r<e;r++)this.performEventMoveForDrawing({currentStep:r+2,mode:this.mode,points:this.points,performPointIndex:r,performPoint:this.points[r]});return this.currentStep===de&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},i.prototype.setLock=function(t){return this.lock!==t?(this.lock=t,!0):!1},i.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},i.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},i.prototype.setMode=function(t){return this.mode!==t?(this.mode=t,!0):!1},i.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t?(this.modeSensitivity=t,!0):!1},i.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t?(this.onDrawStart=t,!0):!1},i.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t?(this.onDrawing=t,!0):!1},i.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t?(this.onDrawEnd=t,!0):!1},i.prototype.setOnClickCallback=function(t){return this.onClick!==t?(this.onClick=t,!0):!1},i.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t?(this.onDoubleClick=t,!0):!1},i.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t?(this.onRightClick=t,!0):!1},i.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t?(this.onPressedMoveStart=t,!0):!1},i.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t?(this.onPressedMoving=t,!0):!1},i.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t?(this.onPressedMoveEnd=t,!0):!1},i.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t?(this.onMouseEnter=t,!0):!1},i.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t?(this.onMouseLeave=t,!0):!1},i.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t?(this.onRemoved=t,!0):!1},i.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t?(this.onSelected=t,!0):!1},i.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t?(this.onDeselected=t,!0):!1},i.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=de:this.currentStep++},i.prototype.forceComplete=function(){this.currentStep=de},i.prototype.isDrawing=function(){return this.currentStep!==de},i.prototype.isStart=function(){return this.currentStep===cr},i.prototype.eventMoveForDrawing=function(t){var e,r=this.currentStep-1,n={};F(t.timestamp)&&(n.timestamp=t.timestamp),F(t.dataIndex)&&(n.dataIndex=t.dataIndex),F(t.value)&&(n.value=t.value),this.points[r]=n,(e=this.performEventMoveForDrawing)===null||e===void 0||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:r,performPoint:n})},i.prototype.eventPressedPointMove=function(t,e){var r;F(t.dataIndex)&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),F(t.value)&&(this.points[e].value=t.value),(r=this.performEventPressedMove)===null||r===void 0||r.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},i.prototype.startPressedMove=function(t){this._prevPressedPoint=R({},t),this._prevPressedPoints=_e(this.points)},i.prototype.eventPressedOtherMove=function(t,e){if(this._prevPressedPoint!==null){var r;F(t.dataIndex)&&F(this._prevPressedPoint.dataIndex)&&(r=t.dataIndex-this._prevPressedPoint.dataIndex);var n;F(t.value)&&F(this._prevPressedPoint.value)&&(n=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(a){var s;F(a.timestamp)&&(a.dataIndex=e.timestampToDataIndex(a.timestamp));var o=R({},a);return F(r)&&F(a.dataIndex)&&(o.dataIndex=a.dataIndex+r,o.timestamp=(s=e.dataIndexToTimestamp(o.dataIndex))!==null&&s!==void 0?s:void 0),F(n)&&F(a.value)&&(o.value=a.value+n),o})}},i.extend=function(t){var e=function(r){N(n,r);function n(){return r.call(this,t)||this}return n}(i);return e},i}(),lt;(function(i){i[i.Tooltip=0]="Tooltip",i[i.Crosshair=1]="Crosshair",i[i.XAxis=2]="XAxis"})(lt||(lt={}));function Qi(){return{formatDate:Gi,formatBigNumber:$i}}var Ji="en-US",Oe=-1;function Ie(i){return kt(window.requestAnimationFrame)?window.requestAnimationFrame(i):window.setTimeout(i,20)}function hr(i){kt(window.cancelAnimationFrame)?window.cancelAnimationFrame(i):window.clearTimeout(i)}var He=function(){function i(t){this._options={duration:500,iterationCount:1},this._currentIterationCount=0,this._running=!1,this._time=0,mt(this._options,t)}return i.prototype._loop=function(){var t=this;this._running=!0;var e=function(){var r;if(t._running){var n=new Date().getTime()-t._time;n<t._options.duration?((r=t._doFrameCallback)===null||r===void 0||r.call(t,n),Ie(e)):(t.stop(),t._currentIterationCount++,t._currentIterationCount<t._options.iterationCount&&t.start())}};Ie(e)},i.prototype.doFrame=function(t){return this._doFrameCallback=t,this},i.prototype.setDuration=function(t){return this._options.duration=t,this},i.prototype.setIterationCount=function(t){return this._options.iterationCount=t,this},i.prototype.start=function(){this._running||(this._time=new Date().getTime(),this._loop())},i.prototype.stop=function(){var t;this._running&&((t=this._doFrameCallback)===null||t===void 0||t.call(this,this._options.duration)),this._running=!1},i}(),Ne=1,vr=new Date().getTime();function Wr(i){var t=new Date().getTime();return t===vr?++Ne:Ne=1,vr=t,"".concat(i??"").concat(t,"_").concat(Ne)}function Ft(i,t){var e,r=document.createElement(i),n=t??{};for(var a in n)r.style[a]=(e=n[a])!==null&&e!==void 0?e:"";return r}function Ge(i,t,e){var r=0,n=0;for(n=i.length-1;r!==n;){var a=Math.floor((n+r)/2),s=n-r,o=i[a][t];if(e===i[r][t])return r;if(e===i[n][t])return n;if(e===o)return a;if(e>o?r=a:n=a,s<=2)break}return r}function tn(i){var t=Math.floor(fe(i)),e=Zt(t),r=i/e,n=0;return r<1.5?n=1:r<2.5?n=2:r<3.5?n=3:r<4.5?n=4:r<5.5?n=5:r<6.5?n=6:n=8,i=n*e,t>=-20?+i.toFixed(t<0?-t:0):i}function dr(i,t){t==null&&(t=10),t=Math.min(Math.max(0,t),20);var e=(+i).toFixed(t);return+e}function en(i){var t=i.toString(),e=t.indexOf("e");if(e>0){var r=+t.slice(e+1);return r<0?-r:0}else{var n=t.indexOf(".");return n<0?0:t.length-1-n}}function zr(i,t,e){var r=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return i.forEach(function(n){var a,s;r[0]=Math.max((a=n[t])!==null&&a!==void 0?a:n,r[0]),r[1]=Math.min((s=n[e])!==null&&s!==void 0?s:n,r[1])}),r}function fe(i){return Math.log(i)/Math.log(10)}function Zt(i){return Math.pow(10,i)}function fr(){return{from:0,to:0,realFrom:0,realTo:0}}var pr={MIN:1,MAX:50},rn=8,nn=80,an=.88,$e=10,on=function(){function i(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._totalBarSpace=0,this._barSpace=rn,this._offsetRightDistance=nn,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange=fr(),this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace}return i.prototype._calcGapBarSpace=function(){var t;return this._barSpace>3?t=Math.floor(this._barSpace*an):(t=Math.floor(this._barSpace),t===this._barSpace&&t--),t%2===0&&t--,t=Math.max(1,t),t},i.prototype.adjustVisibleRange=function(){var t,e,r=this._chartStore.getDataList(),n=r.length,a=this._totalBarSpace/this._barSpace,s,o;this._scrollLimitRole===1?(s=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,o=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(s=this._minVisibleBarCount.left,o=this._minVisibleBarCount.right),s=Math.max(0,s),o=Math.max(0,o);var l=a-Math.min(s,n);this._lastBarRightSideDiffBarCount>l&&(this._lastBarRightSideDiffBarCount=l);var u=-n+Math.min(o,n);this._lastBarRightSideDiffBarCount<u&&(this._lastBarRightSideDiffBarCount=u);var c=Math.round(this._lastBarRightSideDiffBarCount+n+.5),h=c;c>n&&(c=n);var f=Math.round(c-a)-1;f<0&&(f=0);var d=this._lastBarRightSideDiffBarCount>0?Math.round(n+this._lastBarRightSideDiffBarCount-a)-1:f;if(this._visibleRange={from:f,to:c,realFrom:d,realTo:h},this._chartStore.getActionStore().execute(gt.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),f===0){var v=r[0];this._chartStore.executeLoadMoreCallback((t=v==null?void 0:v.timestamp)!==null&&t!==void 0?t:null),this._chartStore.executeLoadDataCallback({type:pt.Forward,data:v??null})}c===n&&this._chartStore.executeLoadDataCallback({type:pt.Backward,data:(e=r[n-1])!==null&&e!==void 0?e:null})},i.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},i.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};O(t)&&(e.timeZone=t);var r=null;try{r=new Intl.DateTimeFormat("en",e)}catch{}return r},i.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);e!==null&&(this._dateTimeFormat=e)},i.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},i.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:Math.floor(this._gapBarSpace/2)}},i.prototype.setBarSpace=function(t,e){t<pr.MIN||t>pr.MAX||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),e==null||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},i.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},i.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=this._scrollLimitRole===1?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,(e??!1)&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},i.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},i.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},i.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},i.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},i.prototype.setLastBarRightSideDiffBarCount=function(t){return this._lastBarRightSideDiffBarCount=t,this},i.prototype.setMaxOffsetLeftDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.left=t,this},i.prototype.setMaxOffsetRightDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.right=t,this},i.prototype.setLeftMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.left=t,this},i.prototype.setRightMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.right=t,this},i.prototype.getVisibleRange=function(){return this._visibleRange},i.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},i.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace,r=this._lastBarRightSideDiffBarCount*this._barSpace;this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0);var n=Math.round(r-this._lastBarRightSideDiffBarCount*this._barSpace);n!==0&&this._chartStore.getActionStore().execute(gt.OnScroll,{distance:n})}},i.prototype.getDataByDataIndex=function(t){var e;return(e=this._chartStore.getDataList()[t])!==null&&e!==void 0?e:null},i.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,r=(this._totalBarSpace-t)/this._barSpace,n=e+this._lastBarRightSideDiffBarCount-r;return Math.round(n*1e6)/1e6},i.prototype.dataIndexToTimestamp=function(t){var e,r=this.getDataByDataIndex(t);return(e=r==null?void 0:r.timestamp)!==null&&e!==void 0?e:null},i.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return e.length===0?0:Ge(e,"timestamp",t)},i.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length,r=e+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(r-.5)*this._barSpace)},i.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},i.prototype.zoom=function(t,e){var r=this,n;if(this._zoomEnabled){var a=e??null;if(!F(a==null?void 0:a.x)){var s=this._chartStore.getTooltipStore().getCrosshair();a={x:(n=s==null?void 0:s.x)!==null&&n!==void 0?n:this._totalBarSpace/2}}var o=a.x,l=this.coordinateToFloatIndex(o),u=this._barSpace,c=this._barSpace+t*(this._barSpace/$e);this.setBarSpace(c,function(){r._lastBarRightSideDiffBarCount+=l-r.coordinateToFloatIndex(o)});var h=this._barSpace/u;h!==1&&this._chartStore.getActionStore().execute(gt.OnZoom,{scale:h})}},i.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},i.prototype.getZoomEnabled=function(){return this._zoomEnabled},i.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},i.prototype.getScrollEnabled=function(){return this._scrollEnabled},i.prototype.clear=function(){this._visibleRange=fr()},i}(),sn={name:"AVP",shortName:"AVP",series:ht.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(i){var t=0,e=0;return i.map(function(r){var n,a,s={},o=(n=r==null?void 0:r.turnover)!==null&&n!==void 0?n:0,l=(a=r==null?void 0:r.volume)!==null&&a!==void 0?a:0;return t+=o,e+=l,e!==0&&(s.avp=t/e),s})}},ln={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(i,t,e){var r,n,a,s,o=i.prev,l=i.current,u=(n=(r=o.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,c=(s=(a=l.indicatorData)===null||a===void 0?void 0:a.ao)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER,h;c>u?h=ot(t.styles,"bars[0].upColor",e.bars[0].upColor):h=ot(t.styles,"bars[0].downColor",e.bars[0].downColor);var f=c>u?X.Stroke:X.Fill;return{color:h,style:f,borderColor:h}}}],calc:function(i,t){var e=t.calcParams,r=Math.max(e[0],e[1]),n=0,a=0,s=0,o=0;return i.map(function(l,u){var c={},h=(l.low+l.high)/2;if(n+=h,a+=h,u>=e[0]-1){s=n/e[0];var f=i[u-(e[0]-1)];n-=(f.low+f.high)/2}if(u>=e[1]-1){o=a/e[1];var f=i[u-(e[1]-1)];a-=(f.low+f.high)/2}return u>=r-1&&(c.ao=s-o),c})}},un={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,n=[];return i.map(function(a,s){var o={},l=a.close;return e.forEach(function(u,c){var h;if(n[c]=((h=n[c])!==null&&h!==void 0?h:0)+l,s>=u-1){var f=n[c]/e[c];o[r[c].key]=(l-f)/f*100,n[c]-=i[s-(u-1)].close}}),o})}};function cn(i,t){var e=i.length,r=0;return i.forEach(function(n){var a=n.close-t;r+=a*a}),r=Math.abs(r),Math.sqrt(r/e)}var hn={name:"BOLL",shortName:"BOLL",series:ht.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=e[0]-1,n=0;return i.map(function(a,s){var o=a.close,l={};if(n+=o,s>=r){l.mid=n/e[0];var u=cn(i.slice(s-r,s+1),l.mid);l.up=l.mid+e[1]*u,l.dn=l.mid-e[1]*u,n-=i[s-r].close}return l})}},vn={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=0,a=0,s=0;return i.map(function(o,l){var u,c,h={},f=o.high,d=o.low,v=o.open,p=((u=i[l-1])!==null&&u!==void 0?u:o).close;if(a+=f-v,s+=v-d,r+=f-p,n+=p-d,l>=e[0]-1){s!==0?h.ar=a/s*100:h.ar=0,n!==0?h.br=r/n*100:h.br=0;var g=i[l-(e[0]-1)],m=g.high,_=g.low,S=g.open,y=((c=i[l-e[0]])!==null&&c!==void 0?c:i[l-(e[0]-1)]).close;r-=m-y,n-=y-_,a-=m-S,s-=S-_}return h})}},dn={name:"BBI",shortName:"BBI",series:ht.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.max.apply(Math,Or([],ee(e),!1)),n=[],a=[];return i.map(function(s,o){var l={},u=s.close;if(e.forEach(function(h,f){var d;n[f]=((d=n[f])!==null&&d!==void 0?d:0)+u,o>=h-1&&(a[f]=n[f]/h,n[f]-=i[o-(h-1)].close)}),o>=r-1){var c=0;a.forEach(function(h){c+=h}),l.bbi=c/4}return l})}},fn={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=e[0]-1,n=0,a=[];return i.map(function(s,o){var l={},u=(s.high+s.low+s.close)/3;if(n+=u,a.push(u),o>=r){var c=n/e[0],h=a.slice(o-r,o+1),f=0;h.forEach(function(p){f+=Math.abs(p-c)});var d=f/e[0];l.cci=d!==0?(u-c)/d/.015:0;var v=(i[o-r].high+i[o-r].low+i[o-r].close)/3;n-=v}return l})}},pn={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.ceil(e[1]/2.5+1),n=Math.ceil(e[2]/2.5+1),a=Math.ceil(e[3]/2.5+1),s=Math.ceil(e[4]/2.5+1),o=0,l=[],u=0,c=[],h=0,f=[],d=0,v=[],p=[];return i.forEach(function(g,m){var _,S,y,x,w,b={},E=(_=i[m-1])!==null&&_!==void 0?_:g,C=(E.high+E.close+E.low+E.open)/4,M=Math.max(0,g.high-C),I=Math.max(0,C-g.low);m>=e[0]-1&&(I!==0?b.cr=M/I*100:b.cr=0,o+=b.cr,u+=b.cr,h+=b.cr,d+=b.cr,m>=e[0]+e[1]-2&&(l.push(o/e[1]),m>=e[0]+e[1]+r-3&&(b.ma1=l[l.length-1-r]),o-=(S=p[m-(e[1]-1)].cr)!==null&&S!==void 0?S:0),m>=e[0]+e[2]-2&&(c.push(u/e[2]),m>=e[0]+e[2]+n-3&&(b.ma2=c[c.length-1-n]),u-=(y=p[m-(e[2]-1)].cr)!==null&&y!==void 0?y:0),m>=e[0]+e[3]-2&&(f.push(h/e[3]),m>=e[0]+e[3]+a-3&&(b.ma3=f[f.length-1-a]),h-=(x=p[m-(e[3]-1)].cr)!==null&&x!==void 0?x:0),m>=e[0]+e[4]-2&&(v.push(d/e[4]),m>=e[0]+e[4]+s-3&&(b.ma4=v[v.length-1-s]),d-=(w=p[m-(e[4]-1)].cr)!==null&&w!==void 0?w:0)),p.push(b)}),p}},gn={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=Math.max(e[0],e[1]),n=0,a=0,s=0,o=[];return i.forEach(function(l,u){var c,h={},f=l.close;n+=f,a+=f;var d=0,v=0;if(u>=e[0]-1&&(d=n/e[0],n-=i[u-(e[0]-1)].close),u>=e[1]-1&&(v=a/e[1],a-=i[u-(e[1]-1)].close),u>=r-1){var p=d-v;h.dma=p,s+=p,u>=r+e[2]-2&&(h.ama=s/e[2],s-=(c=o[u-(e[2]-1)].dma)!==null&&c!==void 0?c:0)}o.push(h)}),o}},mn={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=0,a=0,s=0,o=0,l=0,u=0,c=0,h=[];return i.forEach(function(f,d){var v,p,g={},m=(v=i[d-1])!==null&&v!==void 0?v:f,_=m.close,S=f.high,y=f.low,x=S-y,w=Math.abs(S-_),b=Math.abs(_-y),E=S-m.high,C=m.low-y,M=Math.max(Math.max(x,w),b),I=E>0&&E>C?E:0,P=C>0&&C>E?C:0;if(r+=M,n+=I,a+=P,d>=e[0]-1){d>e[0]-1?(s=s-s/e[0]+M,o=o-o/e[0]+I,l=l-l/e[0]+P):(s=r,o=n,l=a);var A=0,k=0;s!==0&&(A=o*100/s,k=l*100/s),g.pdi=A,g.mdi=k;var B=0;k+A!==0&&(B=Math.abs(k-A)/(k+A)*100),u+=B,d>=e[0]*2-2&&(d>e[0]*2-2?c=(c*(e[0]-1)+B)/e[0]:c=u/e[0],g.adx=c,d>=e[0]*2+e[1]-3&&(g.adxr=(((p=h[d-(e[1]-1)].adx)!==null&&p!==void 0?p:0)+c)/2))}h.push(g)}),h}},_n={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=[];return i.map(function(a,s){var o,l={};if(s>0){var u=i[s-1],c=a.high,h=a.low,f=(o=a.volume)!==null&&o!==void 0?o:0,d=(c+h)/2-(u.high+u.low)/2;if(f===0||c-h===0)l.emv=0;else{var v=f/1e8/(c-h);l.emv=d/v}r+=l.emv,n.push(l.emv),s>=e[0]&&(l.maEmv=r/e[0],r-=n[s-e[0]])}return l})}},yn={name:"EMA",shortName:"EMA",series:ht.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,n=0,a=[];return i.map(function(s,o){var l={},u=s.close;return n+=u,e.forEach(function(c,h){o>=c-1&&(o>c-1?a[h]=(2*u+(c-1)*a[h])/(c+1):a[h]=n/c,l[r[h].key]=a[h])}),l})}},Sn={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=[];return i.forEach(function(a,s){var o,l={};if(s>=e[0]){var u=a.close,c=i[s-e[0]].close;l.mtm=u-c,r+=l.mtm,s>=e[0]+e[1]-1&&(l.maMtm=r/e[1],r-=(o=n[s-(e[1]-1)].mtm)!==null&&o!==void 0?o:0)}n.push(l)}),n}},xn={name:"MA",shortName:"MA",series:ht.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,n=[];return i.map(function(a,s){var o={},l=a.close;return e.forEach(function(u,c){var h;n[c]=((h=n[c])!==null&&h!==void 0?h:0)+l,s>=u-1&&(o[r[c].key]=n[c]/u,n[c]-=i[s-(u-1)].close)}),o})}},bn={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(i,t,e){var r,n,a,s,o=i.prev,l=i.current,u=(n=(r=o.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,c=(s=(a=l.indicatorData)===null||a===void 0?void 0:a.macd)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER,h;c>0?h=ot(t.styles,"bars[0].upColor",e.bars[0].upColor):c<0?h=ot(t.styles,"bars[0].downColor",e.bars[0].downColor):h=ot(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);var f=u<c?X.Stroke:X.Fill;return{style:f,color:h,borderColor:h}}}],calc:function(i,t){var e=t.calcParams,r=0,n,a,s=0,o=0,l=0,u=Math.max(e[0],e[1]);return i.map(function(c,h){var f={},d=c.close;return r+=d,h>=e[0]-1&&(h>e[0]-1?n=(2*d+(e[0]-1)*n)/(e[0]+1):n=r/e[0]),h>=e[1]-1&&(h>e[1]-1?a=(2*d+(e[1]-1)*a)/(e[1]+1):a=r/e[1]),h>=u-1&&(s=n-a,f.dif=s,o+=s,h>=u+e[2]-2&&(h>u+e[2]-2?l=(s*2+l*(e[2]-1))/(e[2]+1):l=o/e[2],f.macd=(s-l)*2,f.dea=l)),f})}},wn={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=0,a=[];return i.forEach(function(s,o){var l,u,c,h,f=(l=i[o-1])!==null&&l!==void 0?l:s;s.close<f.close?n-=(u=s.volume)!==null&&u!==void 0?u:0:s.close>f.close&&(n+=(c=s.volume)!==null&&c!==void 0?c:0);var d={obv:n};r+=n,o>=e[0]-1&&(d.maObv=r/e[0],r-=(h=a[o-(e[0]-1)].obv)!==null&&h!==void 0?h:0),a.push(d)}),a}},Cn={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(i){var t=0;return i.map(function(e,r){var n,a,s={},o=e.close,l=(n=e.volume)!==null&&n!==void 0?n:1,u=((a=i[r-1])!==null&&a!==void 0?a:e).close,c=0,h=u*l;return h!==0&&(c=(o-u)/h),t+=c,s.pvt=t,s})}},En={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=0,a=[],s=[];return i.forEach(function(o,l){var u,c,h={},f=((u=i[l-1])!==null&&u!==void 0?u:o).close,d=o.close-f>0?1:0;a.push(d),r+=d,l>=e[0]-1&&(h.psy=r/e[0]*100,n+=h.psy,l>=e[0]+e[1]-2&&(h.maPsy=n/e[1],n-=(c=s[l-(e[1]-1)].psy)!==null&&c!==void 0?c:0),r-=a[l-(e[0]-1)]),s.push(h)}),s}},In={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=[],n=0;return i.forEach(function(a,s){var o,l,u={};if(s>=e[0]-1){var c=a.close,h=((o=i[s-e[0]])!==null&&o!==void 0?o:i[s-(e[0]-1)]).close;h!==0?u.roc=(c-h)/h*100:u.roc=0,n+=u.roc,s>=e[0]-1+e[1]-1&&(u.maRoc=n/e[1],n-=(l=r[s-(e[1]-1)].roc)!==null&&l!==void 0?l:0)}r.push(u)}),r}},Pn={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){var r=e+1;return{key:"rsi".concat(r),title:"RSI".concat(r,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures,n=[],a=[];return i.map(function(s,o){var l,u={},c=((l=i[o-1])!==null&&l!==void 0?l:s).close,h=s.close-c;return e.forEach(function(f,d){var v,p,g;if(h>0?n[d]=((v=n[d])!==null&&v!==void 0?v:0)+h:a[d]=((p=a[d])!==null&&p!==void 0?p:0)+Math.abs(h),o>=f-1){a[d]!==0?u[r[d].key]=100-100/(1+n[d]/a[d]):u[r[d].key]=0;var m=i[o-(f-1)],_=(g=i[o-f])!==null&&g!==void 0?g:m,S=m.close-_.close;S>0?n[d]-=S:a[d]-=Math.abs(S)}}),u})}},Mn={name:"SMA",shortName:"SMA",series:ht.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(i,t){var e=t.calcParams,r=0,n=0;return i.map(function(a,s){var o={},l=a.close;return r+=l,s>=e[0]-1&&(s>e[0]-1?n=(l*e[1]+n*(e[0]-e[1]+1))/(e[0]+1):n=r/e[0],o.sma=n),o})}},Tn={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=[];return i.forEach(function(n,a){var s,o,l,u,c={},h=n.close;if(a>=e[0]-1){var f=zr(i.slice(a-(e[0]-1),a+1),"high","low"),d=f[0],v=f[1],p=d-v,g=(h-v)/(p===0?1:p)*100;c.k=((e[1]-1)*((o=(s=r[a-1])===null||s===void 0?void 0:s.k)!==null&&o!==void 0?o:50)+g)/e[1],c.d=((e[2]-1)*((u=(l=r[a-1])===null||l===void 0?void 0:l.d)!==null&&u!==void 0?u:50)+c.k)/e[2],c.j=3*c.k-2*c.d}r.push(c)}),r}},Dn={name:"SAR",shortName:"SAR",series:ht.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(i,t,e){var r,n,a=i.current,s=(n=(r=a.indicatorData)===null||r===void 0?void 0:r.sar)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,o=a.kLineData,l=((o==null?void 0:o.high)+(o==null?void 0:o.low))/2,u=s<l?ot(t.styles,"circles[0].upColor",e.circles[0].upColor):ot(t.styles,"circles[0].downColor",e.circles[0].downColor);return{color:u}}}],calc:function(i,t){var e=t.calcParams,r=e[0]/100,n=e[1]/100,a=e[2]/100,s=r,o=-100,l=!1,u=0;return i.map(function(c,h){var f=u,d=c.high,v=c.low;if(l){(o===-100||o<d)&&(o=d,s=Math.min(s+n,a)),u=f+s*(o-f);var p=Math.min(i[Math.max(1,h)-1].low,v);u>c.low?(u=o,s=r,o=-100,l=!l):u>p&&(u=p)}else{(o===-100||o>v)&&(o=v,s=Math.min(s+n,a)),u=f+s*(o-f);var g=Math.max(i[Math.max(1,h)-1].high,d);u<c.high?(u=o,s=0,o=-100,l=!l):u<g&&(u=g)}return{sar:u}})}},An={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n,a,s,o=0,l=0,u=0,c=[];return i.forEach(function(h,f){var d,v={},p=h.close;if(r+=p,f>=e[0]-1&&(f>e[0]-1?n=(2*p+(e[0]-1)*n)/(e[0]+1):n=r/e[0],o+=n,f>=e[0]*2-2&&(f>e[0]*2-2?a=(2*n+(e[0]-1)*a)/(e[0]+1):a=o/e[0],l+=a,f>=e[0]*3-3))){var g=void 0,m=0;f>e[0]*3-3?(g=(2*a+(e[0]-1)*s)/(e[0]+1),m=(g-s)/s*100):g=l/e[0],s=g,v.trix=m,u+=m,f>=e[0]*3+e[1]-4&&(v.maTrix=u/e[1],u-=(d=c[f-(e[1]-1)].trix)!==null&&d!==void 0?d:0)}c.push(v)}),c}};function gr(){return{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(i,t,e){var r=i.current.kLineData,n=ot(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);return T(r)&&(r.close>r.open?n=ot(t.styles,"bars[0].upColor",e.bars[0].upColor):r.close<r.open&&(n=ot(t.styles,"bars[0].downColor",e.bars[0].downColor))),{color:n}}}}var kn={name:"VOL",shortName:"VOL",series:ht.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},gr()],regenerateFigures:function(i){var t=i.map(function(e,r){return{key:"ma".concat(r+1),title:"MA".concat(e,": "),type:"line"}});return t.push(gr()),t},calc:function(i,t){var e=t.calcParams,r=t.figures,n=[];return i.map(function(a,s){var o,l=(o=a.volume)!==null&&o!==void 0?o:0,u={volume:l};return e.forEach(function(c,h){var f,d;n[h]=((f=n[h])!==null&&f!==void 0?f:0)+l,s>=c-1&&(u[r[h].key]=n[h]/c,n[h]-=(d=i[s-(c-1)].volume)!==null&&d!==void 0?d:0)}),u})}},Fn={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(i,t){var e=t.calcParams,r=0,n=0,a=0,s=0,o=[];return i.forEach(function(l,u){var c,h,f,d,v,p={},g=l.close,m=((c=i[u-1])!==null&&c!==void 0?c:l).close,_=(h=l.volume)!==null&&h!==void 0?h:0;if(g>m?r+=_:g<m?n+=_:a+=_,u>=e[0]-1){var S=a/2;n+S===0?p.vr=0:p.vr=(r+S)/(n+S)*100,s+=p.vr,u>=e[0]+e[1]-2&&(p.maVr=s/e[1],s-=(f=o[u-(e[1]-1)].vr)!==null&&f!==void 0?f:0);var y=i[u-(e[0]-1)],x=(d=i[u-e[0]])!==null&&d!==void 0?d:y,w=y.close,b=(v=y.volume)!==null&&v!==void 0?v:0;w>x.close?r-=b:w<x.close?n-=b:a-=b}o.push(p)}),o}},Rn={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(i){return i.map(function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}})},calc:function(i,t){var e=t.calcParams,r=t.figures;return i.map(function(n,a){var s={},o=n.close;return e.forEach(function(l,u){var c=l-1;if(a>=c){var h=zr(i.slice(a-c,a+1),"high","low"),f=h[0],d=h[1],v=f-d;s[r[u].key]=v===0?0:(o-f)/v*100}}),s})}},Xr={},Bn=[sn,ln,un,hn,vn,dn,fn,pn,gn,mn,_n,yn,Sn,xn,bn,wn,Cn,En,In,Pn,Mn,Tn,Dn,An,kn,Fn,Rn];Bn.forEach(function(i){Xr[i.name]=ji.extend(i)});function Yr(i){var t;return(t=Xr[i])!==null&&t!==void 0?t:null}var Ln=function(){function i(t){this._instances=new Map,this._chartStore=t}return i.prototype._overrideInstance=function(t,e){var r=e.shortName,n=e.series,a=e.calcParams,s=e.precision,o=e.figures,l=e.minValue,u=e.maxValue,c=e.shouldOhlc,h=e.shouldFormatBigNumber,f=e.visible,d=e.zLevel,v=e.styles,p=e.extendData,g=e.regenerateFigures,m=e.createTooltipDataSource,_=e.draw,S=e.calc,y=!1;O(r)&&t.setShortName(r)&&(y=!0),T(n)&&t.setSeries(n)&&(y=!0);var x=!1;wt(a)&&t.setCalcParams(a)&&(y=!0,x=!0),wt(o)&&t.setFigures(o)&&(y=!0,x=!0),l!==void 0&&t.setMinValue(l)&&(y=!0),u!==void 0&&t.setMinValue(u)&&(y=!0),F(s)&&t.setPrecision(s)&&(y=!0),Qt(c)&&t.setShouldOhlc(c)&&(y=!0),Qt(h)&&t.setShouldFormatBigNumber(h)&&(y=!0),Qt(f)&&t.setVisible(f)&&(y=!0);var w=!1;return F(d)&&t.setZLevel(d)&&(y=!0,w=!0),T(v)&&t.setStyles(v)&&(y=!0),p!==void 0&&t.setExtendData(p)&&(y=!0,x=!0),g!==void 0&&t.setRegenerateFigures(g)&&(y=!0),m!==void 0&&t.setCreateTooltipDataSource(m)&&(y=!0),_!==void 0&&t.setDraw(_)&&(y=!0),kt(S)&&(t.calc=S,x=!0),[y,x,w]},i.prototype._sort=function(t){var e;O(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(r,n){return r.zLevel-n.zLevel}):this._instances.forEach(function(r){r.sort(function(n,a){return n.zLevel-a.zLevel})})},i.prototype.addInstance=function(t,e,r){return ne(this,void 0,void 0,function(){var n,a,s,o,l;return ae(this,function(u){switch(u.label){case 0:return n=t.name,a=this._instances.get(e),T(a)?(s=a.find(function(c){return c.name===n}),T(s)?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2]):[3,2];case 1:return[2,u.sent()];case 2:return T(a)||(a=[]),o=Yr(n),l=new o,this.synchronizeSeriesPrecision(l),this._overrideInstance(l,t),r||(a=[]),a.push(l),this._instances.set(e,a),this._sort(e),[4,l.calcIndicator(this._chartStore.getDataList())];case 3:return[2,u.sent()]}})})},i.prototype.getInstances=function(t){var e;return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},i.prototype.removeInstance=function(t,e){var r,n=!1,a=this._instances.get(t);if(T(a)){if(O(e)){var s=a.findIndex(function(o){return o.name===e});s>-1&&(a.splice(s,1),n=!0)}else this._instances.set(t,[]),n=!0;((r=this._instances.get(t))===null||r===void 0?void 0:r.length)===0&&this._instances.delete(t)}return n},i.prototype.hasInstances=function(t){return this._instances.has(t)},i.prototype.calcInstance=function(t,e){return ne(this,void 0,void 0,function(){var r,n,a,s,o=this;return ae(this,function(l){switch(l.label){case 0:return r=[],O(t)?O(e)?(n=this._instances.get(e),T(n)&&(a=n.find(function(u){return u.name===t}),T(a)&&r.push(a.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(u){var c=u.find(function(h){return h.name===t});T(c)&&r.push(c.calcIndicator(o._chartStore.getDataList()))}):this._instances.forEach(function(u){u.forEach(function(c){r.push(c.calcIndicator(o._chartStore.getDataList()))})}),[4,Promise.all(r)];case 1:return s=l.sent(),[2,s.includes(!0)]}})})},i.prototype.getInstanceByPaneId=function(t,e){var r,n,a=function(l){var u=new Map;return l.forEach(function(c){u.set(c.name,c)}),u};if(O(t)){var s=(r=this._instances.get(t))!==null&&r!==void 0?r:[];return O(e)?(n=s==null?void 0:s.find(function(l){return l.name===e}))!==null&&n!==void 0?n:null:a(s)}var o=new Map;return this._instances.forEach(function(l,u){o.set(u,a(l))}),o},i.prototype.synchronizeSeriesPrecision=function(t){var e=this._chartStore.getPrecision(),r=e.price,n=e.volume,a=function(s){switch(s.series){case ht.Price:{s.setPrecision(r,!0);break}case ht.Volume:{s.setPrecision(n,!0);break}}};T(t)?a(t):this._instances.forEach(function(s){s.forEach(function(o){a(o)})})},i.prototype.override=function(t,e){return ne(this,void 0,void 0,function(){var r,n,a,s,o,l,u,c=this;return ae(this,function(h){switch(h.label){case 0:return r=t.name,n=new Map,e!==null?(a=this._instances.get(e),T(a)&&n.set(e,a)):n=this._instances,s=!1,o=[],l=!1,n.forEach(function(f){var d=f.find(function(p){return p.name===r});if(T(d)){var v=c._overrideInstance(d,t);v[2]&&(l=!0),v[1]?o.push(d.calcIndicator(c._chartStore.getDataList())):v[0]&&(s=!0)}}),l&&this._sort(),[4,Promise.all(o)];case 1:return u=h.sent(),[2,[s,u.includes(!0)]]}})})},i}(),Vn=function(){function i(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return i.prototype.setCrosshair=function(t,e){var r=e??{},n=r.notInvalidate,a=r.notExecuteAction,s=this._chartStore.getDataList(),o=t??{},l,u;F(o.x)?(l=this._chartStore.getTimeScaleStore().coordinateToDataIndex(o.x),l<0?u=0:l>s.length-1?u=s.length-1:u=l):(l=s.length-1,u=l);var c=s[u],h=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(l),f={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair=R(R({},o),{realX:h,kLineData:c,realDataIndex:l,dataIndex:u}),(f.x!==o.x||f.y!==o.y||f.paneId!==o.paneId)&&(c!==null&&!(a??!1)&&this._chartStore.getChart().crosshairChange(this._crosshair),(n??!1)||this._chartStore.getChart().updatePane(1))},i.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,{notInvalidate:t})},i.prototype.getCrosshair=function(){return this._crosshair},i.prototype.setActiveIcon=function(t){this._activeIcon=t??null},i.prototype.getActiveIcon=function(){return this._activeIcon},i.prototype.clear=function(){this.setCrosshair({},{notInvalidate:!0}),this.setActiveIcon()},i}(),On={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t,e=i.coordinates,r=i.bounding,n=i.overlay,a=i.precision,s=i.thousandsSeparator,o=i.decimalFoldThreshold,l=i.yAxis,u=n.points;if(e.length>0){var c=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?a.price:a.excludePriceVolumeMax,h=[],f=[],d=0,v=r.width;if(e.length>1&&F(u[0].value)&&F(u[1].value)){var p=[1,.786,.618,.5,.382,.236,0],g=e[0].y-e[1].y,m=u[0].value-u[1].value;p.forEach(function(_){var S,y=e[1].y+g*_,x=nt(rt((((S=u[1].value)!==null&&S!==void 0?S:0)+m*_).toFixed(c),s),o);h.push({coordinates:[{x:d,y},{x:v,y}]}),f.push({x:d,y,text:"".concat(x," (").concat((_*100).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:h},{type:"text",isCheckEvent:!1,attrs:f}]}return[]}},Nn={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding,r={x:0,y:t[0].y};return T(t[1])&&t[0].x<t[1].x&&(r.x=e.width),[{type:"line",attrs:{coordinates:[t[0],r]}}]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].value=r.value)}},Wn={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=[];return t.length===2&&e.push({coordinates:t}),[{type:"line",attrs:e}]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].value=r.value)}},zn={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:e.width,y:t[0].y}]}}]}},Ke=function(){function i(){this._children=[],this._callbacks=new Map}return i.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},i.prototype.onEvent=function(t,e,r){var n=this._callbacks.get(t);return T(n)&&this.checkEventOn(e)?n(e,r):!1},i.prototype.checkEventOn=function(t){var e,r;try{for(var n=Jt(this._children),a=n.next();!a.done;a=n.next()){var s=a.value;if(s.checkEventOn(t))return!0}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!1},i.prototype.dispatchEvent=function(t,e,r){var n=this._children.length-1;if(n>-1){for(var a=n;a>-1;a--)if(this._children[a].dispatchEvent(t,e,r))return!0}return this.onEvent(t,e,r)},i.prototype.addChild=function(t){return this._children.push(t),this},i.prototype.clear=function(){this._children=[]},i}(),it=2,Xn=function(i){N(t,i);function t(e){var r=i.call(this)||this;return r.attrs=e.attrs,r.styles=e.styles,r}return t.prototype.checkEventOn=function(e){return this.checkEventOnImp(e,this.attrs,this.styles)},t.prototype.setAttrs=function(e){return this.attrs=e,this},t.prototype.setStyles=function(e){return this.styles=e,this},t.prototype.draw=function(e){this.drawImp(e,this.attrs,this.styles)},t.extend=function(e){var r=function(n){N(a,n);function a(){return n!==null&&n.apply(this,arguments)||this}return a.prototype.checkEventOnImp=function(s,o,l){return e.checkEventOn(s,o,l)},a.prototype.drawImp=function(s,o,l){e.draw(s,o,l)},a}(t);return r},t}(Ke);function Yn(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var n=e[r].coordinates;if(n.length>1)for(var a=1;a<n.length;a++){var s=n[a-1],o=n[a];if(s.x===o.x){if(Math.abs(s.y-i.y)+Math.abs(o.y-i.y)-Math.abs(s.y-o.y)<it+it&&Math.abs(i.x-s.x)<it)return!0}else{var l=Qe(s,o),u=Hr(l,i),c=Math.abs(u-i.y);if(Math.abs(s.x-i.x)+Math.abs(o.x-i.x)-Math.abs(s.x-o.x)<it+it&&c*c/(l[0]*l[0]+1)<it*it)return!0}}}return!1}function Hr(i,t){return i!==null?t.x*i[0]+i[1]:t.y}function Pe(i,t,e){var r=Qe(i,t);return Hr(r,e)}function Qe(i,t){var e=i.x-t.x;if(e!==0){var r=(i.y-t.y)/e,n=i.y-r*i.x;return[r,n]}return null}function Gr(i,t,e){var r=t.length,n=F(e)?e>0&&e<1?e:0:e?.5:0;if(n>0&&r>2){for(var a=t[0].x,s=t[0].y,o=1;o<r-1;o++){var l=t[o-1],u=t[o],c=t[o+1],h=u.x-l.x,f=u.y-l.y,d=c.x-u.x,v=c.y-u.y,p=c.x-l.x,g=c.y-l.y,m=Math.sqrt(h*h+f*f),_=Math.sqrt(d*d+v*v),S=_/(_+m),y=u.x+p*n*S,x=u.y+g*n*S;y=Math.min(y,Math.max(c.x,u.x)),x=Math.min(x,Math.max(c.y,u.y)),y=Math.max(y,Math.min(c.x,u.x)),x=Math.max(x,Math.min(c.y,u.y)),p=y-u.x,g=x-u.y;var w=u.x-p*m/_,b=u.y-g*m/_;w=Math.min(w,Math.max(l.x,u.x)),b=Math.min(b,Math.max(l.y,u.y)),w=Math.max(w,Math.min(l.x,u.x)),b=Math.max(b,Math.min(l.y,u.y)),p=u.x-w,g=u.y-b,y=u.x+p*_/m,x=u.y+g*_/m,i.bezierCurveTo(a,s,w,b,u.x,u.y),a=y,s=x}var E=t[r-1];i.bezierCurveTo(a,s,E.x,E.y,E.x,E.y)}else for(var o=1;o<r;o++)i.lineTo(t[o].x,t[o].y)}function Hn(i,t,e){var r=[];r=r.concat(t);var n=e.style,a=n===void 0?H.Solid:n,s=e.smooth,o=s===void 0?!1:s,l=e.size,u=l===void 0?1:l,c=e.color,h=c===void 0?"currentColor":c,f=e.dashedValue,d=f===void 0?[2,2]:f;i.lineWidth=u,i.strokeStyle=h,a===H.Dashed?i.setLineDash(d):i.setLineDash([]);var v=u%2===1?.5:0;r.forEach(function(p){var g=p.coordinates;g.length>1&&(g.length===2&&(g[0].x===g[1].x||g[0].y===g[1].y)?(i.beginPath(),g[0].x===g[1].x?(i.moveTo(g[0].x+v,g[0].y),i.lineTo(g[1].x+v,g[1].y)):(i.moveTo(g[0].x,g[0].y+v),i.lineTo(g[1].x,g[1].y+v)),i.stroke(),i.closePath()):(i.save(),u%2===1&&i.translate(.5,.5),i.beginPath(),i.moveTo(g[0].x,g[0].y),Gr(i,g,o),i.stroke(),i.closePath(),i.restore()))})}var Gn={name:"line",checkEventOn:Yn,draw:function(i,t,e){Hn(i,t,e)}};function $r(i,t,e){var r=e??0,n=[];if(i.length>1)if(i[0].x===i[1].x){var a=0,s=t.height;if(n.push({coordinates:[{x:i[0].x,y:a},{x:i[0].x,y:s}]}),i.length>2){n.push({coordinates:[{x:i[2].x,y:a},{x:i[2].x,y:s}]});for(var o=i[0].x-i[2].x,l=0;l<r;l++){var u=o*(l+1);n.push({coordinates:[{x:i[0].x+u,y:a},{x:i[0].x+u,y:s}]})}}}else{var c=0,h=t.width,f=Qe(i[0],i[1]),d=f[0],v=f[1];if(n.push({coordinates:[{x:c,y:c*d+v},{x:h,y:h*d+v}]}),i.length>2){var p=i[2].y-d*i[2].x;n.push({coordinates:[{x:c,y:c*d+p},{x:h,y:h*d+p}]});for(var o=v-p,l=0;l<r;l++){var g=v+o*(l+1);n.push({coordinates:[{x:c,y:c*d+g},{x:h,y:h*d+g}]})}}}return n}var $n={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:$r(t,e)}]}},Un={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:$r(t,e,1)}]}},jn={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t,e=i.coordinates,r=i.bounding,n=i.precision,a=i.overlay,s=i.thousandsSeparator,o=i.decimalFoldThreshold,l=i.yAxis,u=a.points[0].value,c=u===void 0?0:u,h=!((t=l==null?void 0:l.isInCandle())!==null&&t!==void 0)||t?n.price:n.excludePriceVolumeMax;return[{type:"line",attrs:{coordinates:[e[0],{x:r.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:nt(rt(c.toFixed(h),s),o),baseline:"bottom"}}]}};function Zn(i,t){if(i.length>1){var e=void 0;return i[0].x===i[1].x&&i[0].y!==i[1].y?i[0].y<i[1].y?e={x:i[0].x,y:t.height}:e={x:i[0].x,y:0}:i[0].x>i[1].x?e={x:0,y:Pe(i[0],i[1],{x:0,y:i[0].y})}:e={x:t.width,y:Pe(i[0],i[1],{x:t.width,y:i[0].y})},{coordinates:[i[0],e]}}return[]}var qn={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:Zn(t,e)}]}},Kn={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]}},Qn={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return t.length===2?t[0].x===t[1].x?[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Pe(t[0],t[1],{x:0,y:t[0].y})},{x:e.width,y:Pe(t[0],t[1],{x:e.width,y:t[0].y})}]}}]:[]}},Jn={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;if(t.length===2){var r={x:t[0].x,y:0};return t[0].y<t[1].y&&(r.y=e.height),[{type:"line",attrs:{coordinates:[t[0],r]}}]}return[]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].timestamp=r.timestamp,e[0].dataIndex=r.dataIndex)}},ta={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]},performEventPressedMove:function(i){var t=i.points,e=i.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(i){var t=i.currentStep,e=i.points,r=i.performPoint;t===2&&(e[0].timestamp=r.timestamp,e[0].dataIndex=r.dataIndex)}},ea={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(i){var t=i.coordinates,e=i.bounding;return[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]}},ra={name:"simpleAnnotation",totalStep:2,styles:{line:{style:H.Dashed}},createPointFigures:function(i){var t,e=i.overlay,r=i.coordinates,n;T(e.extendData)&&(kt(e.extendData)?n=e.extendData(e):n=(t=e.extendData)!==null&&t!==void 0?t:"");var a=r[0].x,s=r[0].y-6,o=s-50,l=o-5;return[{type:"line",attrs:{coordinates:[{x:a,y:s},{x:a,y:o}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:a,y:o},{x:a-4,y:l},{x:a+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:a,y:l,text:n??"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},ia={name:"simpleTag",totalStep:2,styles:{line:{style:H.Dashed}},createPointFigures:function(i){var t=i.bounding,e=i.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(i){var t,e,r=i.overlay,n=i.coordinates,a=i.bounding,s=i.yAxis,o=i.precision,l=(t=s==null?void 0:s.isFromZero())!==null&&t!==void 0?t:!1,u,c;l?(u="left",c=0):(u="right",c=a.width);var h;return T(r.extendData)&&(kt(r.extendData)?h=r.extendData(r):h=(e=r.extendData)!==null&&e!==void 0?e:""),!T(h)&&F(r.points[0].value)&&(h=K(r.points[0].value,o.price)),{type:"text",attrs:{x:c,y:n[0].y,text:h??"",align:u,baseline:"middle"}}}},Ur={},na=[On,Nn,Wn,zn,$n,Un,jn,qn,Kn,Qn,Jn,ta,ea,ra,ia];na.forEach(function(i){Ur[i.name]=Ki.extend(i)});function aa(i){var t;return(t=Ur[i])!==null&&t!==void 0?t:null}var oa=30,sa=100,Y={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},la=function(){function i(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return i.prototype._overrideInstance=function(t,e){var r=e.id,n=e.groupId,a=e.points,s=e.styles,o=e.lock,l=e.visible,u=e.zLevel,c=e.mode,h=e.modeSensitivity,f=e.extendData,d=e.onDrawStart,v=e.onDrawing,p=e.onDrawEnd,g=e.onClick,m=e.onDoubleClick,_=e.onRightClick,S=e.onPressedMoveStart,y=e.onPressedMoving,x=e.onPressedMoveEnd,w=e.onMouseEnter,b=e.onMouseLeave,E=e.onRemoved,C=e.onSelected,M=e.onDeselected,I=!1,P=!1;return O(r)&&t.setId(r),O(n)&&t.setGroupId(n),wt(a)&&t.setPoints(a)&&(I=!0),T(s)&&t.setStyles(s)&&(I=!0),Qt(o)&&t.setLock(o),Qt(l)&&t.setVisible(l)&&(I=!0),F(u)&&t.setZLevel(u)&&(I=!0,P=!0),T(c)&&t.setMode(c),F(h)&&t.setModeSensitivity(h),f!==void 0&&t.setExtendData(f)&&(I=!0),d!==void 0&&t.setOnDrawStartCallback(d),v!==void 0&&t.setOnDrawingCallback(v),p!==void 0&&t.setOnDrawEndCallback(p),g!==void 0&&t.setOnClickCallback(g),m!==void 0&&t.setOnDoubleClickCallback(m),_!==void 0&&t.setOnRightClickCallback(_),S!==void 0&&t.setOnPressedMoveStartCallback(S),y!==void 0&&t.setOnPressedMovingCallback(y),x!==void 0&&t.setOnPressedMoveEndCallback(x),w!==void 0&&t.setOnMouseEnterCallback(w),b!==void 0&&t.setOnMouseLeaveCallback(b),E!==void 0&&t.setOnRemovedCallback(E),C!==void 0&&t.setOnSelectedCallback(C),M!==void 0&&t.setOnDeselectedCallback(M),[I,P]},i.prototype.getInstanceById=function(t){var e,r;try{for(var n=Jt(this._instances),a=n.next();!a.done;a=n.next()){var s=a.value,o=s[1],l=o.find(function(u){return u.id===t});if(T(l))return l}}catch(u){e={error:u}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},i.prototype._sort=function(t){var e;O(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(r,n){return r.zLevel-n.zLevel}):this._instances.forEach(function(r){r.sort(function(n,a){return n.zLevel-a.zLevel})})},i.prototype.addInstances=function(t,e,r){var n=this,a=t.map(function(o){var l,u,c,h,f=(l=o.id)!==null&&l!==void 0?l:Wr(qi);if(n.getInstanceById(f)===null){var d=aa(o.name);if(d!==null){var v=new d;v.setPaneId(e);var p=(u=o.groupId)!==null&&u!==void 0?u:f;return o.id=f,o.groupId=p,n._overrideInstance(v,o),v.isDrawing()?n._progressInstanceInfo={paneId:e,instance:v,appointPaneFlag:r}:(n._instances.has(e)||n._instances.set(e,[]),(c=n._instances.get(e))===null||c===void 0||c.push(v)),v.isStart()&&((h=v.onDrawStart)===null||h===void 0||h.call(v,{overlay:v})),f}}return null});if(a.some(function(o){return o!==null})){this._sort();var s=this._chartStore.getChart();s.updatePane(1,e),s.updatePane(1,Y.X_AXIS)}return a},i.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},i.prototype.progressInstanceComplete=function(){var t;if(this._progressInstanceInfo!==null){var e=this._progressInstanceInfo,r=e.instance,n=e.paneId;r.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),(t=this._instances.get(n))===null||t===void 0||t.push(r),this._sort(n),this._progressInstanceInfo=null)}},i.prototype.updateProgressInstanceInfo=function(t,e){this._progressInstanceInfo!==null&&(Qt(e)&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},i.prototype.getInstances=function(t){var e;if(!O(t)){var r=[];return this._instances.forEach(function(n){r=r.concat(n)}),r}return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},i.prototype.override=function(t){var e=this,r=t.id,n=t.groupId,a=t.name,s=!1,o=!1,l=function(d){var v=e._overrideInstance(d,t);v[0]&&(s=!0),v[1]&&(o=!0)};if(O(r)){var u=this.getInstanceById(r);u!==null&&l(u)}else{var c=O(a),h=O(n);if(this._instances.forEach(function(d){d.forEach(function(v){(c&&v.name===a||h&&v.groupId===n||!c&&!h)&&l(v)})}),this._progressInstanceInfo!==null){var f=this._progressInstanceInfo.instance;(c&&f.name===a||h&&f.groupId===n||!c&&!h)&&l(f)}}o&&this._sort(),s&&this._chartStore.getChart().updatePane(1)},i.prototype.removeInstance=function(t){var e,r,n,a=function(p,g){if(O(p.id)){if(g.id!==p.id)return!1}else if(O(p.groupId)){if(g.groupId!==p.groupId)return!1}else if(O(p.name)&&g.name!==p.name)return!1;return!0},s=[],o=T(t);if(this._progressInstanceInfo!==null){var l=this._progressInstanceInfo.instance;(!o||o&&a(t,l))&&(s.push(this._progressInstanceInfo.paneId),(n=l.onRemoved)===null||n===void 0||n.call(l,{overlay:l}),this._progressInstanceInfo=null)}if(o){var u=new Map,c=function(p){var g=p[1],m=g.filter(function(_){var S;return a(t,_)?(s.includes(p[0])||s.push(p[0]),(S=_.onRemoved)===null||S===void 0||S.call(_,{overlay:_}),!1):!0});m.length>0&&u.set(p[0],m)};try{for(var h=Jt(this._instances),f=h.next();!f.done;f=h.next()){var d=f.value;c(d)}}catch(p){e={error:p}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}this._instances=u}else this._instances.forEach(function(p,g){s.push(g),p.forEach(function(m){var _;(_=m.onRemoved)===null||_===void 0||_.call(m,{overlay:m})})}),this._instances.clear();if(s.length>0){var v=this._chartStore.getChart();s.forEach(function(p){v.updatePane(1,p)}),v.updatePane(1,Y.X_AXIS)}},i.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},i.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},i.prototype.updatePointPosition=function(t,e){if(t>0){var r=this._chartStore.getDataList();this._instances.forEach(function(n){n.forEach(function(a){var s=a.points;s.forEach(function(o){if(!T(o.timestamp)&&T(o.dataIndex)){e===pt.Forward&&(o.dataIndex=o.dataIndex+t);var l=r[o.dataIndex];o.timestamp=l==null?void 0:l.timestamp}})})})}},i.prototype.setHoverInstanceInfo=function(t,e){var r,n,a=this._hoverInstanceInfo,s=a.instance,o=a.figureType,l=a.figureKey,u=a.figureIndex;if(((s==null?void 0:s.id)!==((r=t.instance)===null||r===void 0?void 0:r.id)||o!==t.figureType||u!==t.figureIndex)&&(this._hoverInstanceInfo=t,(s==null?void 0:s.id)!==((n=t.instance)===null||n===void 0?void 0:n.id))){var c=!1,h=!1;s!==null&&(h=!0,kt(s.onMouseLeave)&&(s.onMouseLeave(R({overlay:s,figureKey:l,figureIndex:u},e)),c=!0)),t.instance!==null&&(h=!0,kt(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),c=!0)),h&&this._sort(),c||this._chartStore.getChart().updatePane(1)}},i.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},i.prototype.setClickInstanceInfo=function(t,e){var r,n,a,s,o,l,u,c,h,f=this._clickInstanceInfo,d=f.paneId,v=f.instance,p=f.figureType,g=f.figureKey,m=f.figureIndex;if((n=(r=t.instance)===null||r===void 0?void 0:r.isDrawing())!==null&&n!==void 0&&n||(s=(a=t.instance)===null||a===void 0?void 0:a.onClick)===null||s===void 0||s.call(a,R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((v==null?void 0:v.id)!==((o=t.instance)===null||o===void 0?void 0:o.id)||p!==t.figureType||m!==t.figureIndex)&&(this._clickInstanceInfo=t,(v==null?void 0:v.id)!==((l=t.instance)===null||l===void 0?void 0:l.id))){(u=v==null?void 0:v.onDeselected)===null||u===void 0||u.call(v,R({overlay:v,figureKey:g,figureIndex:m},e)),(h=(c=t.instance)===null||c===void 0?void 0:c.onSelected)===null||h===void 0||h.call(c,R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var _=this._chartStore.getChart();_.updatePane(1,t.paneId),d!==t.paneId&&_.updatePane(1,d),_.updatePane(1,Y.X_AXIS)}},i.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},i.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},i.prototype.isDrawing=function(){var t,e;return this._progressInstanceInfo!==null&&((e=(t=this._progressInstanceInfo)===null||t===void 0?void 0:t.instance.isDrawing())!==null&&e!==void 0?e:!1)},i}(),ua=function(){function i(){this._actions=new Map}return i.prototype.execute=function(t,e){var r;(r=this._actions.get(t))===null||r===void 0||r.execute(e)},i.prototype.subscribe=function(t,e){var r;this._actions.has(t)||this._actions.set(t,new Ui),(r=this._actions.get(t))===null||r===void 0||r.subscribe(e)},i.prototype.unsubscribe=function(t,e){var r=this._actions.get(t);T(r)&&(r.unsubscribe(e),r.isEmpty()&&this._actions.delete(t))},i.prototype.has=function(t){var e=this._actions.get(t);return T(e)&&!e.isEmpty()},i}(),ca={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},ha={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},va={light:ca,dark:ha};function jr(i){var t;return(t=va[i])!==null&&t!==void 0?t:null}var da=function(){function i(t,e){this._styles=Xi(),this._customApi=Qi(),this._locale=Ji,this._precision={price:2,volume:0},this._thousandsSeparator=",",this._decimalFoldThreshold=3,this._dataList=[],this._loadMoreCallback=null,this._loadDataCallback=null,this._loading=!0,this._forwardMore=!0,this._backwardMore=!0,this._timeScaleStore=new on(this),this._indicatorStore=new Ln(this),this._overlayStore=new la(this),this._tooltipStore=new Vn(this),this._actionStore=new ua,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return i.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.realFrom,r=t.realTo,n=e;n<r;n++){var a=this._dataList[n],s=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:s,data:a})}},i.prototype.setOptions=function(t){var e,r,n,a;if(T(t)){var s=t.locale,o=t.timezone,l=t.styles,u=t.customApi,c=t.thousandsSeparator,h=t.decimalFoldThreshold;if(O(s)&&(this._locale=s),O(o)&&this._timeScaleStore.setTimezone(o),T(l)){var f=null;O(l)?f=jr(l):f=l,mt(this._styles,f),wt((r=(e=f==null?void 0:f.candle)===null||e===void 0?void 0:e.tooltip)===null||r===void 0?void 0:r.custom)&&(this._styles.candle.tooltip.custom=(a=(n=f==null?void 0:f.candle)===null||n===void 0?void 0:n.tooltip)===null||a===void 0?void 0:a.custom)}T(u)&&mt(this._customApi,u),O(c)&&(this._thousandsSeparator=c),F(h)&&h>0&&(this._decimalFoldThreshold=h)}return this},i.prototype.getStyles=function(){return this._styles},i.prototype.getLocale=function(){return this._locale},i.prototype.getCustomApi=function(){return this._customApi},i.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},i.prototype.getDecimalFoldThreshold=function(){return this._decimalFoldThreshold},i.prototype.getPrecision=function(){return this._precision},i.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.synchronizeSeriesPrecision(),this},i.prototype.getDataList=function(){return this._dataList},i.prototype.getVisibleFirstData=function(){var t,e=this._timeScaleStore.getVisibleRange().from;return(t=this._dataList[e])!==null&&t!==void 0?t:null},i.prototype.getVisibleDataList=function(){return this._visibleDataList},i.prototype.addData=function(t,e,r){return ne(this,void 0,void 0,function(){var n,a,s,o,l,u,c;return ae(this,function(h){switch(h.label){case 0:if(n=!1,a=!1,s=0,wt(t)){switch(s=t.length,e){case pt.Init:{this.clear(),this._dataList=t,this._forwardMore=r??!0,this._timeScaleStore.resetOffsetRightDistance(),a=!0;break}case pt.Backward:{this._dataList=this._dataList.concat(t),this._backwardMore=r??!1,a=s>0;break}case pt.Forward:this._dataList=t.concat(this._dataList),this._forwardMore=r??!1,a=s>0}this._loading=!1,n=!0}else o=this._dataList.length,l=t.timestamp,u=ot(this._dataList[o-1],"timestamp",0),l>u?(this._dataList.push(t),c=this._timeScaleStore.getLastBarRightSideDiffBarCount(),c<0&&this._timeScaleStore.setLastBarRightSideDiffBarCount(--c),s=1,n=!0,a=!0):l===u&&(this._dataList[o-1]=t,n=!0,a=!0);if(!n)return[3,5];h.label=1;case 1:return h.trys.push([1,4,,5]),this._overlayStore.updatePointPosition(s,e),a?(this._timeScaleStore.adjustVisibleRange(),this._tooltipStore.recalculateCrosshair(!0),[4,this._indicatorStore.calcInstance()]):[3,3];case 2:h.sent(),this._chart.adjustPaneViewport(!1,!0,!0,!0),h.label=3;case 3:return this._actionStore.execute(gt.OnDataReady),[3,5];case 4:return h.sent(),[3,5];case 5:return[2]}})})},i.prototype.setLoadMoreCallback=function(t){this._loadMoreCallback=t},i.prototype.executeLoadMoreCallback=function(t){this._forwardMore&&!this._loading&&T(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(t))},i.prototype.setLoadDataCallback=function(t){this._loadDataCallback=t},i.prototype.executeLoadDataCallback=function(t){var e=this;if(!this._loading&&T(this._loadDataCallback)&&(this._forwardMore&&t.type===pt.Forward||this._backwardMore&&t.type===pt.Backward)){var r=function(n,a){e.addData(n,t.type,a).then(function(){}).catch(function(){})};this._loading=!0,this._loadDataCallback(R(R({},t),{callback:r}))}},i.prototype.clear=function(){this._forwardMore=!0,this._backwardMore=!0,this._loading=!0,this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},i.prototype.getTimeScaleStore=function(){return this._timeScaleStore},i.prototype.getIndicatorStore=function(){return this._indicatorStore},i.prototype.getOverlayStore=function(){return this._overlayStore},i.prototype.getTooltipStore=function(){return this._tooltipStore},i.prototype.getActionStore=function(){return this._actionStore},i.prototype.getChart=function(){return this._chart},i}(),W={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},ge=7;function fa(){return ne(this,void 0,void 0,function(){return ae(this,function(i){switch(i.label){case 0:return[4,new Promise(function(t){var e=new ResizeObserver(function(r){t(r.every(function(n){return"devicePixelContentBoxSize"in n})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})];case 1:return[2,i.sent()]}})})}var mr=function(){function i(t,e){var r=this;this._supportedDevicePixelContentBox=!1,this._width=0,this._height=0,this._pixelWidth=0,this._pixelHeight=0,this._nextPixelWidth=0,this._nextPixelHeight=0,this._requestAnimationId=Oe,this._mediaQueryListener=function(){var n=Ht(r._element);r._nextPixelWidth=Math.round(r._element.clientWidth*n),r._nextPixelHeight=Math.round(r._element.clientHeight*n),r._resetPixelRatio()},this._listener=e,this._element=Ft("canvas",t),this._ctx=this._element.getContext("2d",{willReadFrequently:!0}),fa().then(function(n){r._supportedDevicePixelContentBox=n,n?(r._resizeObserver=new ResizeObserver(function(a){var s,o=a.find(function(u){return u.target===r._element}),l=(s=o==null?void 0:o.devicePixelContentBoxSize)===null||s===void 0?void 0:s[0];T(l)&&(r._nextPixelWidth=l.inlineSize,r._nextPixelHeight=l.blockSize,(r._pixelWidth!==r._nextPixelWidth||r._pixelHeight!==r._nextPixelHeight)&&r._resetPixelRatio())}),r._resizeObserver.observe(r._element,{box:"device-pixel-content-box"})):(r._mediaQueryList=window.matchMedia("(resolution: ".concat(Ht(r._element),"dppx)")),r._mediaQueryList.addListener(r._mediaQueryListener))}).catch(function(n){return!1})}return i.prototype._resetPixelRatio=function(){var t=this;this._executeListener(function(){var e=t._element.clientWidth,r=t._element.clientHeight,n=t._nextPixelWidth/e,a=t._nextPixelHeight/r;t._width=e,t._height=r,t._pixelWidth=t._nextPixelWidth,t._pixelHeight=t._nextPixelHeight,t._element.width=t._nextPixelWidth,t._element.height=t._nextPixelHeight,t._ctx.scale(n,a)})},i.prototype._executeListener=function(t){var e=this;this._requestAnimationId===Oe&&(this._requestAnimationId=Ie(function(){e._ctx.clearRect(0,0,e._width,e._height),t==null||t(),e._listener(),e._requestAnimationId=Oe}))},i.prototype.update=function(t,e){if(this._width!==t||this._height!==e){if(this._element.style.width="".concat(t,"px"),this._element.style.height="".concat(e,"px"),!this._supportedDevicePixelContentBox){var r=Ht(this._element);this._nextPixelWidth=Math.round(t*r),this._nextPixelHeight=Math.round(e*r),this._resetPixelRatio()}}else this._executeListener()},i.prototype.getElement=function(){return this._element},i.prototype.getContext=function(){return this._ctx},i.prototype.destroy=function(){T(this._resizeObserver)&&this._resizeObserver.unobserve(this._element),T(this._mediaQueryList)&&this._mediaQueryList.removeListener(this._mediaQueryListener)},i}();function Zr(i){var t={width:0,height:0,left:0,right:0,top:0,bottom:0};return T(i)&&mt(t,i),t}var qr=function(i){N(t,i);function t(e,r){var n=i.call(this)||this;return n._bounding=Zr(),n._pane=r,n._rootContainer=e,n._container=n.createContainer(),e.appendChild(n._container),n}return t.prototype.setBounding=function(e){return mt(this._bounding,e),this},t.prototype.getContainer=function(){return this._container},t.prototype.getBounding=function(){return this._bounding},t.prototype.getPane=function(){return this._pane},t.prototype.update=function(e){this.updateImp(this._container,this._bounding,e??3)},t.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},t}(Ke),Je=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;n._mainCanvas=new mr({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){n.updateMain(n._mainCanvas.getContext())}),n._overlayCanvas=new mr({position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"},function(){n.updateOverlay(n._overlayCanvas.getContext())});var a=n.getContainer();return a.appendChild(n._mainCanvas.getElement()),a.appendChild(n._overlayCanvas.getElement()),n}return t.prototype.createContainer=function(){return Ft("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},t.prototype.updateImp=function(e,r,n){var a=r.width,s=r.height,o=r.left;e.style.left="".concat(o,"px");var l=n,u=e.clientWidth,c=e.clientHeight;switch((a!==u||s!==c)&&(e.style.width="".concat(a,"px"),e.style.height="".concat(s,"px"),l=3),l){case 0:{this._mainCanvas.update(a,s);break}case 1:{this._overlayCanvas.update(a,s);break}case 3:case 4:{this._mainCanvas.update(a,s),this._overlayCanvas.update(a,s);break}}},t.prototype.destroy=function(){this._mainCanvas.destroy(),this._overlayCanvas.destroy()},t.prototype.getImage=function(e){var r=this.getBounding(),n=r.width,a=r.height,s=Ft("canvas",{width:"".concat(n,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),o=s.getContext("2d"),l=Ht(s);return s.width=n*l,s.height=a*l,o.scale(l,l),o.drawImage(this._mainCanvas.getElement(),0,0,n,a),e&&o.drawImage(this._overlayCanvas.getElement(),0,0,n,a),s},t}(qr);function ue(i){return i==="transparent"||i==="none"||/^[rR][gG][Bb][Aa]\(([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*0[\s]*\)$/.test(i)||/^[hH][Ss][Ll][Aa]\(([\s]*(3603[0-5][0-9]|[012]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*0[\s]*)\)$/.test(i)}function pa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var n=e[r],a=n.x,s=n.y,o=n.r,l=i.x-a,u=i.y-s;if(!(l*l+u*u>o*o))return!0}return!1}function ga(i,t,e){var r=[];r=r.concat(t);var n=e.style,a=n===void 0?X.Fill:n,s=e.color,o=s===void 0?"currentColor":s,l=e.borderSize,u=l===void 0?1:l,c=e.borderColor,h=c===void 0?"currentColor":c,f=e.borderStyle,d=f===void 0?H.Solid:f,v=e.borderDashedValue,p=v===void 0?[2,2]:v,g=(a===X.Fill||e.style===X.StrokeFill)&&(!O(o)||!ue(o));g&&(i.fillStyle=o,r.forEach(function(m){var _=m.x,S=m.y,y=m.r;i.beginPath(),i.arc(_,S,y,0,Math.PI*2),i.closePath(),i.fill()})),(a===X.Stroke||e.style===X.StrokeFill)&&u>0&&!ue(h)&&(i.strokeStyle=h,i.lineWidth=u,d===H.Dashed?i.setLineDash(p):i.setLineDash([]),r.forEach(function(m){var _=m.x,S=m.y,y=m.r;(!g||y>u)&&(i.beginPath(),i.arc(_,S,y,0,Math.PI*2),i.closePath(),i.stroke())}))}var ma={name:"circle",checkEventOn:pa,draw:function(i,t,e){ga(i,t,e)}};function _a(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){for(var n=!1,a=e[r].coordinates,s=0,o=a.length-1;s<a.length;o=s++)a[s].y>i.y!=a[o].y>i.y&&i.x<(a[o].x-a[s].x)*(i.y-a[s].y)/(a[o].y-a[s].y)+a[s].x&&(n=!n);if(n)return!0}return!1}function ya(i,t,e){var r=[];r=r.concat(t);var n=e.style,a=n===void 0?X.Fill:n,s=e.color,o=s===void 0?"currentColor":s,l=e.borderSize,u=l===void 0?1:l,c=e.borderColor,h=c===void 0?"currentColor":c,f=e.borderStyle,d=f===void 0?H.Solid:f,v=e.borderDashedValue,p=v===void 0?[2,2]:v;(a===X.Fill||e.style===X.StrokeFill)&&(!O(o)||!ue(o))&&(i.fillStyle=o,r.forEach(function(g){var m=g.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.fill()})),(a===X.Stroke||e.style===X.StrokeFill)&&u>0&&!ue(h)&&(i.strokeStyle=h,i.lineWidth=u,d===H.Dashed?i.setLineDash(p):i.setLineDash([]),r.forEach(function(g){var m=g.coordinates;i.beginPath(),i.moveTo(m[0].x,m[0].y);for(var _=1;_<m.length;_++)i.lineTo(m[_].x,m[_].y);i.closePath(),i.stroke()}))}var Sa={name:"polygon",checkEventOn:_a,draw:function(i,t,e){ya(i,t,e)}};function xa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var n=e[r],a=n.x,s=n.width;s<it*2&&(a-=it,s=it*2);var o=n.y,l=n.height;if(l<it*2&&(o-=it,l=it*2),i.x>=a&&i.x<=a+s&&i.y>=o&&i.y<=o+l)return!0}return!1}function Kr(i,t,e){var r,n=[];n=n.concat(t);var a=e.style,s=a===void 0?X.Fill:a,o=e.color,l=o===void 0?"transparent":o,u=e.borderSize,c=u===void 0?1:u,h=e.borderColor,f=h===void 0?"transparent":h,d=e.borderStyle,v=d===void 0?H.Solid:d,p=e.borderRadius,g=p===void 0?0:p,m=e.borderDashedValue,_=m===void 0?[2,2]:m,S=(r=i.roundRect)!==null&&r!==void 0?r:i.rect,y=(s===X.Fill||e.style===X.StrokeFill)&&(!O(l)||!ue(l));if(y&&(i.fillStyle=l,n.forEach(function(b){var E=b.x,C=b.y,M=b.width,I=b.height;i.beginPath(),S.call(i,E,C,M,I,g),i.closePath(),i.fill()})),(s===X.Stroke||e.style===X.StrokeFill)&&c>0&&!ue(f)){i.strokeStyle=f,i.fillStyle=f,i.lineWidth=c,v===H.Dashed?i.setLineDash(_):i.setLineDash([]);var x=c%2===1?.5:0,w=Math.round(x*2);n.forEach(function(b){var E=b.x,C=b.y,M=b.width,I=b.height;M>c*2&&I>c*2?(i.beginPath(),S.call(i,E+x,C+x,M-w,I-w,g),i.closePath(),i.stroke()):y||i.fillRect(E,C,M,I)})}}var ba={name:"rect",checkEventOn:xa,draw:function(i,t,e){Kr(i,t,e)}};function Qr(i,t){var e=t.size,r=e===void 0?12:e,n=t.paddingLeft,a=n===void 0?0:n,s=t.paddingTop,o=s===void 0?0:s,l=t.paddingRight,u=l===void 0?0:l,c=t.paddingBottom,h=c===void 0?0:c,f=t.weight,d=f===void 0?"normal":f,v=t.family,p=i.x,g=i.y,m=i.text,_=i.align,S=_===void 0?"left":_,y=i.baseline,x=y===void 0?"top":y,w=i.width,b=i.height,E=w??a+Ee(m,r,d,v)+u,C=b??o+r+h,M;switch(S){case"left":case"start":{M=p;break}case"right":case"end":{M=p-E;break}default:{M=p-E/2;break}}var I;switch(x){case"top":case"hanging":{I=g;break}case"bottom":case"ideographic":case"alphabetic":{I=g-C;break}default:{I=g-C/2;break}}return{x:M,y:I,width:E,height:C}}function wa(i,t,e){var r=[];r=r.concat(t);for(var n=0;n<r.length;n++){var a=Qr(r[n],e),s=a.x,o=a.y,l=a.width,u=a.height;if(i.x>=s&&i.x<=s+l&&i.y>=o&&i.y<=o+u)return!0}return!1}function Ca(i,t,e){var r=[];r=r.concat(t);var n=e.color,a=n===void 0?"currentColor":n,s=e.size,o=s===void 0?12:s,l=e.family,u=e.weight,c=e.paddingLeft,h=c===void 0?0:c,f=e.paddingTop,d=f===void 0?0:f,v=e.paddingRight,p=v===void 0?0:v,g=r.map(function(m){return Qr(m,e)});Kr(i,g,R(R({},e),{color:e.backgroundColor})),i.textAlign="left",i.textBaseline="top",i.font=te(o,u,l),i.fillStyle=a,r.forEach(function(m,_){var S=g[_];i.fillText(m.text,S.x+h,S.y+d,S.width-h-p)})}var Jr={name:"text",checkEventOn:wa,draw:function(i,t,e){Ca(i,t,e)}},Ea=Jr;function Ia(i,t){var e=i.x-t.x,r=i.y-t.y;return Math.sqrt(e*e+r*r)}function Pa(i,t){var e=[];e=e.concat(t);for(var r=0;r<e.length;r++){var n=e[r];if(Math.abs(Ia(i,n)-n.r)<it){var a=n.r,s=n.startAngle,o=n.endAngle,l=a*Math.cos(s)+n.x,u=a*Math.sin(s)+n.y,c=a*Math.cos(o)+n.x,h=a*Math.sin(o)+n.y;if(i.x<=Math.max(l,c)+it&&i.x>=Math.min(l,c)-it&&i.y<=Math.max(u,h)+it&&i.y>=Math.min(u,h)-it)return!0}}return!1}function Ma(i,t,e){var r=[];r=r.concat(t);var n=e.style,a=n===void 0?H.Solid:n,s=e.size,o=s===void 0?1:s,l=e.color,u=l===void 0?"currentColor":l,c=e.dashedValue,h=c===void 0?[2,2]:c;i.lineWidth=o,i.strokeStyle=u,a===H.Dashed?i.setLineDash(h):i.setLineDash([]),r.forEach(function(f){var d=f.x,v=f.y,p=f.r,g=f.startAngle,m=f.endAngle;i.beginPath(),i.arc(d,v,p,g,m),i.stroke(),i.closePath()})}var Ta={name:"arc",checkEventOn:Pa,draw:function(i,t,e){Ma(i,t,e)}},ti={},Da=[ma,Gn,Sa,ba,Jr,Ea,Ta];Da.forEach(function(i){ti[i.name]=Xn.extend(i)});function Aa(i){var t;return(t=ti[i])!==null&&t!==void 0?t:null}var Tt=function(i){N(t,i);function t(e){var r=i.call(this)||this;return r._widget=e,r}return t.prototype.getWidget=function(){return this._widget},t.prototype.createFigure=function(e,r){var n=Aa(e.name);if(n!==null){var a=new n(e);if(T(r)){for(var s in r)r.hasOwnProperty(s)&&a.registerEvent(s,r[s]);this.addChild(a)}return a}return null},t.prototype.draw=function(e){this.clear(),this.drawImp(e)},t}(Ke),ka=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,n,a=this.getWidget(),s=this.getWidget().getPane(),o=s.getChart(),l=a.getBounding(),u=o.getStyles().grid,c=u.show;if(c){e.save(),e.globalCompositeOperation="destination-over";var h=u.horizontal,f=h.show;if(f){var d=s.getAxisComponent(),v=d.getTicks().map(function(_){return{coordinates:[{x:0,y:_.coord},{x:l.width,y:_.coord}]}});(r=this.createFigure({name:"line",attrs:v,styles:h}))===null||r===void 0||r.draw(e)}var p=u.vertical,g=p.show;if(g){var m=o.getXAxisPane().getAxisComponent(),v=m.getTicks().map(function(S){return{coordinates:[{x:S.coord,y:0},{x:S.coord,y:l.height}]}});(n=this.createFigure({name:"line",attrs:v,styles:p}))===null||n===void 0||n.draw(e)}e.restore()}},t}(Tt),tr=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.eachChildren=function(e){var r=this.getWidget().getPane(),n=r.getChart().getChartStore(),a=n.getVisibleDataList(),s=n.getTimeScaleStore().getBarSpace();a.forEach(function(o,l){e(o,s,l)})},t}(Tt),ei=function(i){N(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._boundCandleBarClickEvent=function(r){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(gt.OnCandleBarClick,r),!1}},e}return t.prototype.drawImp=function(e){var r=this,n=this.getWidget().getPane(),a=n.getId()===Y.CANDLE,s=n.getChart().getChartStore(),o=this.getCandleBarOptions(s);if(o!==null){var l=0,u=0;if(o.type===ft.Ohlc){var c=s.getTimeScaleStore().getBarSpace().gapBar;l=Math.min(Math.max(Math.round(c*.2),1),8),l>2&&l%2===1&&l--,u=Math.floor(u/2)}var h=n.getAxisComponent();this.eachChildren(function(f,d){var v=f.data,p=f.x;if(T(v)){var g=v.open,m=v.high,_=v.low,S=v.close,y=o.type,x=o.styles,w=[];S>g?(w[0]=x.upColor,w[1]=x.upBorderColor,w[2]=x.upWickColor):S<g?(w[0]=x.downColor,w[1]=x.downBorderColor,w[2]=x.downWickColor):(w[0]=x.noChangeColor,w[1]=x.noChangeBorderColor,w[2]=x.noChangeWickColor);var b=h.convertToPixel(g),E=h.convertToPixel(S),C=[b,E,h.convertToPixel(m),h.convertToPixel(_)];C.sort(function(I,P){return I-P});var M=[];switch(y){case ft.CandleSolid:{M=r._createSolidBar(p,C,d,w);break}case ft.CandleStroke:{M=r._createStrokeBar(p,C,d,w);break}case ft.CandleUpStroke:{S>g?M=r._createStrokeBar(p,C,d,w):M=r._createSolidBar(p,C,d,w);break}case ft.CandleDownStroke:{g>S?M=r._createStrokeBar(p,C,d,w):M=r._createSolidBar(p,C,d,w);break}case ft.Ohlc:{M=[{name:"rect",attrs:[{x:p-u,y:C[0],width:l,height:C[3]-C[0]},{x:p-d.halfGapBar,y:b+l>C[3]?C[3]-l:b,width:d.halfGapBar,height:l},{x:p+u,y:E+l>C[3]?C[3]-l:E,width:d.halfGapBar-u,height:l}],styles:{color:w[0]}}];break}}M.forEach(function(I){var P,A;a&&(A={mouseClickEvent:r._boundCandleBarClickEvent(f)}),(P=r.createFigure(I,A))===null||P===void 0||P.draw(e)})}})}},t.prototype.getCandleBarOptions=function(e){var r=e.getStyles().candle;return{type:r.type,styles:r.bar}},t.prototype._createSolidBar=function(e,r,n,a){return[{name:"rect",attrs:{x:e,y:r[0],width:1,height:r[3]-r[0]},styles:{color:a[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:r[1],width:n.gapBar,height:Math.max(1,r[2]-r[1])},styles:{style:X.StrokeFill,color:a[0],borderColor:a[1]}}]},t.prototype._createStrokeBar=function(e,r,n,a){return[{name:"rect",attrs:[{x:e,y:r[0],width:1,height:r[1]-r[0]},{x:e,y:r[2],width:1,height:r[3]-r[2]}],styles:{color:a[2]}},{name:"rect",attrs:{x:e-n.halfGapBar,y:r[1],width:n.gapBar,height:Math.max(1,r[2]-r[1])},styles:{style:X.Stroke,borderColor:a[1]}}]},t}(tr),Fa=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getCandleBarOptions=function(e){var r,n,a=this.getWidget().getPane(),s=a.getAxisComponent();if(!s.isInCandle()){var o=e.getIndicatorStore().getInstances(a.getId());try{for(var l=Jt(o),u=l.next();!u.done;u=l.next()){var c=u.value;if(c.shouldOhlc&&c.visible){var h=c.styles,f=e.getStyles().indicator,d=ot(h,"ohlc.upColor",f.ohlc.upColor),v=ot(h,"ohlc.downColor",f.ohlc.downColor),p=ot(h,"ohlc.noChangeColor",f.ohlc.noChangeColor);return{type:ft.Ohlc,styles:{upColor:d,downColor:v,noChangeColor:p,upBorderColor:d,downBorderColor:v,noChangeBorderColor:p,upWickColor:d,downWickColor:v,noChangeWickColor:p}}}}}catch(g){r={error:g}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}return null},t.prototype.drawImp=function(e){var r=this;i.prototype.drawImp.call(this,e);var n=this.getWidget(),a=n.getPane(),s=a.getChart(),o=n.getBounding(),l=s.getXAxisPane().getAxisComponent(),u=a.getAxisComponent(),c=s.getChartStore(),h=c.getDataList(),f=c.getTimeScaleStore(),d=f.getVisibleRange(),v=c.getIndicatorStore().getInstances(a.getId()),p=c.getStyles().indicator;e.save(),v.forEach(function(g){var m;if(g.visible){g.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";var _=!1;if(g.draw!==null&&(e.save(),_=(m=g.draw({ctx:e,kLineDataList:h,indicator:g,visibleRange:d,bounding:o,barSpace:f.getBarSpace(),defaultStyles:p,xAxis:l,yAxis:u}))!==null&&m!==void 0?m:!1,e.restore()),!_){var S=g.result,y=[];r.eachChildren(function(x,w){var b,E,C,M=w.halfGapBar,I=x.dataIndex,P=x.x,A=l.convertToPixel(I-1),k=l.convertToPixel(I+1),B=(b=S[I-1])!==null&&b!==void 0?b:null,L=(E=S[I])!==null&&E!==void 0?E:null,G=(C=S[I+1])!==null&&C!==void 0?C:null,z={x:A},st={x:P},ut={x:k};g.figures.forEach(function($){var U=$.key,tt=B==null?void 0:B[U];F(tt)&&(z[U]=u.convertToPixel(tt));var Q=L==null?void 0:L[U];F(Q)&&(st[U]=u.convertToPixel(Q));var et=G==null?void 0:G[U];F(et)&&(ut[U]=u.convertToPixel(et))}),qe(h,g,I,p,function($,U,tt){var Q,et,q;if(T(L==null?void 0:L[$.key])){var Ct=st[$.key],_t=(Q=$.attrs)===null||Q===void 0?void 0:Q.call($,{data:{prev:B,current:L,next:G},coordinate:{prev:z,current:st,next:ut},bounding:o,barSpace:w,xAxis:l,yAxis:u});if(!T(_t))switch($.type){case"circle":{_t={x:P,y:Ct,r:Math.max(1,M)};break}case"rect":case"bar":{var Rt=(et=$.baseValue)!==null&&et!==void 0?et:u.getRange().from,Bt=u.convertToPixel(Rt),$t=Math.abs(Bt-Ct);Rt!==(L==null?void 0:L[$.key])&&($t=Math.max(1,$t));var Et=void 0;Ct>Bt?Et=Bt:Et=Ct,_t={x:P-M,y:Et,width:Math.max(1,M*2),height:$t};break}case"line":{T(y[tt])||(y[tt]=[]),F(st[$.key])&&F(ut[$.key])&&y[tt].push({coordinates:[{x:st.x,y:st[$.key]},{x:ut.x,y:ut[$.key]}],styles:U});break}}var re=$.type;T(_t)&&re!=="line"&&((q=r.createFigure({name:re==="bar"?"rect":re,attrs:_t,styles:U}))===null||q===void 0||q.draw(e))}})}),y.forEach(function(x){if(x.length>1){for(var w=[{coordinates:[x[0].coordinates[0],x[0].coordinates[1]],styles:x[0].styles}],b=1;b<x.length;b++){var E=w[w.length-1],C=x[b],M=E.coordinates[E.coordinates.length-1];M.x===C.coordinates[0].x&&M.y===C.coordinates[0].y&&E.styles.style===C.styles.style&&E.styles.color===C.styles.color&&E.styles.size===C.styles.size&&E.styles.smooth===C.styles.smooth&&E.styles.dashedValue[0]===C.styles.dashedValue[0]&&E.styles.dashedValue[1]===C.styles.dashedValue[1]?E.coordinates.push(C.coordinates[1]):w.push({coordinates:[C.coordinates[0],C.coordinates[1]],styles:C.styles})}w.forEach(function(I){var P,A=I.coordinates,k=I.styles;(P=r.createFigure({name:"line",attrs:{coordinates:A},styles:k}))===null||P===void 0||P.draw(e)})}})}}}),e.restore()},t}(ei),Ra=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),n=r.getPane(),a=r.getBounding(),s=r.getPane().getChart().getChartStore(),o=s.getTooltipStore().getCrosshair(),l=s.getStyles().crosshair;if(O(o.paneId)&&l.show){if(o.paneId===n.getId()){var u=o.y;this._drawLine(e,[{x:0,y:u},{x:a.width,y:u}],l.horizontal)}var c=o.realX;this._drawLine(e,[{x:c,y:0},{x:c,y:a.height}],l.vertical)}},t.prototype._drawLine=function(e,r,n){var a;if(n.show){var s=n.line;s.show&&((a=this.createFigure({name:"line",attrs:{coordinates:r},styles:s}))===null||a===void 0||a.draw(e))}},t}(Tt),ri=function(i){N(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._boundIconClickEvent=function(r){return function(){var n=e.getWidget().getPane();return n.getChart().getChartStore().getActionStore().execute(gt.OnTooltipIconClick,R({},r)),!0}},e._boundIconMouseMoveEvent=function(r){return function(){var n=e.getWidget().getPane(),a=n.getChart().getChartStore().getTooltipStore();return a.setActiveIcon(R({},r)),!0}},e}return t.prototype.drawImp=function(e){var r=this.getWidget(),n=r.getPane(),a=n.getChart().getChartStore(),s=a.getTooltipStore().getCrosshair();if(T(s.kLineData)){var o=r.getBounding(),l=a.getCustomApi(),u=a.getThousandsSeparator(),c=a.getDecimalFoldThreshold(),h=a.getIndicatorStore().getInstances(n.getId()),f=a.getTooltipStore().getActiveIcon(),d=a.getStyles().indicator,v=d.tooltip,p=v.offsetLeft,g=v.offsetTop,m=v.offsetRight;this.drawIndicatorTooltip(e,n.getId(),a.getDataList(),s,f,h,l,u,c,p,g,o.width-m,d)}},t.prototype.drawIndicatorTooltip=function(e,r,n,a,s,o,l,u,c,h,f,d,v){var p=this,g=v.tooltip;if(this.isDrawTooltip(a,g)){var m=g.text;o.forEach(function(_){var S=0,y={x:h,y:f},x=p.getIndicatorTooltipData(n,a,_,l,u,c,v),w=x.name,b=x.calcParamsText,E=x.values,C=x.icons,M=w.length>0,I=E.length>0;if(M||I){var P=ee(p.classifyTooltipIcons(C),3),A=P[0],k=P[1],B=P[2];if(S=p.drawStandardTooltipIcons(e,s,A,y,r,_.name,h,S,d),M){var L=w;b.length>0&&(L="".concat(L).concat(b)),S=p.drawStandardTooltipLegends(e,[{title:{text:"",color:m.color},value:{text:L,color:m.color}}],y,h,S,d,m)}S=p.drawStandardTooltipIcons(e,s,k,y,r,_.name,h,S,d),I&&(S=p.drawStandardTooltipLegends(e,E,y,h,S,d,g.text)),S=p.drawStandardTooltipIcons(e,s,B,y,r,_.name,h,S,d),f=y.y+S}})}return f},t.prototype.drawStandardTooltipIcons=function(e,r,n,a,s,o,l,u,c){var h=this;if(n.length>0){var f=0,d=0;n.forEach(function(v){var p=v.marginLeft,g=p===void 0?0:p,m=v.marginTop,_=m===void 0?0:m,S=v.marginRight,y=S===void 0?0:S,x=v.marginBottom,w=x===void 0?0:x,b=v.paddingLeft,E=b===void 0?0:b,C=v.paddingTop,M=C===void 0?0:C,I=v.paddingRight,P=I===void 0?0:I,A=v.paddingBottom,k=A===void 0?0:A,B=v.size,L=v.fontFamily,G=v.icon;e.font=te(B,"normal",L),f+=g+E+e.measureText(G).width+P+y,d=Math.max(d,_+M+B+k+w)}),a.x+f>c?(a.x=l,a.y+=u,u=d):u=Math.max(u,d),n.forEach(function(v){var p,g=v.marginLeft,m=g===void 0?0:g,_=v.marginTop,S=_===void 0?0:_,y=v.marginRight,x=y===void 0?0:y,w=v.paddingLeft,b=w===void 0?0:w,E=v.paddingTop,C=E===void 0?0:E,M=v.paddingRight,I=M===void 0?0:M,P=v.paddingBottom,A=P===void 0?0:P,k=v.color,B=v.activeColor,L=v.size,G=v.fontFamily,z=v.icon,st=v.backgroundColor,ut=v.activeBackgroundColor,$=(r==null?void 0:r.paneId)===s&&(r==null?void 0:r.indicatorName)===o&&(r==null?void 0:r.iconId)===v.id;(p=h.createFigure({name:"text",attrs:{text:z,x:a.x+m,y:a.y+S},styles:{paddingLeft:b,paddingTop:C,paddingRight:I,paddingBottom:A,color:$?B:k,size:L,family:G,backgroundColor:$?ut:st}},{mouseClickEvent:h._boundIconClickEvent({paneId:s,indicatorName:o,iconId:v.id}),mouseMoveEvent:h._boundIconMouseMoveEvent({paneId:s,indicatorName:o,iconId:v.id})}))===null||p===void 0||p.draw(e),a.x+=m+b+e.measureText(z).width+I+x})}return u},t.prototype.drawStandardTooltipLegends=function(e,r,n,a,s,o,l){var u=this;if(r.length>0){var c=l.marginLeft,h=l.marginTop,f=l.marginRight,d=l.marginBottom,v=l.size,p=l.family,g=l.weight;e.font=te(v,g,p),r.forEach(function(m){var _,S,y=m.title,x=m.value,w=e.measureText(y.text).width,b=e.measureText(x.text).width,E=w+b,C=h+v+d;n.x+c+E+f>o?(n.x=a,n.y+=s,s=C):s=Math.max(s,C),y.text.length>0&&((_=u.createFigure({name:"text",attrs:{x:n.x+c,y:n.y+h,text:y.text},styles:{color:y.color,size:v,family:p,weight:g}}))===null||_===void 0||_.draw(e)),(S=u.createFigure({name:"text",attrs:{x:n.x+c+w,y:n.y+h,text:x.text},styles:{color:x.color,size:v,family:p,weight:g}}))===null||S===void 0||S.draw(e),n.x+=c+E+f})}return s},t.prototype.isDrawTooltip=function(e,r){var n=r.showRule;return n===le.Always||n===le.FollowCross&&O(e.paneId)},t.prototype.getIndicatorTooltipData=function(e,r,n,a,s,o,l){var u,c,h=l.tooltip,f=h.showName?n.shortName:"",d="",v=n.calcParams;v.length>0&&h.showParams&&(d="(".concat(v.join(","),")"));var p={name:f,calcParamsText:d,values:[],icons:h.icons},g=r.dataIndex,m=(u=n.result)!==null&&u!==void 0?u:[],_=[];if(n.visible){var S=(c=m[g])!==null&&c!==void 0?c:{};qe(e,n,g,l,function(k,B){var L;if(O(k.title)){var G=B.color,z=(L=S[k.key])!==null&&L!==void 0?L:h.defaultValue;F(z)&&(z=K(z,n.precision),n.shouldFormatBigNumber&&(z=a.formatBigNumber(z)),z=nt(rt(z,s),o)),_.push({title:{text:k.title,color:G},value:{text:z,color:G}})}}),p.values=_}if(n.createTooltipDataSource!==null){var y=this.getWidget(),x=y.getPane(),w=x.getChart().getChartStore(),b=n.createTooltipDataSource({kLineDataList:e,indicator:n,visibleRange:w.getTimeScaleStore().getVisibleRange(),bounding:y.getBounding(),crosshair:r,defaultStyles:l,xAxis:x.getChart().getXAxisPane().getAxisComponent(),yAxis:x.getAxisComponent()}),E=b.name,C=b.calcParamsText,M=b.values,I=b.icons;if(O(E)&&h.showName&&(p.name=E),O(C)&&h.showParams&&(p.calcParamsText=C),T(I)&&(p.icons=I),T(M)&&n.visible){var P=[],A=l.tooltip.text.color;M.forEach(function(k){var B,L={text:"",color:A};Mt(k.title)?L=k.title:L.text=k.title;var G={text:"",color:A};if(Mt(k.value)?G=k.value:G.text=(B=k.value)!==null&&B!==void 0?B:h.defaultValue,F(G.text)){var z=K(G.text,n.precision);n.shouldFormatBigNumber&&(z=a.formatBigNumber(z)),z=nt(rt(z,s),o),G.text=z}P.push({title:L,value:G})}),p.values=P}}return p},t.prototype.classifyTooltipIcons=function(e){var r=[],n=[],a=[];return e.forEach(function(s){switch(s.position){case pe.Left:{r.push(s);break}case pe.Middle:{n.push(s);break}case pe.Right:{a.push(s);break}}}),[r,n,a]},t}(Tt),ii=function(i){N(t,i);function t(e){var r=i.call(this,e)||this;return r._initEvent(),r}return t.prototype._initEvent=function(){var e=this,r=this.getWidget().getPane(),n=r.getId(),a=r.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(s){var o,l=a.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;u.isStart()&&(a.updateProgressInstanceInfo(n),c=n);var h=u.points.length-1,f="".concat(ie,"point_").concat(h);return u.isDrawing()&&c===n&&(u.eventMoveForDrawing(e._coordinateToPoint(l.instance,s)),(o=u.onDrawing)===null||o===void 0||o.call(u,R({overlay:u,figureKey:f,figureIndex:h},s))),e._figureMouseMoveEvent(u,1,f,h,0)(s)}return a.setHoverInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},s),!1}).registerEvent("mouseClickEvent",function(s){var o,l,u=a.getProgressInstanceInfo();if(u!==null){var c=u.instance,h=u.paneId;c.isStart()&&(a.updateProgressInstanceInfo(n,!0),h=n);var f=c.points.length-1,d="".concat(ie,"point_").concat(f);return c.isDrawing()&&h===n&&(c.eventMoveForDrawing(e._coordinateToPoint(c,s)),(o=c.onDrawing)===null||o===void 0||o.call(c,R({overlay:c,figureKey:d,figureIndex:f},s)),c.nextStep(),c.isDrawing()||(a.progressInstanceComplete(),(l=c.onDrawEnd)===null||l===void 0||l.call(c,R({overlay:c,figureKey:d,figureIndex:f},s)))),e._figureMouseClickEvent(c,1,d,f,0)(s)}return a.setClickInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},s),!1}).registerEvent("mouseDoubleClickEvent",function(s){var o,l=a.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;if(u.isDrawing()&&c===n&&(u.forceComplete(),!u.isDrawing())){a.progressInstanceComplete();var h=u.points.length-1,f="".concat(ie,"point_").concat(h);(o=u.onDrawEnd)===null||o===void 0||o.call(u,R({overlay:u,figureKey:f,figureIndex:h},s))}var d=u.points.length-1;return e._figureMouseClickEvent(u,1,"".concat(ie,"point_").concat(d),d,0)(s)}return!1}).registerEvent("mouseRightClickEvent",function(s){var o=a.getProgressInstanceInfo();if(o!==null){var l=o.instance;if(l.isDrawing()){var u=l.points.length-1;return e._figureMouseRightClickEvent(l,1,"".concat(ie,"point_").concat(u),u,0)(s)}}return!1}).registerEvent("mouseUpEvent",function(s){var o,l=a.getPressedInstanceInfo(),u=l.instance,c=l.figureIndex,h=l.figureKey;return u!==null&&((o=u.onPressedMoveEnd)===null||o===void 0||o.call(u,R({overlay:u,figureKey:h,figureIndex:c},s))),a.setPressedInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(s){var o,l,u=a.getPressedInstanceInfo(),c=u.instance,h=u.figureType,f=u.figureIndex,d=u.figureKey;if(c!==null){if(!c.lock&&!((l=(o=c.onPressedMoving)===null||o===void 0?void 0:o.call(c,R({overlay:c,figureIndex:f,figureKey:d},s)))!==null&&l!==void 0&&l)){var v=e._coordinateToPoint(c,s);h===1?c.eventPressedPointMove(v,f):c.eventPressedOtherMove(v,e.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},t.prototype._createFigureEvents=function(e,r,n,a,s,o){var l;if(!e.isDrawing()){var u=[];if(T(o)&&(Qt(o)?o&&(u=Zi()):u=o),u.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(e,r,n,a,s),mouseDownEvent:this._figureMouseDownEvent(e,r,n,a,s),mouseClickEvent:this._figureMouseClickEvent(e,r,n,a,s),mouseRightClickEvent:this._figureMouseRightClickEvent(e,r,n,a,s),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,r,n,a,s)};l={},!u.includes("mouseMoveEvent")&&!u.includes("touchMoveEvent")&&(l.mouseMoveEvent=this._figureMouseMoveEvent(e,r,n,a,s)),!u.includes("mouseDownEvent")&&!u.includes("touchStartEvent")&&(l.mouseDownEvent=this._figureMouseDownEvent(e,r,n,a,s)),!u.includes("mouseClickEvent")&&!u.includes("tapEvent")&&(l.mouseClickEvent=this._figureMouseClickEvent(e,r,n,a,s)),!u.includes("mouseDoubleClickEvent")&&!u.includes("doubleTapEvent")&&(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(e,r,n,a,s)),u.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(e,r,n,a,s))}return l},t.prototype._figureMouseMoveEvent=function(e,r,n,a,s){var o=this;return function(l){var u=o.getWidget().getPane(),c=u.getChart().getChartStore().getOverlayStore();return c.setHoverInstanceInfo({paneId:u.getId(),instance:e,figureType:r,figureKey:n,figureIndex:a,attrsIndex:s},l),!0}},t.prototype._figureMouseDownEvent=function(e,r,n,a,s){var o=this;return function(l){var u,c=o.getWidget().getPane(),h=c.getId(),f=c.getChart().getChartStore().getOverlayStore();return e.startPressedMove(o._coordinateToPoint(e,l)),(u=e.onPressedMoveStart)===null||u===void 0||u.call(e,R({overlay:e,figureIndex:a,figureKey:n},l)),f.setPressedInstanceInfo({paneId:h,instance:e,figureType:r,figureKey:n,figureIndex:a,attrsIndex:s}),!0}},t.prototype._figureMouseClickEvent=function(e,r,n,a,s){var o=this;return function(l){var u=o.getWidget().getPane(),c=u.getId(),h=u.getChart().getChartStore().getOverlayStore();return h.setClickInstanceInfo({paneId:c,instance:e,figureType:r,figureKey:n,figureIndex:a,attrsIndex:s},l),!0}},t.prototype._figureMouseDoubleClickEvent=function(e,r,n,a,s){return function(o){var l;return(l=e.onDoubleClick)===null||l===void 0||l.call(e,R(R({},o),{figureIndex:a,figureKey:n,overlay:e})),!0}},t.prototype._figureMouseRightClickEvent=function(e,r,n,a,s){var o=this;return function(l){var u,c;if(!((c=(u=e.onRightClick)===null||u===void 0?void 0:u.call(e,R({overlay:e,figureIndex:a,figureKey:n},l)))!==null&&c!==void 0&&c)){var h=o.getWidget().getPane(),f=h.getChart().getChartStore().getOverlayStore();f.removeInstance(e)}return!0}},t.prototype._coordinateToPoint=function(e,r){var n,a={},s=this.getWidget().getPane(),o=s.getChart(),l=s.getId(),u=o.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var c=o.getXAxisPane().getAxisComponent(),h=c.convertFromPixel(r.x),f=(n=u.dataIndexToTimestamp(h))!==null&&n!==void 0?n:void 0;a.dataIndex=h,a.timestamp=f}if(this.coordinateToPointValueFlag()){var d=s.getAxisComponent(),v=d.convertFromPixel(r.y);if(e.mode!==se.Normal&&l===Y.CANDLE&&F(a.dataIndex)){var p=u.getDataByDataIndex(a.dataIndex);if(p!==null){var g=e.modeSensitivity;if(v>p.high)if(e.mode===se.WeakMagnet){var m=d.convertToPixel(p.high),_=d.convertFromPixel(m-g);v<_&&(v=p.high)}else v=p.high;else if(v<p.low)if(e.mode===se.WeakMagnet){var S=d.convertToPixel(p.low),_=d.convertFromPixel(S-g);v>_&&(v=p.low)}else v=p.low;else{var y=Math.max(p.open,p.close),x=Math.min(p.open,p.close);v>y?v-y<p.high-v?v=y:v=p.high:v<x?v-p.low<x-v?v=p.low:v=x:y-v<v-x?v=y:v=x}}}a.value=v}return a},t.prototype.coordinateToPointValueFlag=function(){return!0},t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.dispatchEvent=function(e,r,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,r,n):i.prototype.dispatchEvent.call(this,e,r,n)},t.prototype.checkEventOn=function(){return!0},t.prototype.drawImp=function(e){var r=this,n=this.getWidget(),a=n.getPane(),s=a.getId(),o=a.getChart(),l=a.getAxisComponent(),u=o.getXAxisPane().getAxisComponent(),c=n.getBounding(),h=o.getChartStore(),f=h.getCustomApi(),d=h.getThousandsSeparator(),v=h.getDecimalFoldThreshold(),p=h.getTimeScaleStore(),g=p.getDateTimeFormat(),m=p.getBarSpace(),_=h.getPrecision(),S=h.getStyles().overlay,y=h.getOverlayStore(),x=y.getHoverInstanceInfo(),w=y.getClickInstanceInfo(),b=this.getCompleteOverlays(y,s),E=h.getIndicatorStore().getInstances(s),C=E.reduce(function(P,A){var k=A.precision;return P[A.name]=k,P.max=Math.max(P.max,k),P.min=Math.min(P.min,k),P.excludePriceVolumeMax=Math.max(P.excludePriceVolumeMax,k),P.excludePriceVolumeMin=Math.min(P.excludePriceVolumeMin,k),P},R(R({},_),{max:Math.max(_.price,_.volume),min:Math.min(_.price,_.volume),excludePriceVolumeMax:Number.MIN_SAFE_INTEGER,excludePriceVolumeMin:Number.MAX_SAFE_INTEGER}));b.forEach(function(P){P.visible&&r._drawOverlay(e,P,c,m,C,g,f,d,v,S,u,l,x,w,p)});var M=y.getProgressInstanceInfo();if(M!==null){var I=this.getProgressOverlay(M,s);I!==null&&I.visible&&this._drawOverlay(e,I,c,m,C,g,f,d,v,S,u,l,x,w,p)}},t.prototype._drawOverlay=function(e,r,n,a,s,o,l,u,c,h,f,d,v,p,g){var m=r.points,_=m.map(function(y){var x,w,b=y.dataIndex;F(y.timestamp)&&(b=g.timestampToDataIndex(y.timestamp));var E={x:0,y:0};return F(b)&&(E.x=(x=f==null?void 0:f.convertToPixel(b))!==null&&x!==void 0?x:0),F(y.value)&&(E.y=(w=d==null?void 0:d.convertToPixel(y.value))!==null&&w!==void 0?w:0),E});if(_.length>0){var S=new Array().concat(this.getFigures(r,_,n,a,s,u,c,o,h,f,d));this.drawFigures(e,r,S,h)}this.drawDefaultFigures(e,r,_,n,s,o,l,u,c,h,f,d,v,p)},t.prototype.drawFigures=function(e,r,n,a){var s=this;n.forEach(function(o,l){var u=o.type,c=o.styles,h=o.attrs,f=o.ignoreEvent,d=[].concat(h);d.forEach(function(v,p){var g,m,_,S=s._createFigureEvents(r,2,(g=o.key)!==null&&g!==void 0?g:"",l,p,f),y=R(R(R({},a[u]),(m=r.styles)===null||m===void 0?void 0:m[u]),c);(_=s.createFigure({name:u,attrs:v,styles:y},S))===null||_===void 0||_.draw(e)})})},t.prototype.getCompleteOverlays=function(e,r){return e.getInstances(r)},t.prototype.getProgressOverlay=function(e,r){return e.paneId===r?e.instance:null},t.prototype.getFigures=function(e,r,n,a,s,o,l,u,c,h,f){var d,v;return(v=(d=e.createPointFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:r,bounding:n,barSpace:a,precision:s,thousandsSeparator:o,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:f}))!==null&&v!==void 0?v:[]},t.prototype.drawDefaultFigures=function(e,r,n,a,s,o,l,u,c,h,f,d,v,p){var g=this,m,_;if(r.needDefaultPointFigure&&(((m=v.instance)===null||m===void 0?void 0:m.id)===r.id&&v.figureType!==0||((_=p.instance)===null||_===void 0?void 0:_.id)===r.id&&p.figureType!==0)){var S=r.styles,y=R(R({},h.point),S==null?void 0:S.point);n.forEach(function(x,w){var b,E,C,M=x.x,I=x.y,P=y.radius,A=y.color,k=y.borderColor,B=y.borderSize;((b=v.instance)===null||b===void 0?void 0:b.id)===r.id&&v.figureType===1&&v.figureIndex===w&&(P=y.activeRadius,A=y.activeColor,k=y.activeBorderColor,B=y.activeBorderSize),(E=g.createFigure({name:"circle",attrs:{x:M,y:I,r:P+B},styles:{color:k}},g._createFigureEvents(r,1,"".concat(ie,"point_").concat(w),w,0)))===null||E===void 0||E.draw(e),(C=g.createFigure({name:"circle",attrs:{x:M,y:I,r:P},styles:{color:A}}))===null||C===void 0||C.draw(e)})}},t}(Tt),ni=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n._gridView=new ka(n),n._indicatorView=new Fa(n),n._crosshairLineView=new Ra(n),n._tooltipView=n.createTooltipView(),n._overlayView=new ii(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",function(){return r.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),n}return t.prototype.getName=function(){return W.MAIN},t.prototype.updateMain=function(e){this.updateMainContent(e),this._indicatorView.draw(e),this._gridView.draw(e)},t.prototype.createTooltipView=function(){return new ri(this)},t.prototype.updateMainContent=function(e){},t.prototype.updateOverlay=function(e){this._overlayView.draw(e),this._crosshairLineView.draw(e),this._tooltipView.draw(e)},t}(Je),Ba=function(i){N(t,i);function t(){var e=i!==null&&i.apply(this,arguments)||this;return e._ripplePoint=e.createFigure({name:"circle",attrs:{x:0,y:0,r:0},styles:{style:"fill"}}),e._animationFrameTime=0,e._animation=new He({iterationCount:1/0}).doFrame(function(r){e._animationFrameTime=r;var n=e.getWidget().getPane();n.getChart().updatePane(0,n.getId())}),e}return t.prototype.drawImp=function(e){var r,n,a,s=this.getWidget(),o=s.getPane(),l=o.getChart(),u=l.getDataList(),c=u.length-1,h=s.getBounding(),f=o.getAxisComponent(),d=l.getStyles().candle.area,v=[],p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,m=null;if(this.eachChildren(function(b){var E=b.data,C=b.x,M=E==null?void 0:E[d.value];if(F(M)){var I=f.convertToPixel(M);g===Number.MIN_SAFE_INTEGER&&(g=C),v.push({x:C,y:I}),p=Math.min(p,I),b.dataIndex===c&&(m={x:C,y:I})}}),v.length>0){(r=this.createFigure({name:"line",attrs:{coordinates:v},styles:{color:d.lineColor,size:d.lineSize,smooth:d.smooth}}))===null||r===void 0||r.draw(e);var _=d.backgroundColor,S=void 0;if(wt(_)){var y=e.createLinearGradient(0,h.height,0,p);try{_.forEach(function(b){var E=b.offset,C=b.color;y.addColorStop(E,C)})}catch{}S=y}else S=_;e.fillStyle=S,e.beginPath(),e.moveTo(g,h.height),e.lineTo(v[0].x,v[0].y),Gr(e,v,d.smooth),e.lineTo(v[v.length-1].x,h.height),e.closePath(),e.fill()}var x=d.point;if(x.show&&T(m)){(n=this.createFigure({name:"circle",attrs:{x:m.x,y:m.y,r:x.radius},styles:{style:"fill",color:x.color}}))===null||n===void 0||n.draw(e);var w=x.rippleRadius;x.animation&&(w=x.radius+this._animationFrameTime/x.animationDuration*(x.rippleRadius-x.radius),this._animation.setDuration(x.animationDuration).start()),(a=this._ripplePoint)===null||a===void 0||a.setAttrs({x:m.x,y:m.y,r:w}).setStyles({style:"fill",color:x.rippleColor}).draw(e)}else this.stopAnimation()},t.prototype.stopAnimation=function(){this._animation.stop()},t}(tr),La=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),n=r.getPane(),a=n.getChart().getChartStore(),s=a.getStyles().candle.priceMark,o=s.high,l=s.low;if(s.show&&(o.show||l.show)){var u=a.getThousandsSeparator(),c=a.getDecimalFoldThreshold(),h=a.getPrecision(),f=n.getAxisComponent(),d=Number.MIN_SAFE_INTEGER,v=0,p=Number.MAX_SAFE_INTEGER,g=0;this.eachChildren(function(S){var y=S.data,x=S.x;T(y)&&(d<y.high&&(d=y.high,v=x),p>y.low&&(p=y.low,g=x))});var m=f.convertToPixel(d),_=f.convertToPixel(p);o.show&&d!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,nt(rt(K(d,h.price),u),c),{x:v,y:m},m<_?[-2,-5]:[2,5],o),l.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,nt(rt(K(p,h.price),u),c),{x:g,y:_},m<_?[2,5]:[-2,-5],l)}},t.prototype._drawMark=function(e,r,n,a,s){var o,l,u,c=n.x,h=n.y+a[0];(o=this.createFigure({name:"line",attrs:{coordinates:[{x:c-2,y:h+a[0]},{x:c,y:h},{x:c+2,y:h+a[0]}]},styles:{color:s.color}}))===null||o===void 0||o.draw(e);var f,d,v,p=this.getWidget().getBounding().width;c>p/2?(f=c-5,d=f-s.textOffset,v="right"):(f=c+5,v="left",d=f+s.textOffset);var g=h+a[1];(l=this.createFigure({name:"line",attrs:{coordinates:[{x:c,y:h},{x:c,y:g},{x:f,y:g}]},styles:{color:s.color}}))===null||l===void 0||l.draw(e),(u=this.createFigure({name:"text",attrs:{x:d,y:g,text:r,align:v,baseline:"middle"},styles:{color:s.color,size:s.textSize,family:s.textFamily,weight:s.textWeight}}))===null||u===void 0||u.draw(e)},t}(tr),Va=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,n=this.getWidget(),a=n.getPane(),s=n.getBounding(),o=a.getChart().getChartStore(),l=o.getStyles().candle.priceMark,u=l.last,c=u.line;if(l.show&&u.show&&c.show){var h=a.getAxisComponent(),f=o.getDataList(),d=f[f.length-1];if(d!=null){var v=d.close,p=d.open,g=h.convertToNicePixel(v),m=void 0;v>p?m=u.upColor:v<p?m=u.downColor:m=u.noChangeColor,(r=this.createFigure({name:"line",attrs:{coordinates:[{x:0,y:g},{x:s.width,y:g}]},styles:{style:c.style,color:m,size:c.size,dashedValue:c.dashedValue}}))===null||r===void 0||r.draw(e)}}},t}(Tt),Oa={time:"",open:"",high:"",low:"",close:"",volume:"",turnover:"",change:""},Na={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "},Wa={"zh-CN":Oa,"en-US":Na};function za(i,t){var e,r;return(r=(e=Wa[t])===null||e===void 0?void 0:e[i])!==null&&r!==void 0?r:i}var Xa=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this.getWidget(),n=r.getPane(),a=n.getId(),s=n.getChart().getChartStore(),o=s.getTooltipStore().getCrosshair();if(T(o.kLineData)){var l=r.getBounding(),u=n.getYAxisWidget().getBounding(),c=s.getDataList(),h=s.getPrecision(),f=s.getLocale(),d=s.getCustomApi(),v=s.getThousandsSeparator(),p=s.getDecimalFoldThreshold(),g=s.getTooltipStore().getActiveIcon(),m=s.getIndicatorStore().getInstances(n.getId()),_=s.getTimeScaleStore().getDateTimeFormat(),S=s.getStyles(),y=S.candle,x=S.indicator;if(y.tooltip.showType===Pt.Rect&&x.tooltip.showType===Pt.Rect){var w=this.isDrawTooltip(o,y.tooltip),b=this.isDrawTooltip(o,x.tooltip);this._drawRectTooltip(e,c,m,l,u,o,h,_,f,d,v,p,w,b,y.tooltip.offsetTop,S)}else if(y.tooltip.showType===Pt.Standard&&x.tooltip.showType===Pt.Standard){var E=y.tooltip,C=E.offsetLeft,M=E.offsetTop,I=E.offsetRight,P=l.width-I,A=this._drawCandleStandardTooltip(e,c,a,o,g,h,_,f,d,v,p,C,M,P,y);this.drawIndicatorTooltip(e,a,c,o,g,m,d,v,p,C,A,P,x)}else if(y.tooltip.showType===Pt.Rect&&x.tooltip.showType===Pt.Standard){var k=y.tooltip,C=k.offsetLeft,M=k.offsetTop,I=k.offsetRight,P=l.width-I,B=this.drawIndicatorTooltip(e,a,c,o,g,m,d,v,p,C,M,P,x),w=this.isDrawTooltip(o,y.tooltip);this._drawRectTooltip(e,c,m,l,u,o,h,_,f,d,v,p,w,!1,B,S)}else{var L=y.tooltip,C=L.offsetLeft,M=L.offsetTop,I=L.offsetRight,P=l.width-I,G=this._drawCandleStandardTooltip(e,c,a,o,g,h,_,f,d,v,p,C,M,P,y),b=this.isDrawTooltip(o,x.tooltip);this._drawRectTooltip(e,c,m,l,u,o,h,_,f,d,v,p,!1,b,G,S)}}},t.prototype._drawCandleStandardTooltip=function(e,r,n,a,s,o,l,u,c,h,f,d,v,p,g){var m,_,S,y=g.tooltip,x=y.text,w=0,b={x:d,y:v};if(this.isDrawTooltip(a,y)){var E=(m=a.dataIndex)!==null&&m!==void 0?m:0,C=this._getCandleTooltipLegends({prev:(_=r[E-1])!==null&&_!==void 0?_:null,current:a.kLineData,next:(S=r[E+1])!==null&&S!==void 0?S:null},o,l,u,c,h,f,g),M=ee(this.classifyTooltipIcons(y.icons),3),I=M[0],P=M[1],A=M[2];w=this.drawStandardTooltipIcons(e,s,I,b,n,"",d,w,p),w=this.drawStandardTooltipIcons(e,s,P,b,n,"",d,w,p),C.length>0&&(w=this.drawStandardTooltipLegends(e,C,b,d,w,p,x)),w=this.drawStandardTooltipIcons(e,s,A,b,n,"",d,w,p)}return b.y+w},t.prototype._drawRectTooltip=function(e,r,n,a,s,o,l,u,c,h,f,d,v,p,g,m){var _=this,S,y,x,w,b,E=m.candle,C=m.indicator,M=E.tooltip,I=C.tooltip;if(v||p){var P=(S=o.dataIndex)!==null&&S!==void 0?S:0,A=this._getCandleTooltipLegends({prev:(y=r[P-1])!==null&&y!==void 0?y:null,current:o.kLineData,next:(x=r[P+1])!==null&&x!==void 0?x:null},l,u,c,h,f,d,E),k=M.offsetLeft,B=M.offsetTop,L=M.offsetRight,G=M.offsetBottom,z=M.text,st=z.marginLeft,ut=z.marginRight,$=z.marginTop,U=z.marginBottom,tt=z.size,Q=z.weight,et=z.family,q=M.rect,Ct=q.position,_t=q.paddingLeft,Rt=q.paddingRight,Bt=q.paddingTop,$t=q.paddingBottom,Et=q.offsetLeft,re=q.offsetRight,ke=q.offsetTop,er=q.offsetBottom,Lt=q.borderSize,fi=q.borderRadius,pi=q.borderColor,gi=q.color,ce=0,Vt=0,Ot=0;v&&(e.font=te(tt,Q,et),A.forEach(function(Dt){var vt=Dt.title,dt=Dt.value,St="".concat(vt.text).concat(dt.text),At=e.measureText(St).width+st+ut;ce=Math.max(ce,At)}),Ot+=(U+$+tt)*A.length);var Ut=I.text,rr=Ut.marginLeft,ir=Ut.marginRight,nr=Ut.marginTop,ar=Ut.marginBottom,he=Ut.size,Fe=Ut.weight,Re=Ut.family,or=[];if(p&&(e.font=te(he,Fe,Re),n.forEach(function(Dt){var vt,dt=(vt=_.getIndicatorTooltipData(r,o,Dt,h,f,d,C).values)!==null&&vt!==void 0?vt:[];or.push(dt),dt.forEach(function(St){var At=St.title,ye=St.value,xi="".concat(At.text).concat(ye.text),bi=e.measureText(xi).width+rr+ir;ce=Math.max(ce,bi),Ot+=nr+ar+he})})),Vt+=ce,Vt!==0&&Ot!==0){Vt+=Lt*2+_t+Rt,Ot+=Lt*2+Bt+$t;var mi=a.width/2,sr=Ct===Ce.Pointer&&o.paneId===Y.CANDLE,lr=((w=o.realX)!==null&&w!==void 0?w:0)>mi,yt=0;if(sr){var ur=o.realX;lr?yt=ur-re-Vt:yt=ur+Et}else lr?(yt=Et+k,m.yAxis.inside&&m.yAxis.position===Gt.Left&&(yt+=s.width)):(yt=a.width-re-Vt-L,m.yAxis.inside&&m.yAxis.position===Gt.Right&&(yt-=s.width));var jt=g+ke;if(sr){var _i=o.y;jt=_i-Ot/2,jt+Ot>a.height-er-G&&(jt=a.height-er-Ot-G),jt<g+ke&&(jt=g+ke+B)}(b=this.createFigure({name:"rect",attrs:{x:yt,y:jt,width:Vt,height:Ot},styles:{style:X.StrokeFill,color:gi,borderColor:pi,borderSize:Lt,borderRadius:fi}}))===null||b===void 0||b.draw(e);var yi=yt+Lt+_t+st,Nt=jt+Lt+Bt;if(v&&A.forEach(function(Dt){var vt,dt;Nt+=$;var St=Dt.title;(vt=_.createFigure({name:"text",attrs:{x:yi,y:Nt,text:St.text},styles:{color:St.color,size:tt,family:et,weight:Q}}))===null||vt===void 0||vt.draw(e);var At=Dt.value;(dt=_.createFigure({name:"text",attrs:{x:yt+Vt-Lt-ut-Rt,y:Nt,text:At.text,align:"right"},styles:{color:At.color,size:tt,family:et,weight:Q}}))===null||dt===void 0||dt.draw(e),Nt+=tt+U}),p){var Si=yt+Lt+_t+rr;or.forEach(function(Dt){Dt.forEach(function(vt){var dt,St;Nt+=nr;var At=vt.title,ye=vt.value;(dt=_.createFigure({name:"text",attrs:{x:Si,y:Nt,text:At.text},styles:{color:At.color,size:he,family:Re,weight:Fe}}))===null||dt===void 0||dt.draw(e),(St=_.createFigure({name:"text",attrs:{x:yt+Vt-Lt-ir-Rt,y:Nt,text:ye.text,align:"right"},styles:{color:ye.color,size:he,family:Re,weight:Fe}}))===null||St===void 0||St.draw(e),Nt+=he+ar})})}}}},t.prototype._getCandleTooltipLegends=function(e,r,n,a,s,o,l,u){var c,h,f,d,v,p=u.tooltip,g=p.text.color,m=e.current,_=(h=(c=e.prev)===null||c===void 0?void 0:c.close)!==null&&h!==void 0?h:m.close,S=m.close-_,y=r.price,x=r.volume,w={"{time}":s.formatDate(n,m.timestamp,"YYYY-MM-DD HH:mm",lt.Tooltip),"{open}":nt(rt(K(m.open,y),o),l),"{high}":nt(rt(K(m.high,y),o),l),"{low}":nt(rt(K(m.low,y),o),l),"{close}":nt(rt(K(m.close,y),o),l),"{volume}":nt(rt(s.formatBigNumber(K((f=m.volume)!==null&&f!==void 0?f:p.defaultValue,x)),o),l),"{turnover}":nt(rt(K((d=m.turnover)!==null&&d!==void 0?d:p.defaultValue,y),o),l),"{change}":_===0?p.defaultValue:"".concat(rt(K(S/_*100),o),"%")},b=(v=kt(p.custom)?p.custom(e,u):p.custom)!==null&&v!==void 0?v:[];return b.map(function(E){var C,M=E.title,I=E.value,P={text:"",color:""};Mt(M)?P=R({},M):(P.text=M,P.color=g),P.text=za(P.text,a);var A={text:p.defaultValue,color:""};Mt(I)?A=R({},I):(A.text=I,A.color=g);var k=A.text.match(/{(\S*)}/);if(k!==null&&k.length>1){var B="{".concat(k[1],"}");A.text=A.text.replace(B,(C=w[B])!==null&&C!==void 0?C:p.defaultValue),B==="{change}"&&(A.color=S===0?u.priceMark.last.noChangeColor:S>0?u.priceMark.last.upColor:u.priceMark.last.downColor)}return{title:P,value:A}})},t}(ri),Ya=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n._candleBarView=new ei(n),n._candleAreaView=new Ba(n),n._candleHighLowPriceView=new La(n),n._candleLastPriceLineView=new Va(n),n.addChild(n._candleBarView),n}return t.prototype.updateMainContent=function(e){var r=this.getPane().getChart().getStyles().candle;r.type!==ft.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleAreaView.stopAnimation()):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},t.prototype.createTooltipView=function(){return new Xa(this)},t}(ni),ai=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this,n,a,s=this.getWidget(),o=s.getPane(),l=s.getBounding(),u=o.getAxisComponent(),c=this.getAxisStyles(o.getChart().getStyles());if(c.show){c.axisLine.show&&((n=this.createFigure({name:"line",attrs:this.createAxisLine(l,c),styles:c.axisLine}))===null||n===void 0||n.draw(e));var h=u.getTicks();if(c.tickLine.show){var f=this.createTickLines(h,l,c);f.forEach(function(v){var p;(p=r.createFigure({name:"line",attrs:v,styles:c.tickLine}))===null||p===void 0||p.draw(e)})}if(c.tickText.show){var d=this.createTickTexts(h,l,c);(a=this.createFigure({name:"text",attrs:d,styles:c.tickText}))===null||a===void 0||a.draw(e)}}},t}(Tt),Ha=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.yAxis},t.prototype.createAxisLine=function(e,r){var n=this.getWidget().getPane().getAxisComponent(),a=r.axisLine.size,s;return n.isFromZero()?s=0:s=e.width-a,{coordinates:[{x:s,y:0},{x:s,y:e.height}]}},t.prototype.createTickLines=function(e,r,n){var a=this.getWidget().getPane().getAxisComponent(),s=n.axisLine,o=n.tickLine,l=0,u=0;return a.isFromZero()?(l=0,s.show&&(l+=s.size),u=l+o.length):(l=r.width,s.show&&(l-=s.size),u=l-o.length),e.map(function(c){return{coordinates:[{x:l,y:c.coord},{x:u,y:c.coord}]}})},t.prototype.createTickTexts=function(e,r,n){var a=this.getWidget().getPane().getAxisComponent(),s=n.axisLine,o=n.tickLine,l=n.tickText,u=0;a.isFromZero()?(u=l.marginStart,s.show&&(u+=s.size),o.show&&(u+=o.length)):(u=r.width-l.marginEnd,s.show&&(u-=s.size),o.show&&(u-=o.length));var c=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(function(h){return{x:u,y:h.coord,text:h.text,align:c,baseline:"middle"}})},t}(ai),Ga=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,n=this.getWidget(),a=n.getPane(),s=n.getBounding(),o=a.getChart().getChartStore(),l=o.getStyles().candle.priceMark,u=l.last,c=u.text;if(l.show&&u.show&&c.show){var h=o.getPrecision(),f=a.getAxisComponent(),d=o.getDataList(),v=d[d.length-1];if(T(v)){var p=v.close,g=v.open,m=f.convertToNicePixel(p),_=void 0;p>g?_=u.upColor:p<g?_=u.downColor:_=u.noChangeColor;var S=void 0;if(f.getType()===at.Percentage){var y=o.getVisibleFirstData(),x=y.close;S="".concat(((p-x)/x*100).toFixed(2),"%")}else S=K(p,h.price);S=nt(rt(S,o.getThousandsSeparator()),o.getDecimalFoldThreshold());var w=void 0,b=void 0;f.isFromZero()?(w=0,b="left"):(w=s.width,b="right"),(r=this.createFigure({name:"text",attrs:{x:w,y:m,text:S,align:b,baseline:"middle"},styles:R(R({},c),{backgroundColor:_})}))===null||r===void 0||r.draw(e)}}},t}(Tt),$a=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r=this,n=this.getWidget(),a=n.getPane(),s=n.getBounding(),o=a.getChart().getChartStore(),l=o.getCustomApi(),u=o.getStyles().indicator,c=u.lastValueMark,h=c.text;if(c.show){var f=a.getAxisComponent(),d=o.getDataList(),v=d.length-1,p=o.getIndicatorStore().getInstances(a.getId()),g=o.getThousandsSeparator(),m=o.getDecimalFoldThreshold();p.forEach(function(_){var S=_.result,y=S[v];if(T(y)&&_.visible){var x=_.precision;qe(d,_,v,u,function(w,b){var E,C=y[w.key];if(F(C)){var M=f.convertToNicePixel(C),I=K(C,x);_.shouldFormatBigNumber&&(I=l.formatBigNumber(I)),I=nt(rt(I,g),m);var P=void 0,A=void 0;f.isFromZero()?(P=0,A="left"):(P=s.width,A="right"),(E=r.createFigure({name:"text",attrs:{x:P,y:M,text:I,align:A,baseline:"middle"},styles:R(R({},h),{backgroundColor:b.color})}))===null||E===void 0||E.draw(e)}})}})}},t}(Tt),oi=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},t.prototype.drawDefaultFigures=function(e,r,n,a,s,o,l,u,c,h,f,d,v,p){this.drawFigures(e,r,this.getDefaultFigures(r,n,a,s,o,l,u,c,f,d,p),h)},t.prototype.getDefaultFigures=function(e,r,n,a,s,o,l,u,c,h,f){var d,v,p=[];if(e.needDefaultYAxisFigure&&e.id===((d=f.instance)===null||d===void 0?void 0:d.id)&&f.paneId===this.getWidget().getPane().getId()){var g=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER,_=(v=h==null?void 0:h.isFromZero())!==null&&v!==void 0?v:!1,S,y;_?(S="left",y=0):(S="right",y=n.width),r.forEach(function(x,w){var b=e.points[w];if(F(b.value)){g=Math.min(g,x.y),m=Math.max(m,x.y);var E=nt(rt(K(b.value,a.price),l),u);p.push({type:"text",attrs:{x:y,y:x.y,text:E,align:S,baseline:"middle"},ignoreEvent:!0})}}),r.length>1&&p.unshift({type:"rect",attrs:{x:0,y:g,width:n.width,height:m-g},ignoreEvent:!0})}return p},t.prototype.getFigures=function(e,r,n,a,s,o,l,u,c,h,f){var d,v;return(v=(d=e.createYAxisFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:r,bounding:n,barSpace:a,precision:s,thousandsSeparator:o,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:f}))!==null&&v!==void 0?v:[]},t}(ii),si=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var r,n=this.getWidget(),a=n.getPane(),s=n.getBounding(),o=n.getPane().getChart().getChartStore(),l=o.getTooltipStore().getCrosshair(),u=o.getStyles().crosshair;if(O(l.paneId)&&this.compare(l,a.getId())&&u.show){var c=this.getDirectionStyles(u),h=c.text;if(c.show&&h.show){var f=a.getAxisComponent(),d=this.getText(l,o,f);e.font=te(h.size,h.weight,h.family),(r=this.createFigure({name:"text",attrs:this.getTextAttrs(d,e.measureText(d).width,l,s,f,h),styles:h}))===null||r===void 0||r.draw(e)}}},t.prototype.compare=function(e,r){return e.paneId===r},t.prototype.getDirectionStyles=function(e){return e.horizontal},t.prototype.getText=function(e,r,n){var a=n,s=n.convertFromPixel(e.y),o;if(a.getType()===at.Percentage){var l=r.getVisibleFirstData();o="".concat(((s-l.close)/l.close*100).toFixed(2),"%")}else{var u=r.getIndicatorStore().getInstances(e.paneId),c=0,h=!1;a.isInCandle()?c=r.getPrecision().price:u.forEach(function(f){c=Math.max(f.precision,c),h||(h=f.shouldFormatBigNumber)}),o=K(s,c),h&&(o=r.getCustomApi().formatBigNumber(o))}return nt(rt(o,r.getThousandsSeparator()),r.getDecimalFoldThreshold())},t.prototype.getTextAttrs=function(e,r,n,a,s,o){var l=s,u,c;return l.isFromZero()?(u=0,c="left"):(u=a.width,c="right"),{x:u,y:n.y,text:e,align:c,baseline:"middle"}},t}(Tt),Ua=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n._yAxisView=new Ha(n),n._candleLastPriceLabelView=new Ga(n),n._indicatorLastValueView=new $a(n),n._overlayYAxisView=new oi(n),n._crosshairHorizontalLabelView=new si(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return t.prototype.getName=function(){return W.Y_AXIS},t.prototype.updateMain=function(e){this._yAxisView.draw(e),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(e),this._indicatorLastValueView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayYAxisView.draw(e),this._crosshairHorizontalLabelView.draw(e)},t}(Je),li=function(){function i(t){this._range={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._prevRange={from:0,to:0,range:0,realFrom:0,realTo:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return i.prototype.getParent=function(){return this._parent},i.prototype.buildTicks=function(t){if(this._autoCalcTickFlag&&(this._range=this.calcRange()),this._prevRange.from!==this._range.from||this._prevRange.to!==this._range.to||t){this._prevRange=this._range;var e=this.optimalTicks(this._calcTicks());return this._ticks=this.createTicks({range:this._range,bounding:this.getSelfBounding(),defaultTicks:e}),!0}return!1},i.prototype.getTicks=function(){return this._ticks},i.prototype.getScrollZoomEnabled=function(){var t;return(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)!==null&&t!==void 0?t:!0},i.prototype.setRange=function(t){this._autoCalcTickFlag=!1,this._range=t},i.prototype.getRange=function(){return this._range},i.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},i.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},i.prototype._calcTicks=function(){var t=this._range,e=t.realFrom,r=t.realTo,n=t.realRange,a=[];if(n>=0){var s=ee(this._calcTickInterval(n),2),o=s[0],l=s[1],u=dr(Math.ceil(e/o)*o,l),c=dr(Math.floor(r/o)*o,l),h=0,f=u;if(o!==0)for(;f<=c;){var d=f.toFixed(l);a[h]={text:d,coord:0,value:d},++h,f+=o}}return a},i.prototype._calcTickInterval=function(t){var e=tn(t/8),r=en(e);return[e,r]},i}(),ja=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e,r,n,a,s=this.getParent(),o=s.getChart(),l=o.getChartStore(),u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,h=[],f=!1,d=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER,g=l.getIndicatorStore().getInstances(s.getId());g.forEach(function(U){var tt,Q,et;f||(f=(tt=U.shouldOhlc)!==null&&tt!==void 0?tt:!1),p=Math.min(p,U.precision),F(U.minValue)&&(d=Math.min(d,U.minValue)),F(U.maxValue)&&(v=Math.max(v,U.maxValue)),h.push({figures:(Q=U.figures)!==null&&Q!==void 0?Q:[],result:(et=U.result)!==null&&et!==void 0?et:[]})});var m=4,_=this.isInCandle();if(_){var S=l.getPrecision().price;p!==Number.MAX_SAFE_INTEGER?m=Math.min(p,S):m=S}else p!==Number.MAX_SAFE_INTEGER&&(m=p);var y=l.getVisibleDataList(),x=o.getStyles().candle,w=x.type===ft.Area,b=x.area.value,E=_&&!w||!_&&f;y.forEach(function(U){var tt=U.dataIndex,Q=U.data;if(T(Q)&&(E&&(u=Math.min(u,Q.low),c=Math.max(c,Q.high)),_&&w)){var et=Q[b];F(et)&&(u=Math.min(u,et),c=Math.max(c,et))}h.forEach(function(q){var Ct,_t=q.figures,Rt=q.result,Bt=(Ct=Rt[tt])!==null&&Ct!==void 0?Ct:{};_t.forEach(function($t){var Et=Bt[$t.key];F(Et)&&(u=Math.min(u,Et),c=Math.max(c,Et))})})}),u!==Number.MAX_SAFE_INTEGER&&c!==Number.MIN_SAFE_INTEGER?(u=Math.min(d,u),c=Math.max(v,c)):(u=0,c=10);var C=this.getType(),M;switch(C){case at.Percentage:{var I=l.getVisibleFirstData();T(I)&&F(I.close)&&(u=(u-I.close)/I.close*100,c=(c-I.close)/I.close*100),M=Math.pow(10,-2);break}case at.Log:{u=fe(u),c=fe(c),M=.05*Zt(-m);break}default:M=Zt(-m)}if(u===c||Math.abs(u-c)<M){var P=d===u,A=v===c;u=P?u:A?u-8*M:u-4*M,c=A?c:P?c+8*M:c+4*M}var k=(r=(e=this.getParent().getYAxisWidget())===null||e===void 0?void 0:e.getBounding().height)!==null&&r!==void 0?r:0,B=s.getOptions().gap,L=(n=B==null?void 0:B.top)!==null&&n!==void 0?n:.2;L>=1&&(L=L/k);var G=(a=B==null?void 0:B.bottom)!==null&&a!==void 0?a:.1;G>=1&&(G=G/k);var z=Math.abs(c-u);u=u-z*G,c=c+z*L,z=Math.abs(c-u);var st,ut,$;return C===at.Log?(st=Zt(u),ut=Zt(c),$=Math.abs(ut-st)):(st=u,ut=c,$=z),{from:u,to:c,range:z,realFrom:st,realTo:ut,realRange:$}},t.prototype._innerConvertToPixel=function(e){var r,n,a=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,s=this.getRange(),o=s.from,l=s.range,u=(e-o)/l;return this.isReverse()?Math.round(u*a):Math.round((1-u)*a)},t.prototype.isInCandle=function(){return this.getParent().getId()===Y.CANDLE},t.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:at.Normal},t.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},t.prototype.isReverse=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.reverse:!1},t.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,r=e.inside;return e.position===Gt.Left&&r||e.position===Gt.Right&&!r},t.prototype.optimalTicks=function(e){var r=this,n,a,s=this.getParent(),o=(a=(n=s.getYAxisWidget())===null||n===void 0?void 0:n.getBounding().height)!==null&&a!==void 0?a:0,l=s.getChart().getChartStore(),u=l.getCustomApi(),c=[],h=this.getType(),f=l.getIndicatorStore().getInstances(s.getId()),d=l.getThousandsSeparator(),v=l.getDecimalFoldThreshold(),p=0,g=!1;this.isInCandle()?p=l.getPrecision().price:f.forEach(function(S){p=Math.max(p,S.precision),g||(g=S.shouldFormatBigNumber)});var m=l.getStyles().xAxis.tickText.size,_;return e.forEach(function(S){var y=S.value,x,w=r._innerConvertToPixel(+y);switch(h){case at.Percentage:{x="".concat(K(y,2),"%");break}case at.Log:{w=r._innerConvertToPixel(fe(+y)),x=K(y,p);break}default:{x=K(y,p),g&&(x=u.formatBigNumber(y));break}}x=nt(rt(x,d),v);var b=F(_);w>m&&w<o-m&&(b&&Math.abs(_-w)>m*2||!b)&&(c.push({text:x,coord:w,value:y}),_=w)}),c},t.prototype.getAutoSize=function(){var e=this.getParent(),r=e.getChart(),n=r.getStyles(),a=n.yAxis,s=a.size;if(s!=="auto")return s;var o=r.getChartStore(),l=o.getCustomApi(),u=0;if(a.show&&(a.axisLine.show&&(u+=a.axisLine.size),a.tickLine.show&&(u+=a.tickLine.length),a.tickText.show)){var c=0;this.getTicks().forEach(function(y){c=Math.max(c,Ee(y.text,a.tickText.size,a.tickText.weight,a.tickText.family))}),u+=a.tickText.marginStart+a.tickText.marginEnd+c}var h=n.crosshair,f=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var d=o.getIndicatorStore().getInstances(e.getId()),v=0,p=!1;d.forEach(function(y){v=Math.max(y.precision,v),p||(p=y.shouldFormatBigNumber)});var g=2;if(this.getType()!==at.Percentage)if(this.isInCandle()){var m=o.getPrecision().price,_=n.indicator.lastValueMark;_.show&&_.text.show?g=Math.max(v,m):g=m}else g=v;var S=K(this.getRange().to,g);p&&(S=l.formatBigNumber(S)),S=nt(S,o.getDecimalFoldThreshold()),f+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+h.horizontal.text.borderSize*2+Ee(S,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(u,f)},t.prototype.getSelfBounding=function(){return this.getParent().getYAxisWidget().getBounding()},t.prototype.convertFromPixel=function(e){var r,n,a=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,s=this.getRange(),o=s.from,l=s.range,u=this.isReverse()?e/a:1-e/a,c=u*l+o;switch(this.getType()){case at.Percentage:{var h=this.getParent().getChart().getChartStore().getVisibleFirstData();return T(h)&&F(h.close)?h.close*c/100+h.close:0}case at.Log:return Zt(c);default:return c}},t.prototype.convertToRealValue=function(e){var r=e;return this.getType()===at.Log&&(r=Zt(e)),r},t.prototype.convertToPixel=function(e){var r=e;switch(this.getType()){case at.Percentage:{var n=this.getParent().getChart().getChartStore().getVisibleFirstData();T(n)&&F(n.close)&&(r=(e-n.close)/n.close*100);break}case at.Log:{r=fe(e);break}default:r=e}return this._innerConvertToPixel(r)},t.prototype.convertToNicePixel=function(e){var r,n,a=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,s=this.convertToPixel(e);return Math.round(Math.max(a*.05,Math.min(s,a*.98)))},t.extend=function(e){var r=function(n){N(a,n);function a(){return n!==null&&n.apply(this,arguments)||this}return a.prototype.createTicks=function(s){return e.createTicks(s)},a}(t);return r},t}(li),Za={name:"default",createTicks:function(i){var t=i.defaultTicks;return t}},_r={default:ja.extend(Za)};function qa(i){var t;return(t=_r[i])!==null&&t!==void 0?t:_r.default}var ui=function(){function i(t,e,r,n){this._bounding=Zr(),this._chart=r,this._id=n,this._init(t,e)}return i.prototype._init=function(t,e){this._rootContainer=t,this._container=Ft("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),e!==null?t.insertBefore(this._container,e):t.appendChild(this._container)},i.prototype.getContainer=function(){return this._container},i.prototype.getId=function(){return this._id},i.prototype.getChart=function(){return this._chart},i.prototype.getBounding=function(){return this._bounding},i.prototype.update=function(t){this._bounding.height!==this._container.clientHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(t??3,this._container,this._bounding)},i.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},i}(),ci=function(i){N(t,i);function t(e,r,n,a,s){var o=i.call(this,e,r,n,a)||this;o._yAxisWidget=null,o._options={minHeight:oa,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{name:"default",scrollZoomEnabled:!0}};var l=o.getContainer();return o._mainWidget=o.createMainWidget(l),o._yAxisWidget=o.createYAxisWidget(l),o.setOptions(s),o}return t.prototype.setOptions=function(e){var r,n,a,s=(r=e.axisOptions)===null||r===void 0?void 0:r.name;(this._options.axisOptions.name!==s&&O(s)||!T(this._axis))&&(this._axis=this.createAxisComponent(s??"default")),mt(this._options,e);var o,l;return this.getId()===Y.X_AXIS?(o=this.getMainWidget().getContainer(),l="ew-resize"):(o=this.getYAxisWidget().getContainer(),l="ns-resize"),!((a=(n=e.axisOptions)===null||n===void 0?void 0:n.scrollZoomEnabled)!==null&&a!==void 0)||a?o.style.cursor=l:o.style.cursor="default",this},t.prototype.getOptions=function(){return this._options},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(e,r,n){var a,s;mt(this.getBounding(),e);var o={};return T(e.height)&&(o.height=e.height),T(e.top)&&(o.top=e.top),this._mainWidget.setBounding(o),(a=this._yAxisWidget)===null||a===void 0||a.setBounding(o),T(r)&&this._mainWidget.setBounding(r),T(n)&&((s=this._yAxisWidget)===null||s===void 0||s.setBounding(n)),this},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.updateImp=function(e){var r;this._mainWidget.update(e),(r=this._yAxisWidget)===null||r===void 0||r.update(e)},t.prototype.destroy=function(){var e;i.prototype.destroy.call(this),this._mainWidget.destroy(),(e=this._yAxisWidget)===null||e===void 0||e.destroy()},t.prototype.getImage=function(e){var r=this.getBounding(),n=r.width,a=r.height,s=Ft("canvas",{width:"".concat(n,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),o=s.getContext("2d"),l=Ht(s);s.width=n*l,s.height=a*l,o.scale(l,l);var u=this._mainWidget.getBounding();if(o.drawImage(this._mainWidget.getImage(e),u.left,0,u.width,u.height),this._yAxisWidget!==null){var c=this._yAxisWidget.getBounding();o.drawImage(this._yAxisWidget.getImage(e),c.left,0,c.width,c.height)}return s},t.prototype.createYAxisWidget=function(e){return null},t}(ui),hi=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var r=qa(e??"default");return new r(this)},t.prototype.createMainWidget=function(e){return new ni(e,this)},t.prototype.createYAxisWidget=function(e){return new Ua(e,this)},t}(ci),Ka=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createMainWidget=function(e){return new Ya(e,this)},t}(hi),Qa=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.xAxis},t.prototype.createAxisLine=function(e){return{coordinates:[{x:0,y:0},{x:e.width,y:0}]}},t.prototype.createTickLines=function(e,r,n){var a=n.tickLine,s=n.axisLine.size;return e.map(function(o){return{coordinates:[{x:o.coord,y:0},{x:o.coord,y:s+a.length}]}})},t.prototype.createTickTexts=function(e,r,n){var a=n.tickText,s=n.axisLine.size,o=n.tickLine.length;return e.map(function(l){return{x:l.coord,y:s+o+a.marginStart,text:l.text,align:"center",baseline:"top"}})},t}(ai),Ja=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.coordinateToPointValueFlag=function(){return!1},t.prototype.getCompleteOverlays=function(e){return e.getInstances()},t.prototype.getProgressOverlay=function(e){return e.instance},t.prototype.getDefaultFigures=function(e,r,n,a,s,o,l,u,c,h,f){var d,v=[];if(e.needDefaultXAxisFigure&&e.id===((d=f.instance)===null||d===void 0?void 0:d.id)){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;r.forEach(function(m,_){p=Math.min(p,m.x),g=Math.max(g,m.x);var S=e.points[_];if(F(S.timestamp)){var y=o.formatDate(s,S.timestamp,"YYYY-MM-DD HH:mm",lt.Crosshair);v.push({type:"text",attrs:{x:m.x,y:0,text:y,align:"center"},ignoreEvent:!0})}}),r.length>1&&v.unshift({type:"rect",attrs:{x:p,y:0,width:g-p,height:n.height},ignoreEvent:!0})}return v},t.prototype.getFigures=function(e,r,n,a,s,o,l,u,c,h,f){var d,v;return(v=(d=e.createXAxisFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:r,bounding:n,barSpace:a,precision:s,thousandsSeparator:o,decimalFoldThreshold:l,dateTimeFormat:u,defaultStyles:c,xAxis:h,yAxis:f}))!==null&&v!==void 0?v:[]},t}(oi),to=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.compare=function(e){return T(e.kLineData)&&e.dataIndex===e.realDataIndex},t.prototype.getDirectionStyles=function(e){return e.vertical},t.prototype.getText=function(e,r){var n,a=(n=e.kLineData)===null||n===void 0?void 0:n.timestamp;return r.getCustomApi().formatDate(r.getTimeScaleStore().getDateTimeFormat(),a,"YYYY-MM-DD HH:mm",lt.Crosshair)},t.prototype.getTextAttrs=function(e,r,n,a,s,o){var l=n.realX,u,c="center";return l-r/2-o.paddingLeft<0?(u=0,c="left"):l+r/2+o.paddingRight>a.width?(u=a.width,c="right"):u=l,{x:u,y:0,text:e,align:c,baseline:"top"}},t}(si),eo=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n._xAxisView=new Qa(n),n._overlayXAxisView=new Ja(n),n._crosshairVerticalLabelView=new to(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return t.prototype.getName=function(){return W.X_AXIS},t.prototype.updateMain=function(e){this._xAxisView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayXAxisView.draw(e),this._crosshairVerticalLabelView.draw(e)},t}(Je),ro=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.calcRange=function(){var e=this.getParent().getChart().getChartStore(),r=e.getTimeScaleStore().getVisibleRange(),n=r.from,a=r.to,s=n,o=a-1,l=a-n;return{from:s,to:o,range:l,realFrom:s,realTo:o,realRange:l}},t.prototype.optimalTicks=function(e){var r,n,a=this.getParent().getChart(),s=a.getChartStore(),o=s.getCustomApi().formatDate,l=[],u=e.length,c=s.getDataList();if(u>0){var h=s.getTimeScaleStore().getDateTimeFormat(),f=a.getStyles().xAxis.tickText,d=Ee("00-00 00:00",f.size,f.weight,f.family),v=parseInt(e[0].value,10),p=this.convertToPixel(v),g=1;if(u>1){var m=parseInt(e[1].value,10),_=this.convertToPixel(m),S=Math.abs(_-p);S<d&&(g=Math.ceil(d/S))}for(var y=0;y<u;y+=g){var x=parseInt(e[y].value,10),w=c[x],b=w.timestamp,E=o(h,b,"HH:mm",lt.XAxis);if(y!==0){var C=parseInt(e[y-g].value,10),M=c[C],I=M.timestamp;E=(r=this._optimalTickLabel(o,h,b,I))!==null&&r!==void 0?r:E}var P=this.convertToPixel(x);l.push({text:E,coord:P,value:b})}var A=l.length;if(A===1)l[0].text=o(h,l[0].value,"YYYY-MM-DD HH:mm",lt.XAxis);else{var k=l[0].value,B=l[1].value;if(T(l[2])){var L=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(L)?l[0].text=o(h,k,"MM-DD",lt.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(L)?l[0].text=o(h,k,"YYYY-MM",lt.XAxis):/^[0-9]{4}$/.test(L)&&(l[0].text=o(h,k,"YYYY",lt.XAxis))}else l[0].text=(n=this._optimalTickLabel(o,h,k,B))!==null&&n!==void 0?n:l[0].text}}return l},t.prototype._optimalTickLabel=function(e,r,n,a){var s=e(r,n,"YYYY",lt.XAxis),o=e(r,n,"YYYY-MM",lt.XAxis),l=e(r,n,"MM-DD",lt.XAxis);return s!==e(r,a,"YYYY",lt.XAxis)?s:o!==e(r,a,"YYYY-MM",lt.XAxis)?o:l!==e(r,a,"MM-DD",lt.XAxis)?l:null},t.prototype.getAutoSize=function(){var e=this.getParent().getChart().getStyles(),r=e.xAxis,n=r.size;if(n!=="auto")return n;var a=e.crosshair,s=0;r.show&&(r.axisLine.show&&(s+=r.axisLine.size),r.tickLine.show&&(s+=r.tickLine.length),r.tickText.show&&(s+=r.tickText.marginStart+r.tickText.marginEnd+r.tickText.size));var o=0;return a.show&&a.vertical.show&&a.vertical.text.show&&(o+=a.vertical.text.paddingTop+a.vertical.text.paddingBottom+a.vertical.text.borderSize*2+a.vertical.text.size),Math.max(s,o)},t.prototype.getSelfBounding=function(){return this.getParent().getMainWidget().getBounding()},t.prototype.convertTimestampFromPixel=function(e){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=r.coordinateToDataIndex(e);return r.dataIndexToTimestamp(n)},t.prototype.convertTimestampToPixel=function(e){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=r.timestampToDataIndex(e);return r.dataIndexToCoordinate(n)},t.prototype.convertFromPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(e)},t.prototype.convertToPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(e)},t.extend=function(e){var r=function(n){N(a,n);function a(){return n!==null&&n.apply(this,arguments)||this}return a.prototype.createTicks=function(s){return e.createTicks(s)},a}(t);return r},t}(li),io={name:"default",createTicks:function(i){var t=i.defaultTicks;return t}},yr={default:ro.extend(io)};function no(i){var t;return(t=yr[i])!==null&&t!==void 0?t:yr.default}var ao=function(i){N(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(e){var r=no(e);return new r(this)},t.prototype.createMainWidget=function(e){return new eo(e,this)},t}(ci);function oo(i,t){var e=0;return function(){var r=Date.now();r-e>t&&(i.apply(this,arguments),e=r)}}var so=function(i){N(t,i);function t(e,r){var n=i.call(this,e,r)||this;return n._dragFlag=!1,n._dragStartY=0,n._topPaneHeight=0,n._bottomPaneHeight=0,n._pressedMouseMoveEvent=oo(n._pressedTouchMouseMoveEvent,20),n.registerEvent("touchStartEvent",n._mouseDownEvent.bind(n)).registerEvent("touchMoveEvent",n._pressedMouseMoveEvent.bind(n)).registerEvent("touchEndEvent",n._mouseUpEvent.bind(n)).registerEvent("mouseDownEvent",n._mouseDownEvent.bind(n)).registerEvent("mouseUpEvent",n._mouseUpEvent.bind(n)).registerEvent("pressedMouseMoveEvent",n._pressedMouseMoveEvent.bind(n)).registerEvent("mouseEnterEvent",n._mouseEnterEvent.bind(n)).registerEvent("mouseLeaveEvent",n._mouseLeaveEvent.bind(n)),n}return t.prototype.getName=function(){return W.SEPARATOR},t.prototype.checkEventOn=function(){return!0},t.prototype._mouseDownEvent=function(e){this._dragFlag=!0,this._dragStartY=e.pageY;var r=this.getPane();return this._topPaneHeight=r.getTopPane().getBounding().height,this._bottomPaneHeight=r.getBottomPane().getBounding().height,!0},t.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},t.prototype._pressedTouchMouseMoveEvent=function(e){var r=e.pageY-this._dragStartY,n=this.getPane(),a=n.getTopPane(),s=n.getBottomPane(),o=r<0;if(a!==null&&(s!=null&&s.getOptions().dragEnabled)){var l=void 0,u=void 0,c=void 0,h=void 0;o?(l=a,u=s,c=this._topPaneHeight,h=this._bottomPaneHeight):(l=s,u=a,c=this._bottomPaneHeight,h=this._topPaneHeight);var f=l.getOptions().minHeight;if(c>f){var d=Math.max(c-Math.abs(r),f),v=c-d;l.setBounding({height:d}),u.setBounding({height:h+v});var p=n.getChart();p.getChartStore().getActionStore().execute(gt.OnPaneDrag,{paneId:n.getId()}),p.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},t.prototype._mouseEnterEvent=function(){var e,r=this.getPane(),n=r.getBottomPane();if((e=n==null?void 0:n.getOptions().dragEnabled)!==null&&e!==void 0&&e){var a=r.getChart(),s=a.getStyles().separator;return this.getContainer().style.background=s.activeBackgroundColor,!0}return!1},t.prototype._mouseLeaveEvent=function(){return this._dragFlag?!1:(this.getContainer().style.background="",!0)},t.prototype.createContainer=function(){return Ft("div",{width:"100%",height:"".concat(ge,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},t.prototype.updateImp=function(e,r,n){if(n===4||n===2){var a=this.getPane().getChart().getStyles().separator;e.style.top="".concat(-Math.floor((ge-a.size)/2),"px"),e.style.height="".concat(ge,"px")}},t}(qr),Sr=function(i){N(t,i);function t(e,r,n,a,s,o){var l=i.call(this,e,r,n,a)||this;return l.getContainer().style.overflow="",l._topPane=s,l._bottomPane=o,l._separatorWidget=new so(l.getContainer(),l),l}return t.prototype.setBounding=function(e){return mt(this.getBounding(),e),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(e){return this._topPane=e,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(e){return this._bottomPane=e,this},t.prototype.getWidget=function(){return this._separatorWidget},t.prototype.getImage=function(e){var r=this.getBounding(),n=r.width,a=r.height,s=this.getChart().getStyles().separator,o=Ft("canvas",{width:"".concat(n,"px"),height:"".concat(a,"px"),boxSizing:"border-box"}),l=o.getContext("2d"),u=Ht(o);return o.width=n*u,o.height=a*u,l.scale(u,u),l.fillStyle=s.color,l.fillRect(0,0,n,a),o},t.prototype.updateImp=function(e,r,n){if(e===4||e===2){var a=this.getChart().getStyles().separator;r.style.backgroundColor=a.color,r.style.height="".concat(n.height,"px"),r.style.marginLeft="".concat(n.left,"px"),r.style.width="".concat(n.width,"px"),this._separatorWidget.update(e)}},t}(ui);function xr(){var i;return typeof window>"u"?!1:((i=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&i!==void 0?i:-1)>-1}function We(){return typeof window>"u"?!1:/iPhone|iPad|iPod/.test(window.navigator.platform)}var lo=10,uo=function(){function i(t,e,r){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!We(),this._onFirefoxOutsideMouseUp=function(a){n._mouseUpHandler(a)},this._onMobileSafariDoubleClick=function(a){if(n._firesTouchEvents(a)){if(++n._tapCount,n._tapTimeoutId!==null&&n._tapCount>1){var s=n._mouseTouchMoveWithDownInfo(n._getCoordinate(a),n._tapCoordinate).manhattanDistance;s<30&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(a),n._handler.doubleTapEvent),n._resetTapTimeout()}}else if(++n._clickCount,n._clickTimeoutId!==null&&n._clickCount>1){var s=n._mouseTouchMoveWithDownInfo(n._getCoordinate(a),n._clickCoordinate).manhattanDistance;s<5&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(a),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()}},this._target=t,this._handler=e,this._options=r,this._init()}return i.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},i.prototype._mouseEnterHandler=function(t){var e=this,r,n,a;(r=this._unsubscribeMousemove)===null||r===void 0||r.call(this),(n=this._unsubscribeMouseWheel)===null||n===void 0||n.call(this),(a=this._unsubscribeContextMenu)===null||a===void 0||a.call(this);var s=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",s)},this._target.addEventListener("mousemove",s);var o=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){e._target.removeEventListener("wheel",o)},this._target.addEventListener("wheel",o,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){e._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},i.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},i.prototype._mouseMoveHandler=function(t){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},i.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!T(this._handler.mouseWheelHortEvent)||(this._preventDefault(t),Math.abs(t.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!T(this._handler.mouseWheelVertEvent))return;var e=-(t.deltaY/100);if(e===0)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32;break}if(e!==0){var r=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),r)}}},i.prototype._contextMenuHandler=function(t){this._preventDefault(t)},i.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var r=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=r.xOffset,a=r.yOffset,s=r.manhattanDistance;if(!(!this._touchMoveExceededManhattanDistance&&s<5)){if(!this._touchMoveExceededManhattanDistance){var o=n*.5,l=a>=o&&!this._options.treatVertDragAsPageScroll(),u=o>a&&!this._options.treatHorzDragAsPageScroll();!l&&!u&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},i.prototype._mouseMoveWithDownHandler=function(t){if(t.button===0){var e=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate),r=e.manhattanDistance;r>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent)}},i.prototype._mouseTouchMoveWithDownInfo=function(t,e){var r=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y),a=r+n;return{xOffset:r,yOffset:n,manhattanDistance:a}},i.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var r=this._makeCompatEvent(t,e);if(this._processEvent(r,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){var n=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance;n<30&&!this._cancelTap&&this._processEvent(r,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(r,this._handler.tapEvent),T(this._handler.tapEvent)&&this._preventDefault(t));this._tapCount===0&&this._preventDefault(t),t.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},i.prototype._mouseUpHandler=function(t){if(t.button===0){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),xr()){var r=this._target.ownerDocument.documentElement;r.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){var n=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance;n<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},i.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},i.prototype._touchStartHandler=function(t){if(this._activeTouchId===null){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var r=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{var n=this._touchMoveHandler.bind(this),a=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){r.removeEventListener("touchmove",n),r.removeEventListener("touchend",a)},r.addEventListener("touchmove",n,{passive:!1}),r.addEventListener("touchend",a,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500)}this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},i.prototype._mouseDownHandler=function(t){if(t.button===2){this._preventDefault(t),this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);return}if(t.button===0){var e=this._target.ownerDocument.documentElement;xr()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{var r=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",r),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",r),e.addEventListener("mouseup",n)}this._mousePressed=!0,!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},i.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{var e=this._target.ownerDocument,r=function(n){t._handler.mouseDownOutsideEvent!=null&&(n.composed&&t._target.contains(n.composedPath()[0])||n.target!==null&&t._target.contains(n.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",r)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",r)},e.addEventListener("mousedown",r),e.addEventListener("touchstart",r,{passive:!0})}We()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(n){if(n.button===1)return n.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},i.prototype._initPinch=function(){var t=this;!T(this._handler.pinchStartEvent)&&!T(this._handler.pinchEvent)&&!T(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",function(e){t._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(e){if(!(e.touches.length!==2||t._startPinchMiddleCoordinate===null)&&T(t._handler.pinchEvent)){var r=t._getTouchDistance(e.touches[0],e.touches[1]),n=r/t._startPinchDistance;t._handler.pinchEvent(R(R({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),n),t._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",function(e){t._checkPinchState(e.touches)}))},i.prototype._checkPinchState=function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},i.prototype._startPinch=function(t){var e,r=(e=this._target.getBoundingClientRect())!==null&&e!==void 0?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-r.left+(t[1].clientX-r.left))/2,y:(t[0].clientY-r.top+(t[1].clientY-r.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),T(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},i.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,T(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},i.prototype._mouseLeaveHandler=function(t){var e,r,n;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(r=this._unsubscribeMouseWheel)===null||r===void 0||r.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this),!this._firesTouchEvents(t)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!We())},i.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);e!==null&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},i.prototype._firesTouchEvents=function(t){var e;return T((e=t.sourceCapabilities)===null||e===void 0?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},i.prototype._processEvent=function(t,e){e==null||e.call(this._handler,t)},i.prototype._makeCompatEvent=function(t,e){var r=this,n,a=e??t,s=(n=this._target.getBoundingClientRect())!==null&&n!==void 0?n:{left:0,top:0};return{x:a.clientX-s.left,y:a.clientY-s.top,pageX:a.pageX,pageY:a.pageY,isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click"&&t.type!=="wheel",preventDefault:function(){t.type!=="touchstart"&&r._preventDefault(t)}}},i.prototype._getTouchDistance=function(t,e){var r=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(r*r+n*n)},i.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},i.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},i.prototype._eventTimeStamp=function(t){var e;return(e=t.timeStamp)!==null&&e!==void 0?e:performance.now()},i.prototype._touchWithId=function(t,e){for(var r=0;r<t.length;++r)if(t[r].identifier===e)return t[r];return null},i}(),co=function(){function i(t,e){var r=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(n){if(n.shiftKey)switch(n.code){case"Equal":{r._chart.getChartStore().getTimeScaleStore().zoom(.5);break}case"Minus":{r._chart.getChartStore().getTimeScaleStore().zoom(-.5);break}case"ArrowLeft":{var a=r._chart.getChartStore().getTimeScaleStore();a.startScroll(),a.scroll(-3*a.getBarSpace().bar);break}case"ArrowRight":{var a=r._chart.getChartStore().getTimeScaleStore();a.startScroll(),a.scroll(3*a.getBarSpace().bar);break}}},this._container=t,this._chart=e,this._event=new uo(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return i.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},i.prototype.pinchEvent=function(t,e){var r=this._findWidgetByEvent(t),n=r.pane,a=r.widget;if((n==null?void 0:n.getId())!==Y.X_AXIS&&(a==null?void 0:a.getName())===W.MAIN){var s=this._makeWidgetEvent(t,a),o=(e-this._pinchScale)*5;return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(o,{x:s.x,y:s.y}),!0}return!1},i.prototype.mouseWheelHortEvent=function(t,e){var r=this._chart.getChartStore().getTimeScaleStore();return r.startScroll(),r.scroll(e),!0},i.prototype.mouseWheelVertEvent=function(t,e){var r=this._findWidgetByEvent(t).widget,n=this._makeWidgetEvent(t,r),a=r==null?void 0:r.getName();return a===W.MAIN?(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:n.x,y:n.y}),!0):!1},i.prototype.mouseDownEvent=function(t){var e,r,n=this._findWidgetByEvent(t),a=n.pane,s=n.widget;if(this._mouseDownWidget=s,s!==null){var o=this._makeWidgetEvent(t,s),l=s.getName();switch(l){case W.SEPARATOR:return s.dispatchEvent("mouseDownEvent",o);case W.MAIN:{var u=(e=a.getAxisComponent().getRange())!==null&&e!==void 0?e:null;return this._prevYAxisRange=u===null?u:R({},u),this._startScrollCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),s.dispatchEvent("mouseDownEvent",o)}case W.X_AXIS:{var c=s.dispatchEvent("mouseDownEvent",o);return c&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:o.x,y:o.y},this._xAxisStartScaleDistance=o.pageX,c}case W.Y_AXIS:{var c=s.dispatchEvent("mouseDownEvent",o);c&&this._chart.updatePane(1);var u=(r=a.getAxisComponent().getRange())!==null&&r!==void 0?r:null;return this._prevYAxisRange=u===null?u:R({},u),this._yAxisStartScaleDistance=o.pageY,c}}}return!1},i.prototype.mouseMoveEvent=function(t){var e,r,n,a=this._findWidgetByEvent(t),s=a.pane,o=a.widget,l=this._makeWidgetEvent(t,o);if((((e=this._mouseMoveTriggerWidgetInfo.pane)===null||e===void 0?void 0:e.getId())!==(s==null?void 0:s.getId())||((r=this._mouseMoveTriggerWidgetInfo.widget)===null||r===void 0?void 0:r.getName())!==(o==null?void 0:o.getName()))&&(o==null||o.dispatchEvent("mouseEnterEvent",l),(n=this._mouseMoveTriggerWidgetInfo.widget)===null||n===void 0||n.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:s,widget:o}),o!==null){var u=o.getName();switch(u){case W.MAIN:{var c=o.dispatchEvent("mouseMoveEvent",l),h=this._chart.getChartStore(),f={x:l.x,y:l.y,paneId:s==null?void 0:s.getId()};return c&&h.getTooltipStore().getActiveIcon()!==null&&(f=void 0,o!==null&&(o.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(f),c}case W.SEPARATOR:case W.X_AXIS:case W.Y_AXIS:{var c=o.dispatchEvent("mouseMoveEvent",l);return this._chart.getChartStore().getTooltipStore().setCrosshair(),c}}}return!1},i.prototype.pressedMouseMoveEvent=function(t){var e,r,n,a,s;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===W.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var o=this._findWidgetByEvent(t),l=o.pane,u=o.widget;if(u!==null&&((e=this._mouseDownWidget)===null||e===void 0?void 0:e.getPane().getId())===(l==null?void 0:l.getId())&&((r=this._mouseDownWidget)===null||r===void 0?void 0:r.getName())===u.getName()){var c=this._makeWidgetEvent(t,u),h=u.getName();switch(h){case W.MAIN:{var f=u.getBounding(),d=u.dispatchEvent("pressedMouseMoveEvent",c);if(!d&&this._startScrollCoordinate!==null){var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&!v.getAutoCalcTickFlag()&&v.getScrollZoomEnabled()){var p=this._prevYAxisRange,g=p.from,m=p.to,_=p.range,S;(n=v==null?void 0:v.isReverse())!==null&&n!==void 0&&n?S=this._startScrollCoordinate.y-c.y:S=c.y-this._startScrollCoordinate.y;var y=S/f.height,x=_*y,w=g+x,b=m+x,E=v.convertToRealValue(w),C=v.convertToRealValue(b);v.setRange({from:w,to:b,range:b-w,realFrom:E,realTo:C,realRange:C-E})}var M=c.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(M)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:c.x,y:c.y,paneId:l==null?void 0:l.getId()}),d}case W.X_AXIS:{var d=u.dispatchEvent("pressedMouseMoveEvent",c);if(d)this._chart.updatePane(1);else{var I=l.getAxisComponent();if(!((a=I==null?void 0:I.getScrollZoomEnabled())!==null&&a!==void 0)||a){var y=this._xAxisStartScaleDistance/c.pageX;if(Number.isFinite(y)){var P=(y-this._xAxisScale)*10;this._xAxisScale=y,this._chart.getChartStore().getTimeScaleStore().zoom(P,(s=this._xAxisStartScaleCoordinate)!==null&&s!==void 0?s:void 0)}}}return d}case W.Y_AXIS:{var d=u.dispatchEvent("pressedMouseMoveEvent",c);if(d)this._chart.updatePane(1);else{var v=l.getAxisComponent();if(this._prevYAxisRange!==null&&v.getScrollZoomEnabled()){var A=this._prevYAxisRange,g=A.from,m=A.to,_=A.range,y=c.pageY/this._yAxisStartScaleDistance,k=_*y,x=(k-_)/2,w=g-x,b=m+x,E=v.convertToRealValue(w),C=v.convertToRealValue(b);v.setRange({from:w,to:b,range:k,realFrom:E,realTo:C,realRange:C-E}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}}return d}}}return!1},i.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,r=!1;if(e!==null){var n=this._makeWidgetEvent(t,e),a=e.getName();switch(a){case W.MAIN:case W.SEPARATOR:case W.X_AXIS:case W.Y_AXIS:{r=e.dispatchEvent("mouseUpEvent",n);break}}r&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisRange=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,r},i.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(e!==null){var r=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",r)}return!1},i.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,r=!1;if(e!==null){var n=this._makeWidgetEvent(t,e),a=e.getName();switch(a){case W.MAIN:case W.X_AXIS:case W.Y_AXIS:{r=e.dispatchEvent("mouseRightClickEvent",n);break}}r&&this._chart.updatePane(1)}return!1},i.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,n=e.widget;if(n!==null){var a=n.getName();switch(a){case W.MAIN:{var s=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",s)}case W.Y_AXIS:{var o=r.getAxisComponent();if(!o.getAutoCalcTickFlag())return o.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0;break}}}return!1},i.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},i.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,n=e.widget;if(n!==null){var a=this._makeWidgetEvent(t,n),s=n.getName();switch(s){case W.MAIN:{var o=this._chart.getChartStore(),l=o.getTooltipStore();if(n.dispatchEvent("mouseDownEvent",a))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(hr(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:a.x,y:a.y},o.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var u=a.x-this._touchCoordinate.x,c=a.y-this._touchCoordinate.y,h=Math.sqrt(u*u+c*c);h<lo?(this._touchCoordinate={x:a.x,y:a.y},l.setCrosshair({x:a.x,y:a.y,paneId:r==null?void 0:r.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case W.X_AXIS:case W.Y_AXIS:{var f=n.dispatchEvent("mouseDownEvent",a);return f&&this._chart.updatePane(1),f}}}return!1},i.prototype.touchMoveEvent=function(t){var e,r,n,a=this._findWidgetByEvent(t),s=a.pane,o=a.widget;if(o!==null){var l=this._makeWidgetEvent(t,o),u=o.getName(),c=this._chart.getChartStore(),h=c.getTooltipStore();switch(u){case W.MAIN:{if(o.dispatchEvent("pressedMouseMoveEvent",l))return(e=l.preventDefault)===null||e===void 0||e.call(l),h.setCrosshair(void 0,{notInvalidate:!0}),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(r=l.preventDefault)===null||r===void 0||r.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:s==null?void 0:s.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var f=l.x-this._startScrollCoordinate.x;c.getTimeScaleStore().scroll(f)}return!0}case W.X_AXIS:case W.Y_AXIS:{var d=o.dispatchEvent("pressedMouseMoveEvent",l);return d&&((n=l.preventDefault)===null||n===void 0||n.call(l),this._chart.updatePane(1)),d}}}return!1},i.prototype.touchEndEvent=function(t){var e=this,r=this._findWidgetByEvent(t).widget;if(r!==null){var n=this._makeWidgetEvent(t,r),a=r.getName();switch(a){case W.MAIN:{if(r.dispatchEvent("mouseUpEvent",n),this._startScrollCoordinate!==null){var s=new Date().getTime()-this._flingStartTime,o=n.x-this._startScrollCoordinate.x,l=o/(s>0?s:1)*20;if(s<200&&Math.abs(l)>0){var u=this._chart.getChartStore().getTimeScaleStore(),c=function(){e._flingScrollRequestId=Ie(function(){u.startScroll(),u.scroll(l),l=l*(1-.025),Math.abs(l)<1?e._flingScrollRequestId!==null&&(hr(e._flingScrollRequestId),e._flingScrollRequestId=null):c()})};c()}}return!0}case W.X_AXIS:case W.Y_AXIS:{var h=r.dispatchEvent("mouseUpEvent",n);h&&this._chart.updatePane(1)}}}return!1},i.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,n=e.widget,a=!1;if(n!==null){var s=this._makeWidgetEvent(t,n),o=n.dispatchEvent("mouseClickEvent",s);if(n.getName()===W.MAIN){var l=this._makeWidgetEvent(t,n),u=this._chart.getChartStore(),c=u.getTooltipStore();o?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,c.setCrosshair(void 0,{notInvalidate:!0}),a=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},c.setCrosshair({x:l.x,y:l.y,paneId:r==null?void 0:r.getId()},{notInvalidate:!0}),a=!0),this._touchCancelCrosshair=!1)}(a||o)&&this._chart.updatePane(1)}return a},i.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},i.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),r=e.pane,n=e.widget;if(n!==null&&n.getName()===W.MAIN){var a=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:a.x,y:a.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:a.x,y:a.y,paneId:r==null?void 0:r.getId()}),!0}return!1},i.prototype._findWidgetByEvent=function(t){var e,r,n,a,s=t.x,o=t.y,l=this._chart.getAllSeparatorPanes(),u=this._chart.getChartStore().getStyles().separator.size;try{for(var c=Jt(l),h=c.next();!h.done;h=c.next()){var f=ee(h.value,2),d=f[1],v=d.getBounding(),p=v.top-Math.round((ge-u)/2);if(s>=v.left&&s<=v.left+v.width&&o>=p&&o<=p+ge)return{pane:d,widget:d.getWidget()}}}catch(M){e={error:M}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}var g=this._chart.getAllDrawPanes(),m=null;try{for(var _=Jt(g),S=_.next();!S.done;S=_.next()){var y=S.value,v=y.getBounding();if(s>=v.left&&s<=v.left+v.width&&o>=v.top&&o<=v.top+v.height){m=y;break}}}catch(M){n={error:M}}finally{try{S&&!S.done&&(a=_.return)&&a.call(_)}finally{if(n)throw n.error}}var x=null;if(m!==null){if(x===null){var w=m.getMainWidget(),b=w.getBounding();s>=b.left&&s<=b.left+b.width&&o>=b.top&&o<=b.top+b.height&&(x=w)}if(x===null){var E=m.getYAxisWidget();if(E!==null){var C=E.getBounding();s>=C.left&&s<=C.left+C.width&&o>=C.top&&o<=C.top+C.height&&(x=E)}}}return{pane:m,widget:x}},i.prototype._makeWidgetEvent=function(t,e){var r,n,a,s=(r=e==null?void 0:e.getBounding())!==null&&r!==void 0?r:null;return R(R({},t),{x:t.x-((n=s==null?void 0:s.left)!==null&&n!==void 0?n:0),y:t.y-((a=s==null?void 0:s.top)!==null&&a!==void 0?a:0)})},i.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},i}(),It;(function(i){i.Root="root",i.Main="main",i.YAxis="yAxis"})(It||(It={}));var vi=function(){function i(t,e){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(t),this._chartEvent=new co(this._chartContainer,this),this._chartStore=new da(this,e),this._initPanes(e),this.adjustPaneViewport(!0,!0,!0)}return i.prototype._initContainer=function(t){this._container=t,this._chartContainer=Ft("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},i.prototype._initPanes=function(t){var e=this,r,n=(r=t==null?void 0:t.layout)!==null&&r!==void 0?r:[{type:"candle"}],a=!1,s=!1,o=function(l){if(!s){var u=e._createPane(ao,Y.X_AXIS,l??{});e._xAxisPane=u,s=!0}};n.forEach(function(l){var u,c,h;switch(l.type){case"candle":{if(!a){var f=(u=l.options)!==null&&u!==void 0?u:{};mt(f,{id:Y.CANDLE}),e._candlePane=e._createPane(Ka,Y.CANDLE,f);var d=(c=l.content)!==null&&c!==void 0?c:[];d.forEach(function(p){e.createIndicator(p,!0,f)}),a=!0}break}case"indicator":{var d=(h=l.content)!==null&&h!==void 0?h:[];if(d.length>0){var v;d.forEach(function(g){T(v)?e.createIndicator(g,!0,{id:v}):v=e.createIndicator(g,!0,l.options)})}break}case"xAxis":{o(l.options);break}}}),o({position:"bottom"})},i.prototype._createPane=function(t,e,r){var n=null,a=null,s=r==null?void 0:r.position;switch(s){case"top":{var o=this._drawPanes[0];T(o)&&(a=new t(this._chartContainer,o.getContainer(),this,e,r??{}),n=0);break}case"bottom":break;default:for(var l=this._drawPanes.length-1;l>-1;l--){var u=this._drawPanes[l],c=this._drawPanes[l-1];if((u==null?void 0:u.getOptions().position)==="bottom"&&(c==null?void 0:c.getOptions().position)!=="bottom"){a=new t(this._chartContainer,u.getContainer(),this,e,r??{}),n=l;break}}}T(a)||(a=new t(this._chartContainer,null,this,e,r??{}));var h;if(F(n)?(this._drawPanes.splice(n,0,a),h=n):(this._drawPanes.push(a),h=this._drawPanes.length-1),a.getId()!==Y.X_AXIS){var f=this._drawPanes[h+1];if(T(f)&&f.getId()===Y.X_AXIS&&(f=this._drawPanes[h+2]),T(f)){var d=this._separatorPanes.get(f);T(d)?d.setTopPane(a):(d=new Sr(this._chartContainer,f.getContainer(),this,"",a,f),this._separatorPanes.set(f,d))}var v=this._drawPanes[h-1];if(T(v)&&v.getId()===Y.X_AXIS&&(v=this._drawPanes[h-2]),T(v)){var d=new Sr(this._chartContainer,a.getContainer(),this,"",v,a);this._separatorPanes.set(a,d)}}return a},i.prototype._measurePaneHeight=function(){var t=this,e,r=Math.floor(this._container.clientHeight),n=this._chartStore.getStyles().separator.size,a=this._xAxisPane.getAxisComponent().getAutoSize(),s=r-a-this._separatorPanes.size*n;s<0&&(s=0);var o=0;this._drawPanes.forEach(function(c){if(c.getId()!==Y.CANDLE&&c.getId()!==Y.X_AXIS){var h=c.getBounding().height,f=c.getOptions().minHeight;h<f&&(h=f),o+h>s?(o=s,h=Math.max(s-o,0)):o+=h,c.setBounding({height:h})}});var l=s-o;(e=this._candlePane)===null||e===void 0||e.setBounding({height:l}),this._xAxisPane.setBounding({height:a});var u=0;this._drawPanes.forEach(function(c){var h=t._separatorPanes.get(c);T(h)&&(h.setBounding({height:n,top:u}),u+=n),c.setBounding({top:u}),u+=c.getBounding().height})},i.prototype._measurePaneWidth=function(){var t=this,e=Math.floor(this._container.clientWidth),r=this._chartStore.getStyles(),n=r.yAxis,a=n.position===Gt.Left,s=!n.inside,o=0,l=0,u=0,c=0;this._drawPanes.forEach(function(g){g.getId()!==Y.X_AXIS&&(l=Math.max(l,g.getAxisComponent().getAutoSize()))}),l>e&&(l=e),s?(o=e-l,a?(u=0,c=l):(u=e-l,c=0)):(o=e,c=0,a?u=0:u=e-l),this._chartStore.getTimeScaleStore().setTotalBarSpace(o);var h={width:e},f={width:o,left:c},d={width:l,left:u},v=r.separator.fill,p;s&&!v?p=f:p=h,this._drawPanes.forEach(function(g){var m;(m=t._separatorPanes.get(g))===null||m===void 0||m.setBounding(p),g.setBounding(h,f,d)})},i.prototype._setPaneOptions=function(t,e){var r,n;if(O(t.id)){var a=this.getDrawPaneById(t.id),s=!1;if(a!==null){var o=e;if(t.id!==Y.CANDLE&&F(t.height)&&t.height>0){var l=Math.max((r=t.minHeight)!==null&&r!==void 0?r:a.getOptions().minHeight,0),u=Math.max(l,t.height);a.setBounding({height:u}),o=!0,s=!0}(O((n=t.axisOptions)===null||n===void 0?void 0:n.name)||T(t.gap))&&(o=!0),a.setOptions(t),o&&this.adjustPaneViewport(s,!0,!0,!0,!0)}}},i.prototype.getDrawPaneById=function(t){if(t===Y.CANDLE)return this._candlePane;if(t===Y.X_AXIS)return this._xAxisPane;var e=this._drawPanes.find(function(r){return r.getId()===t});return e??null},i.prototype.getContainer=function(){return this._container},i.prototype.getChartStore=function(){return this._chartStore},i.prototype.getXAxisPane=function(){return this._xAxisPane},i.prototype.getAllDrawPanes=function(){return this._drawPanes},i.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},i.prototype.adjustPaneViewport=function(t,e,r,n,a){t&&this._measurePaneHeight();var s=e,o=n??!1,l=a??!1;(o||l)&&this._drawPanes.forEach(function(u){var c=u.getAxisComponent().buildTicks(l);s||(s=c)}),s&&this._measurePaneWidth(),(r??!1)&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},i.prototype.updatePane=function(t,e){if(T(e)){var r=this.getDrawPaneById(e);r==null||r.update(t)}else this._separatorPanes.forEach(function(n){n.update(t)}),this._drawPanes.forEach(function(n){n.update(t)})},i.prototype.crosshairChange=function(t){var e=this,r=this._chartStore.getActionStore();if(r.has(gt.OnCrosshairChange)){var n={};this._drawPanes.forEach(function(a){var s=a.getId(),o={},l=e._chartStore.getIndicatorStore().getInstances(s);l.forEach(function(u){var c,h=u.result;o[u.name]=h[(c=t.dataIndex)!==null&&c!==void 0?c:h.length-1]}),n[s]=o}),O(t.paneId)&&r.execute(gt.OnCrosshairChange,R(R({},t),{indicatorData:n}))}},i.prototype.getDom=function(t,e){var r,n;if(O(t)){var a=this.getDrawPaneById(t);if(a!==null){var s=e??It.Root;switch(s){case It.Root:return a.getContainer();case It.Main:return a.getMainWidget().getContainer();case It.YAxis:return(n=(r=a.getYAxisWidget())===null||r===void 0?void 0:r.getContainer())!==null&&n!==void 0?n:null}}}else return this._chartContainer;return null},i.prototype.getSize=function(t,e){var r,n;if(T(t)){var a=this.getDrawPaneById(t);if(a!==null){var s=e??It.Root;switch(s){case It.Root:return a.getBounding();case It.Main:return a.getMainWidget().getBounding();case It.YAxis:return(n=(r=a.getYAxisWidget())===null||r===void 0?void 0:r.getBounding())!==null&&n!==void 0?n:null}}}else return{width:Math.floor(this._chartContainer.clientWidth),height:Math.floor(this._chartContainer.clientHeight),left:0,top:0,right:0,bottom:0};return null},i.prototype.setStyles=function(t){var e,r;this._chartStore.setOptions({styles:t});var n;O(t)?n=jr(t):n=t,T((e=n==null?void 0:n.yAxis)===null||e===void 0?void 0:e.type)&&((r=this._candlePane)===null||r===void 0||r.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getStyles=function(){return this._chartStore.getStyles()},i.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.getLocale=function(){return this._chartStore.getLocale()},i.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},i.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},i.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},i.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},i.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},i.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},i.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(t)},i.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(t)},i.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},i.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},i.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},i.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},i.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},i.prototype.clearData=function(){this._chartStore.clear()},i.prototype.getDataList=function(){return this._chartStore.getDataList()},i.prototype.applyNewData=function(t,e,r){this._chartStore.addData(t,pt.Init,e).then(function(){}).catch(function(){}).finally(function(){r==null||r()})},i.prototype.applyMoreData=function(t,e,r){this._chartStore.addData(t,pt.Forward,e??!0).then(function(){}).catch(function(){}).finally(function(){r==null||r()})},i.prototype.updateData=function(t,e){this._chartStore.addData(t).then(function(){}).catch(function(){}).finally(function(){e==null||e()})},i.prototype.loadMore=function(t){this._chartStore.setLoadMoreCallback(t)},i.prototype.setLoadDataCallback=function(t){this._chartStore.setLoadDataCallback(t)},i.prototype.createIndicator=function(t,e,r,n){var a=this,s,o=O(t)?{name:t}:t;if(Yr(o.name)===null)return null;var l=r==null?void 0:r.id,u=this.getDrawPaneById(l??"");if(u!==null)this._chartStore.getIndicatorStore().addInstance(o,l??"",e??!1).then(function(f){var d;a._setPaneOptions(r??{},(d=u.getAxisComponent().buildTicks(!0))!==null&&d!==void 0?d:!1)}).catch(function(f){});else{l??(l=Wr(Y.INDICATOR));var c=this._createPane(hi,l,r??{}),h=(s=r==null?void 0:r.height)!==null&&s!==void 0?s:sa;c.setBounding({height:h}),this._chartStore.getIndicatorStore().addInstance(o,l,e??!1).finally(function(){a.adjustPaneViewport(!0,!0,!0,!0,!0),n==null||n()})}return l??null},i.prototype.overrideIndicator=function(t,e,r){var n=this;this._chartStore.getIndicatorStore().override(t,e??null).then(function(a){var s=ee(a,2),o=s[0],l=s[1];(o||l)&&(n.adjustPaneViewport(!1,l,!0,l),r==null||r())}).catch(function(){})},i.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},i.prototype.removeIndicator=function(t,e){var r,n,a,s=this._chartStore.getIndicatorStore(),o=s.removeInstance(t,e);if(o){var l=!1;if(t!==Y.CANDLE&&!s.hasInstances(t)){var u=this.getDrawPaneById(t),c=this._drawPanes.findIndex(function(m){return m.getId()===t});if(u!==null){l=!0;var h=this._separatorPanes.get(u);if(T(h)){var f=h==null?void 0:h.getTopPane();try{for(var d=Jt(this._separatorPanes),v=d.next();!v.done;v=d.next()){var p=v.value;if(p[1].getTopPane().getId()===u.getId()){p[1].setTopPane(f);break}}}catch(m){r={error:m}}finally{try{v&&!v.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}h.destroy(),this._separatorPanes.delete(u)}this._drawPanes.splice(c,1),u.destroy();var g=this._drawPanes[0];T(g)&&g.getId()===Y.X_AXIS&&(g=this._drawPanes[1]),(a=this._separatorPanes.get(g))===null||a===void 0||a.destroy(),this._separatorPanes.delete(g)}}this.adjustPaneViewport(l,!0,!0,!0,!0)}},i.prototype.createOverlay=function(t,e){var r=[];if(O(t))r=[{name:t}];else if(wt(t))r=t.map(function(o){return O(o)?{name:o}:o});else{var n=t;r=[n]}var a=!0;(!T(e)||this.getDrawPaneById(e)===null)&&(e=Y.CANDLE,a=!1);var s=this._chartStore.getOverlayStore().addInstances(r,e,a);return wt(t)?s:s[0]},i.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},i.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},i.prototype.removeOverlay=function(t){var e;T(t)&&(O(t)?e={id:t}:e=t),this._chartStore.getOverlayStore().removeInstance(e)},i.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},i.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},i.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},i.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},i.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},i.prototype.scrollByDistance=function(t,e){var r=F(e)&&e>0?e:0,n=this._chartStore.getTimeScaleStore();if(n.startScroll(),r>0){var a=new He({duration:r});a.doFrame(function(s){var o=t*(s/r);n.scroll(o)}),a.start()}else n.scroll(t)},i.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),r=e.getBarSpace().bar,n=e.getLastBarRightSideDiffBarCount()-e.getInitialOffsetRightDistance()/r,a=n*r;this.scrollByDistance(a,t)},i.prototype.scrollToDataIndex=function(t,e){var r=this._chartStore.getTimeScaleStore(),n=(r.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*r.getBarSpace().bar;this.scrollByDistance(n,e)},i.prototype.scrollToTimestamp=function(t,e){var r=Ge(this.getDataList(),"timestamp",t);this.scrollToDataIndex(r,e)},i.prototype.zoomAtCoordinate=function(t,e,r){var n=F(r)&&r>0?r:0,a=this._chartStore.getTimeScaleStore(),s=a.getBarSpace().bar,o=s*t,l=o-s;if(n>0){var u=0,c=new He({duration:n});c.doFrame(function(h){var f=l*(h/n),d=(f-u)/a.getBarSpace().bar*$e;a.zoom(d,e),u=f}),c.start()}else a.zoom(l/s*$e,e)},i.prototype.zoomAtDataIndex=function(t,e,r){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},r)},i.prototype.zoomAtTimestamp=function(t,e,r){var n=Ge(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,r)},i.prototype.convertToPixel=function(t,e){var r,n=e.paneId,a=n===void 0?Y.CANDLE:n,s=e.absolute,o=s===void 0?!1:s,l=[];if(a!==Y.X_AXIS){var u=this.getDrawPaneById(a);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),f=new Array().concat(t),d=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=f.map(function(p){var g={},m=p.dataIndex;if(F(p.timestamp)&&(m=c.timestampToDataIndex(p.timestamp)),F(m)&&(g.x=d==null?void 0:d.convertToPixel(m)),F(p.value)){var _=v==null?void 0:v.convertToPixel(p.value);g.y=o?h.top+_:_}return g})}}return wt(t)?l:(r=l[0])!==null&&r!==void 0?r:{}},i.prototype.convertFromPixel=function(t,e){var r,n=e.paneId,a=n===void 0?Y.CANDLE:n,s=e.absolute,o=s===void 0?!1:s,l=[];if(a!==Y.X_AXIS){var u=this.getDrawPaneById(a);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),f=new Array().concat(t),d=this._xAxisPane.getAxisComponent(),v=u.getAxisComponent();l=f.map(function(p){var g,m,_={};if(F(p.x)){var S=(g=d==null?void 0:d.convertFromPixel(p.x))!==null&&g!==void 0?g:-1;_.dataIndex=S,_.timestamp=(m=c.dataIndexToTimestamp(S))!==null&&m!==void 0?m:void 0}if(F(p.y)){var y=o?p.y-h.top:p.y;_.value=v.convertFromPixel(y)}return _})}}return wt(t)?l:(r=l[0])!==null&&r!==void 0?r:{}},i.prototype.executeAction=function(t,e){var r;switch(t){case gt.OnCrosshairChange:{var n=R({},e);n.paneId=(r=n.paneId)!==null&&r!==void 0?r:Y.CANDLE,this._chartStore.getTooltipStore().setCrosshair(n,{notExecuteAction:!0});break}}},i.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},i.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},i.prototype.getConvertPictureUrl=function(t,e,r){var n=this,a=this._chartContainer.clientWidth,s=this._chartContainer.clientHeight,o=Ft("canvas",{width:"".concat(a,"px"),height:"".concat(s,"px"),boxSizing:"border-box"}),l=o.getContext("2d"),u=Ht(o);o.width=a*u,o.height=s*u,l.scale(u,u),l.fillStyle=r??"#FFFFFF",l.fillRect(0,0,a,s);var c=t??!1;return this._drawPanes.forEach(function(h){var f=n._separatorPanes.get(h);if(T(f)){var d=f.getBounding();l.drawImage(f.getImage(c),d.left,d.top,d.width,d.height)}var v=h.getBounding();l.drawImage(h.getImage(c),0,v.top,a,v.height)}),o.toDataURL("image/".concat(e??"jpeg"))},i.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},i.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach(function(t){t.destroy()}),this._drawPanes=[],this._separatorPanes.forEach(function(t){t.destroy()}),this._separatorPanes.clear(),this._container.removeChild(this._chartContainer)},i}(),Me=new Map,ho=1;function vo(i,t){var e;if(O(i)?e=document.getElementById(i):e=i,e===null)return null;var r=Me.get(e.id);if(T(r))return r;var n="k_line_chart_".concat(ho++);return r=new vi(e,t),r.id=n,e.setAttribute("k-line-chart-id",n),Me.set(n,r),r}function fo(i){var t,e,r;if(i instanceof vi)r=i.id;else{var n=void 0;O(i)?n=document.getElementById(i):n=i,r=(t=n==null?void 0:n.getAttribute("k-line-chart-id"))!==null&&t!==void 0?t:null}r!==null&&((e=Me.get(r))===null||e===void 0||e.destroy(),Me.delete(r))}function po(i){return Te({method:"POST",url:"/klineMarket",data:i})}function go(i){return Te({method:"POST",url:"/lever/submit",data:i})}function mo(){return Te({method:"GET",url:"/seconds"})}function _o(i){return Te({method:"POST",url:"/MicroOrder/submit",data:i})}const yo={class:"times my-2 flex space-between"},So={key:0,class:"text-center"},xo={key:1,id:"klineChart",style:{height:"300px"}},bo={__name:"KlineChart",props:["symbol"],setup(i){const t=Dr(),e=i,r=Wt([{label:"1M",value:"1min",time:1},{label:"5M",value:"5min",time:5},{label:"15M",value:"15min",time:15},{label:"30M",value:"30min",time:30},{label:"1H",value:"60min",time:60},{label:"1D",value:"1day",time:360}]);let n=null;const a=Wt({label:"1M",value:"5min",time:1}),s=Wt(!1);br(()=>{o(),t.on("kline",c=>{const{symbol:h,period:f}=c;c.timestamp=c.time*1e3,h===e.symbol&&f===a.value.value&&n&&n.updateData(c)})}),wr(()=>{t.off("kline")});function o(){const c={from:Date.parse(new Date)/1e3-a.value.time*24*60*60,to:Date.parse(new Date)/1e3,symbol:e.symbol,period:a.value.value};s.value=!0,po(c).then(h=>{if((h==null?void 0:h.type)==="ok"){const f=h.data.map(d=>(d.timestamp=d.time,d))||[];setTimeout(()=>{u();const d=[...new Map(f.map(v=>[v.id,v])).values()];n.applyNewData(d)},300)}}).finally(()=>{s.value=!1})}function l(c){c.value!==a.value.value&&(a.value=c,o())}we(()=>e.symbol,c=>{c&&n&&(a.value=r.value[0],o())});function u(){const c=document.getElementById("klineChart");n&&fo(n),n=vo(c,{styles:{grid:{show:!1},candle:{bar:{upColor:"#85bd00",downColor:"#f6543e"},tooltip:{custom:[{title:"high",value:"{high}"},{title:"open",value:"{open}"},{title:"low",value:"{low}"}],text:{size:11,marginTop:2,marginBottom:2}}},xAxis:{axisLine:{show:!1},tickText:{marginEnd:1,marginStart:1}},yAxis:{axisLine:{show:!1}}}}),n.setZoomEnabled(!0),n.setOffsetRightDistance(10)}return(c,h)=>{const f=Fr,d=Ai;return J(),xt(Yt,null,[j("div",yo,[(J(!0),xt(Yt,null,me(D(r),v=>(J(),zt(f,{size:"medium",color:v.value===D(a).value?"#85bd00":"#eee","text-color":v.value===D(a).value?"#fff":"#131313",key:v.value,onClick:p=>l(v)},{default:Z(()=>[De(bt(v.label),1)]),_:2},1032,["color","text-color","onClick"]))),128))]),D(s)?(J(),xt("div",So,[V(d,{size:"24"})])):(J(),xt("div",xo))],64)}}},di="/h5/assets/success-DDPA-ryG.png",wo={class:"my-4"},Co={class:"flex"},Eo={class:"mr-3 setting"},Io={class:"mx-4"},Po={class:"setting"},Mo={class:"mx-4"},To={class:"row py-3"},Do={class:"success"},Ao={class:"confirmed"},ko={__name:"ContractTrade",props:["currency"],setup(i){var f;const t=Cr(),e=i;Object.keys(t.user).length||t.userInfo();const{t:r}=Er(),n=Xt(()=>[{label:r("trade.trade"),type:1},{label:r("trade.pending_order"),type:2}]),a=Wt(""),s=Xt(()=>{var v;return((v=e.currency)==null?void 0:v.multiple).map(p=>(p.text=p.value,p))});let o=Ir({multiple:(f=s[0])==null?void 0:f.value,showMultiple:!1,pickerValue:[],isStopLoss:!1,isStopgap:!1,stop_loss_price:0,target_profit_price:0,number:0,each_piece:100,target_price:0,upLoading:!1,downLoading:!1,show:!1});const l=Xt(()=>{var d;return e.currency?((d=e.currency)==null?void 0:d.lever_trade_fee)*o.number:0}),u=Xt(()=>{if(!e.currency)return 0;const{now_price:d,spread:v,lever_share_num:p,each_piece:g}=e.currency;return(d*p*o.number/o.multiple*g).toFixed(5)});we(()=>e.currency,d=>{if(d){const v=d==null?void 0:d.multiple;v.length&&(o.multiple=v[0].value)}}),we(()=>o.isStopgap,d=>{var v;d?o.target_profit_price=(v=e.currency)==null?void 0:v.now_price:o.target_profit_price=0}),we(()=>o.isStopLoss,d=>{var v;d?o.stop_loss_price=(v=e.currency)==null?void 0:v.now_price:o.stop_loss_price=0});const c=({selectedValues:d,selectedOptions:v})=>{var p;o.multiple=(p=v[0])==null?void 0:p.value,o.pickerValue=d,o.showMultiple=!1};function h(d,v){var g;const p={share:o.number,multiple:o.multiple,legal_id:1,currency_id:(g=e.currency)==null?void 0:g.currency_id,type:d,status:v,target_profit_price:o.target_profit_price,stop_loss_price:o.stop_loss_price,target_price:o.target_price};d===1?o.upLoading=!0:o.downLoading=!0,go(p).then(m=>{m.type==="ok"&&(t.userInfo(),o.show=!0)}).finally(()=>{o.upLoading=!1,o.downLoading=!1})}return(d,v)=>{var I;const p=Ar,g=kr,m=Ri,_=je,S=Lr,y=Fi,x=Ue,w=ki,b=Mr("i18n-t"),E=Vr,C=Br,M=Rr;return J(),xt(Yt,null,[V(g,{class:"mt-3",active:D(a),"onUpdate:active":v[0]||(v[0]=P=>ze(a)?a.value=P:null)},{default:Z(()=>[(J(!0),xt(Yt,null,me(D(n),P=>(J(),zt(p,{title:P.label,name:P.type,key:P.name},null,8,["title","name"]))),128))]),_:1},8,["active"]),j("div",wo,[D(a)===2?(J(),zt(_,{key:0,border:!1,title:d.$t("trade.price")},{value:Z(()=>[V(m,{modelValue:D(o).target_price,"onUpdate:modelValue":v[1]||(v[1]=P=>D(o).target_price=P)},null,8,["modelValue"])]),_:1},8,["title"])):Pr("",!0),V(S,{modelValue:D(o).multiple,"onUpdate:modelValue":v[2]||(v[2]=P=>D(o).multiple=P),"is-link":"",readonly:"",name:"picker",label:d.$t("trade.multiplier"),placeholder:"",border:!1,onClick:v[3]||(v[3]=P=>D(o).showMultiple=!0)},null,8,["modelValue","label"]),V(x,{show:D(o).showMultiple,"onUpdate:show":v[5]||(v[5]=P=>D(o).showMultiple=P),"destroy-on-close":"",position:"bottom"},{default:Z(()=>[V(y,{columns:D(s),"model-value":D(o).pickerValue,onConfirm:c,onCancel:v[4]||(v[4]=P=>D(o).showMultiple=!1)},null,8,["columns","model-value"])]),_:1},8,["show"]),j("div",Co,[j("div",Eo,[V(_,{center:"",title:d.$t("trade.stop_loss")},{"right-icon":Z(()=>[V(w,{size:"20",modelValue:D(o).isStopLoss,"onUpdate:modelValue":v[6]||(v[6]=P=>D(o).isStopLoss=P)},null,8,["modelValue"])]),_:1},8,["title"]),j("div",Io,[V(m,{disabled:!D(o).isStopLoss,min:"0",modelValue:D(o).stop_loss_price,"onUpdate:modelValue":v[7]||(v[7]=P=>D(o).stop_loss_price=P)},null,8,["disabled","modelValue"])])]),j("div",Po,[V(_,{center:"",title:d.$t("trade.stop_loss")},{"right-icon":Z(()=>[V(w,{size:"20",modelValue:D(o).isStopgap,"onUpdate:modelValue":v[8]||(v[8]=P=>D(o).isStopgap=P)},null,8,["modelValue"])]),_:1},8,["title"]),j("div",Mo,[V(m,{disabled:!D(o).isStopgap,min:"0",modelValue:D(o).target_profit_price,"onUpdate:modelValue":v[9]||(v[9]=P=>D(o).target_profit_price=P)},null,8,["disabled","modelValue"])])])]),V(_,{center:"",title:d.$t("trade.buy_quantity"),border:!1},{"right-icon":Z(()=>{var P,A;return[V(m,{step:"0.1",min:(P=e.currency)==null?void 0:P.lever_min_share,max:(A=e.currency)==null?void 0:A.lever_max_share,modelValue:D(o).number,"onUpdate:modelValue":v[10]||(v[10]=k=>D(o).number=k)},null,8,["min","max","modelValue"])]}),_:1},8,["title"]),j("div",To,[V(_,{title:d.$t("trade.each"),border:!1},{value:Z(()=>{var P,A;return[De(bt(d.$t("trade.each"))+"="+bt(D(o).each_piece)+bt((P=e.currency)==null?void 0:P.currency_name)+"/"+bt((A=e.currency)==null?void 0:A.legal_name),1)]}),_:1},8,["title"]),V(_,{border:!1,title:d.$t("trade.estimated_commission"),value:D(l)},null,8,["title","value"]),V(_,{border:!1,title:d.$t("trade.estimated_margin"),value:D(u)},null,8,["title","value"]),V(_,{border:!1,title:d.$t("trade.balance"),value:(I=D(t).user)==null?void 0:I.usdt},null,8,["title","value"])]),V(C,null,{default:Z(()=>[V(E,{class:"btn",type:"primary",block:"",size:"small",loading:D(o).upLoading,onClick:v[11]||(v[11]=P=>h(1,1))},{default:Z(()=>[V(b,{keypath:"trade.buy_up"})]),_:1},8,["loading"]),V(E,{class:"btn",type:"danger",block:"",size:"small",loading:D(o).downLoading,onClick:v[12]||(v[12]=P=>h(2,1))},{default:Z(()=>[V(b,{keypath:"trade.buy_down"})]),_:1},8,["loading"])]),_:1}),V(x,{show:D(o).show,"onUpdate:show":v[13]||(v[13]=P=>D(o).show=P),position:"bottom",round:"",closeable:""},{default:Z(()=>[j("div",Do,[V(M,{src:D(di),width:"80",height:"80"},null,8,["src"])]),j("p",Ao,[V(b,{keypath:"trade.order_confirmed"})])]),_:1},8,["show"])])],64)}}},Fo=Ze(ko,[["__scopeId","data-v-94ea4af5"]]),Ro={class:"ma-4"},Bo={class:"font-md my-4"},Lo={class:"font-md my-4"},Vo={class:"row py-3 info"},Oo={class:"success"},No={class:"confirmed"},Wo={__name:"SecondsTrade",props:["currency"],setup(i){const t=Cr(),e=i,r=Ir({secondList:[],seconds:null,number:null,fee:0,show:!1,upLoading:!1,downLoading:!1});Tr(()=>{Object.keys(t.user).length||t.userInfo(),mo().then(o=>{var l,u;if(o.type==="ok"){const c=((l=o.data)==null?void 0:l.data)||[];r.secondList=c,r.fee=((u=o.data)==null?void 0:u.fee)||0,c.length&&(r.seconds=c[0])}})});function n(o){r.seconds=o}const a=Xt(()=>(r.fee/100).toFixed(2));function s(o){var u,c,h;const l={number:r.number,currency_id:(u=e.currency)==null?void 0:u.currency_id,type:o,seconds:(c=r.seconds)==null?void 0:c.seconds,match_id:(h=e.currency)==null?void 0:h.match_id};o===1?r.upLoading=!0:r.downLoading=!0,_o(l).then(f=>{f.type==="ok"?(t.userInfo(),r.show=!0):wi({type:"danger",message:f.message})}).finally(()=>{r.upLoading=!1,r.downLoading=!1})}return(o,l)=>{var m,_,S;const u=Mr("i18n-t"),c=Fr,h=Br,f=Lr,d=je,v=Vr,p=Rr,g=Ue;return J(),xt("div",Ro,[j("div",Bo,[V(u,{keypath:"trade.opening_time"})]),V(h,null,{default:Z(()=>[(J(!0),xt(Yt,null,me(D(r).secondList,y=>{var x;return J(),zt(c,{key:y.id,size:"large",type:"primary",plain:y.seconds!==((x=D(r).seconds)==null?void 0:x.seconds),onClick:w=>n(y)},{default:Z(()=>[De(bt(y.seconds)+"S",1)]),_:2},1032,["plain","onClick"])}),128))]),_:1}),j("div",Lo,[V(u,{keypath:"trade.open_number"}),j("span",null,"( >= "+bt((m=D(r).seconds)==null?void 0:m.min_amount)+")",1)]),V(f,{modelValue:D(r).number,"onUpdate:modelValue":l[0]||(l[0]=y=>D(r).number=y),class:"row"},null,8,["modelValue"]),j("div",Vo,[V(d,{border:!1,title:o.$t("trade.profit_rate"),value:`${(_=D(r).seconds)==null?void 0:_.profit_ratio}%`},null,8,["title","value"]),V(d,{border:!1,title:o.$t("trade.estimated_commission"),value:D(a)},null,8,["title","value"]),V(d,{border:!1,title:o.$t("trade.balance"),value:(S=D(t).user)==null?void 0:S.usdt},null,8,["title","value"])]),V(h,null,{default:Z(()=>[V(v,{class:"btn",type:"primary",block:"",size:"small",loading:D(r).upLoading,onClick:l[1]||(l[1]=y=>s(1))},{default:Z(()=>[V(u,{keypath:"trade.buy_up"})]),_:1},8,["loading"]),V(v,{class:"btn",type:"danger",block:"",size:"small",loading:D(r).downLoading,onClick:l[2]||(l[2]=y=>s(2))},{default:Z(()=>[V(u,{keypath:"trade.buy_down"})]),_:1},8,["loading"])]),_:1}),V(g,{show:D(r).show,"onUpdate:show":l[3]||(l[3]=y=>D(r).show=y),position:"bottom",round:"",closeable:""},{default:Z(()=>[j("div",Oo,[V(p,{src:D(di),width:"80",height:"80"},null,8,["src"])]),j("p",No,[V(u,{keypath:"trade.order_confirmed"})])]),_:1},8,["show"])])}}},zo=Ze(Wo,[["__scopeId","data-v-37ca1d6d"]]),Xo={class:"main"},Yo={class:"flex space-between"},Ho={class:"price mr-2 bold"},Go={class:"percentage mr-2 font-sm"},$o={class:"chart"},Uo={__name:"Index",setup(i){const{t}=Er(),e=Ci(),r=Dr(),n=Xt(()=>[{label:t("order.contract"),comp:Fo,id:"Contract"},{label:t("order.second_contract"),comp:zo,id:"Seconds"}]),a=Wt(null),s=Wt([]),o=Wt(!1),l=Xt(()=>a.value?`${a.value.currency_name}/${a.value.legal_name}`:"");Tr(async()=>{await u();const d=e.query.id;if(console.log("currency_id",d),d){const v=s.value.find(p=>p.currency_id===+d);console.log("defaultCurrency",v),a.value=v}a.value||(a.value=s.value[0])}),br(()=>{r.on("daymarket",d=>{var g;const{currency_name:v}=d,p=s.value.findIndex(m=>m.currency_name===v);if(v===((g=a.value)==null?void 0:g.currency_name)&&(a.value={...a.value,...d}),p>=0){const m=s.value[p];s.value[p]={...m,...d}}})}),wr(()=>{r.off("daymarket")});function u(){return Mi().then(d=>{(d==null?void 0:d.type)==="ok"&&d.data.forEach(p=>{p.quotation.forEach(m=>{const _={...m,id:m.currency_id,name:m.show_name,opening:m.currency.opening,precision_length:Ti(m.now_price)};s.value.push(_)})})})}function c(d){a.value=d,o.value=!1}const h=Wt(""),f=Xt(()=>{const d=n.value.find(v=>v.id===h.value);return d==null?void 0:d.comp});return(d,v)=>{var x,w,b,E,C,M;const p=Ar,g=kr,m=Ei,_=je,S=Pi,y=Ue;return J(),xt(Yt,null,[V(g,{active:D(h),"onUpdate:active":v[0]||(v[0]=I=>ze(h)?h.value=I:null)},{default:Z(()=>[(J(!0),xt(Yt,null,me(D(n),I=>(J(),zt(p,{key:I.label,title:I.label,name:I.id},null,8,["title","name"]))),128))]),_:1},8,["active"]),j("div",Xo,[j("div",Yo,[j("div",{class:"show-name bold",onClick:v[1]||(v[1]=I=>o.value=!0)},[De(bt((x=D(a))==null?void 0:x.show_name)+" ",1),V(m,{"class-prefix":"iconfont",name:"siglypharrowdown"})]),j("div",{class:Be(["trend",{up:D(Se)((w=D(a))==null?void 0:w.change),down:!D(Se)((b=D(a))==null?void 0:b.change)}])},[j("span",Ho,bt(D(Di)((E=D(a))==null?void 0:E.now_price,(C=D(a))==null?void 0:C.precision_length)),1),j("span",Go,bt((M=D(a))==null?void 0:M.change)+"%",1)],2)]),j("div",$o,[D(a)?(J(),zt(bo,{key:0,symbol:D(l)},null,8,["symbol"])):Pr("",!0)]),(J(),zt(Ii(D(f)),{currency:D(a)},null,8,["currency"])),V(y,{show:D(o),"onUpdate:show":v[2]||(v[2]=I=>ze(o)?o.value=I:null),position:"left",style:{width:"60%",height:"100%"}},{default:Z(()=>[V(S,null,{default:Z(()=>[(J(!0),xt(Yt,null,me(D(s),I=>(J(),zt(_,{title:I.show_name,class:Be({active:I.show_name===D(a).show_name}),onClick:P=>c(I)},{value:Z(()=>[j("span",{class:Be([{up:D(Se)(I==null?void 0:I.change),down:!D(Se)(I==null?void 0:I.change)}])},bt(I.now_price),3)]),_:2},1032,["title","class","onClick"]))),256))]),_:1})]),_:1},8,["show"])])],64)}}},_s=Ze(Uo,[["__scopeId","data-v-da4b945a"]]);export{_s as default};
